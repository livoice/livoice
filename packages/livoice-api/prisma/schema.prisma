generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Transcript {
  id              String            @id @default(cuid())
  title           String
  description     String?
  intervieweeName String?
  transcriptDate  DateTime
  createdAt       DateTime          @default(now())
  updatedAt       DateTime          @updatedAt
  chunks          TranscriptChunk[]
  chatSessions    ChatSession[]
}

model TranscriptChunk {
  id                String     @id @default(cuid())
  transcript        Transcript @relation(fields: [transcriptId], references: [id])
  transcriptId      String
  speaker           String?
  text              String
  absoluteTimestamp Float?     @map("absolute_timestamp")
  durationSeconds   Float?     @map("duration_seconds")
  metadata          Json?
}

model ChatSession {
  id           String        @id @default(cuid())
  transcript   Transcript    @relation(fields: [transcriptId], references: [id])
  transcriptId String
  createdAt    DateTime      @default(now())
  messages     ChatMessage[]
}

model ChatMessage {
  id             String      @id @default(cuid())
  session        ChatSession @relation(fields: [sessionId], references: [id])
  sessionId      String
  role           MessageRole
  content        String
  createdAt      DateTime    @default(now())
}

enum MessageRole {
  user
  assistant
}
