"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "pages/api/auth/[...nextauth]";
exports.ids = ["pages/api/auth/[...nextauth]"];
exports.modules = {

/***/ "@keystone-6/cloudinary":
/*!*****************************************!*\
  !*** external "@keystone-6/cloudinary" ***!
  \*****************************************/
/***/ ((module) => {

module.exports = require("@keystone-6/cloudinary");

/***/ }),

/***/ "@keystone-6/core":
/*!***********************************!*\
  !*** external "@keystone-6/core" ***!
  \***********************************/
/***/ ((module) => {

module.exports = require("@keystone-6/core");

/***/ }),

/***/ "@keystone-6/core/access":
/*!******************************************!*\
  !*** external "@keystone-6/core/access" ***!
  \******************************************/
/***/ ((module) => {

module.exports = require("@keystone-6/core/access");

/***/ }),

/***/ "@keystone-6/core/context":
/*!*******************************************!*\
  !*** external "@keystone-6/core/context" ***!
  \*******************************************/
/***/ ((module) => {

module.exports = require("@keystone-6/core/context");

/***/ }),

/***/ "@keystone-6/core/fields":
/*!******************************************!*\
  !*** external "@keystone-6/core/fields" ***!
  \******************************************/
/***/ ((module) => {

module.exports = require("@keystone-6/core/fields");

/***/ }),

/***/ "@prisma/client":
/*!*********************************!*\
  !*** external "@prisma/client" ***!
  \*********************************/
/***/ ((module) => {

module.exports = require("@prisma/client");

/***/ }),

/***/ "@vvo/tzdb":
/*!****************************!*\
  !*** external "@vvo/tzdb" ***!
  \****************************/
/***/ ((module) => {

module.exports = require("@vvo/tzdb");

/***/ }),

/***/ "cookie":
/*!*************************!*\
  !*** external "cookie" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("cookie");

/***/ }),

/***/ "dotenv":
/*!*************************!*\
  !*** external "dotenv" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("dotenv");

/***/ }),

/***/ "envalid":
/*!**************************!*\
  !*** external "envalid" ***!
  \**************************/
/***/ ((module) => {

module.exports = require("envalid");

/***/ }),

/***/ "express":
/*!**************************!*\
  !*** external "express" ***!
  \**************************/
/***/ ((module) => {

module.exports = require("express");

/***/ }),

/***/ "free-email-domains":
/*!*************************************!*\
  !*** external "free-email-domains" ***!
  \*************************************/
/***/ ((module) => {

module.exports = require("free-email-domains");

/***/ }),

/***/ "lodash/pick":
/*!******************************!*\
  !*** external "lodash/pick" ***!
  \******************************/
/***/ ((module) => {

module.exports = require("lodash/pick");

/***/ }),

/***/ "next-auth":
/*!****************************!*\
  !*** external "next-auth" ***!
  \****************************/
/***/ ((module) => {

module.exports = require("next-auth");

/***/ }),

/***/ "next-auth/providers/google":
/*!*********************************************!*\
  !*** external "next-auth/providers/google" ***!
  \*********************************************/
/***/ ((module) => {

module.exports = require("next-auth/providers/google");

/***/ }),

/***/ "next/dist/compiled/next-server/pages-api.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/pages-api.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/pages-api.runtime.dev.js");

/***/ }),

/***/ "rrule":
/*!************************!*\
  !*** external "rrule" ***!
  \************************/
/***/ ((module) => {

module.exports = require("rrule");

/***/ }),

/***/ "crypto":
/*!*************************!*\
  !*** external "crypto" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("crypto");

/***/ }),

/***/ "path":
/*!***********************!*\
  !*** external "path" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("path");

/***/ }),

/***/ "date-holidays":
/*!********************************!*\
  !*** external "date-holidays" ***!
  \********************************/
/***/ ((module) => {

module.exports = import("date-holidays");;

/***/ }),

/***/ "(api)/../../../../node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fauth%2F%5B...nextauth%5D&preferredRegion=&absolutePagePath=.%2Fpages%2Fapi%2Fauth%2F%5B...nextauth%5D.ts&middlewareConfigBase64=e30%3D!":
/*!****************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ../../../../node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fauth%2F%5B...nextauth%5D&preferredRegion=&absolutePagePath=.%2Fpages%2Fapi%2Fauth%2F%5B...nextauth%5D.ts&middlewareConfigBase64=e30%3D! ***!
  \****************************************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   config: () => (/* binding */ config),\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__),\n/* harmony export */   routeModule: () => (/* binding */ routeModule)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/pages-api/module.compiled */ \"(api)/../../../../node_modules/next/dist/server/future/route-modules/pages-api/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(api)/../../../../node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/build/templates/helpers */ \"(api)/../../../../node_modules/next/dist/build/templates/helpers.js\");\n/* harmony import */ var _pages_api_auth_nextauth_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./pages/api/auth/[...nextauth].ts */ \"(api)/./pages/api/auth/[...nextauth].ts\");\n\n\n\n// Import the userland code.\n\n// Re-export the handler (should be the default export).\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__.hoist)(_pages_api_auth_nextauth_ts__WEBPACK_IMPORTED_MODULE_3__, \"default\"));\n// Re-export config.\nconst config = (0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__.hoist)(_pages_api_auth_nextauth_ts__WEBPACK_IMPORTED_MODULE_3__, \"config\");\n// Create and export the route module that will be consumed.\nconst routeModule = new next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__.PagesAPIRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.PAGES_API,\n        page: \"/api/auth/[...nextauth]\",\n        pathname: \"/api/auth/[...nextauth]\",\n        // The following aren't used in production.\n        bundlePath: \"\",\n        filename: \"\"\n    },\n    userland: _pages_api_auth_nextauth_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n\n//# sourceMappingURL=pages-api.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi4vLi4vLi4vLi4vbm9kZV9tb2R1bGVzL25leHQvZGlzdC9idWlsZC93ZWJwYWNrL2xvYWRlcnMvbmV4dC1yb3V0ZS1sb2FkZXIvaW5kZXguanM/a2luZD1QQUdFU19BUEkmcGFnZT0lMkZhcGklMkZhdXRoJTJGJTVCLi4ubmV4dGF1dGglNUQmcHJlZmVycmVkUmVnaW9uPSZhYnNvbHV0ZVBhZ2VQYXRoPS4lMkZwYWdlcyUyRmFwaSUyRmF1dGglMkYlNUIuLi5uZXh0YXV0aCU1RC50cyZtaWRkbGV3YXJlQ29uZmlnQmFzZTY0PWUzMCUzRCEiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7QUFBc0c7QUFDdkM7QUFDTDtBQUMxRDtBQUM4RDtBQUM5RDtBQUNBLGlFQUFlLHdFQUFLLENBQUMsd0RBQVEsWUFBWSxFQUFDO0FBQzFDO0FBQ08sZUFBZSx3RUFBSyxDQUFDLHdEQUFRO0FBQ3BDO0FBQ08sd0JBQXdCLGdIQUFtQjtBQUNsRDtBQUNBLGNBQWMseUVBQVM7QUFDdkI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTCxZQUFZO0FBQ1osQ0FBQzs7QUFFRCIsInNvdXJjZXMiOlsid2VicGFjazovLy8/MmZkNiJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBQYWdlc0FQSVJvdXRlTW9kdWxlIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvZnV0dXJlL3JvdXRlLW1vZHVsZXMvcGFnZXMtYXBpL21vZHVsZS5jb21waWxlZFwiO1xuaW1wb3J0IHsgUm91dGVLaW5kIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvZnV0dXJlL3JvdXRlLWtpbmRcIjtcbmltcG9ydCB7IGhvaXN0IH0gZnJvbSBcIm5leHQvZGlzdC9idWlsZC90ZW1wbGF0ZXMvaGVscGVyc1wiO1xuLy8gSW1wb3J0IHRoZSB1c2VybGFuZCBjb2RlLlxuaW1wb3J0ICogYXMgdXNlcmxhbmQgZnJvbSBcIi4vcGFnZXMvYXBpL2F1dGgvWy4uLm5leHRhdXRoXS50c1wiO1xuLy8gUmUtZXhwb3J0IHRoZSBoYW5kbGVyIChzaG91bGQgYmUgdGhlIGRlZmF1bHQgZXhwb3J0KS5cbmV4cG9ydCBkZWZhdWx0IGhvaXN0KHVzZXJsYW5kLCBcImRlZmF1bHRcIik7XG4vLyBSZS1leHBvcnQgY29uZmlnLlxuZXhwb3J0IGNvbnN0IGNvbmZpZyA9IGhvaXN0KHVzZXJsYW5kLCBcImNvbmZpZ1wiKTtcbi8vIENyZWF0ZSBhbmQgZXhwb3J0IHRoZSByb3V0ZSBtb2R1bGUgdGhhdCB3aWxsIGJlIGNvbnN1bWVkLlxuZXhwb3J0IGNvbnN0IHJvdXRlTW9kdWxlID0gbmV3IFBhZ2VzQVBJUm91dGVNb2R1bGUoe1xuICAgIGRlZmluaXRpb246IHtcbiAgICAgICAga2luZDogUm91dGVLaW5kLlBBR0VTX0FQSSxcbiAgICAgICAgcGFnZTogXCIvYXBpL2F1dGgvWy4uLm5leHRhdXRoXVwiLFxuICAgICAgICBwYXRobmFtZTogXCIvYXBpL2F1dGgvWy4uLm5leHRhdXRoXVwiLFxuICAgICAgICAvLyBUaGUgZm9sbG93aW5nIGFyZW4ndCB1c2VkIGluIHByb2R1Y3Rpb24uXG4gICAgICAgIGJ1bmRsZVBhdGg6IFwiXCIsXG4gICAgICAgIGZpbGVuYW1lOiBcIlwiXG4gICAgfSxcbiAgICB1c2VybGFuZFxufSk7XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPXBhZ2VzLWFwaS5qcy5tYXAiXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(api)/../../../../node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fauth%2F%5B...nextauth%5D&preferredRegion=&absolutePagePath=.%2Fpages%2Fapi%2Fauth%2F%5B...nextauth%5D.ts&middlewareConfigBase64=e30%3D!\n");

/***/ }),

/***/ "(api)/./pages/api/auth/[...nextauth].ts":
/*!*****************************************!*\
  !*** ./pages/api/auth/[...nextauth].ts ***!
  \*****************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (/* reexport safe */ _admin_pages_api_auth_nextauth___WEBPACK_IMPORTED_MODULE_0__[\"default\"])\n/* harmony export */ });\n/* harmony import */ var _admin_pages_api_auth_nextauth___WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../../../admin/pages/api/auth/[...nextauth] */ \"(api)/../../admin/pages/api/auth/[...nextauth].ts\");\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9wYWdlcy9hcGkvYXV0aC9bLi4ubmV4dGF1dGhdLnRzIiwibWFwcGluZ3MiOiI7Ozs7O0FBQTJFIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLy4vcGFnZXMvYXBpL2F1dGgvWy4uLm5leHRhdXRoXS50cz8yZThiIl0sInNvdXJjZXNDb250ZW50IjpbImV4cG9ydCB7IGRlZmF1bHQgfSBmcm9tIFwiLi4vLi4vLi4vLi4vLi4vYWRtaW4vcGFnZXMvYXBpL2F1dGgvWy4uLm5leHRhdXRoXVwiIl0sIm5hbWVzIjpbImRlZmF1bHQiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(api)/./pages/api/auth/[...nextauth].ts\n");

/***/ }),

/***/ "(api)/../../admin/pages/api/auth/[...nextauth].ts":
/*!***************************************************!*\
  !*** ../../admin/pages/api/auth/[...nextauth].ts ***!
  \***************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var next_auth__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next-auth */ \"next-auth\");\n/* harmony import */ var next_auth__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_auth__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _auth__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../../auth */ \"(api)/../../auth.ts\");\n\n\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (next_auth__WEBPACK_IMPORTED_MODULE_0___default()(_auth__WEBPACK_IMPORTED_MODULE_1__.nextAuthOptions));\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi4vLi4vYWRtaW4vcGFnZXMvYXBpL2F1dGgvWy4uLm5leHRhdXRoXS50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7O0FBQWlDO0FBQ2tCO0FBRW5ELGlFQUFlQSxnREFBUUEsQ0FBQ0Msa0RBQWVBLENBQUNBLEVBQUMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi4vLi4vYWRtaW4vcGFnZXMvYXBpL2F1dGgvWy4uLm5leHRhdXRoXS50cz8yMDQyIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBOZXh0QXV0aCBmcm9tICduZXh0LWF1dGgnO1xuaW1wb3J0IHsgbmV4dEF1dGhPcHRpb25zIH0gZnJvbSAnLi4vLi4vLi4vLi4vYXV0aCc7XG5cbmV4cG9ydCBkZWZhdWx0IE5leHRBdXRoKG5leHRBdXRoT3B0aW9ucyk7XG4iXSwibmFtZXMiOlsiTmV4dEF1dGgiLCJuZXh0QXV0aE9wdGlvbnMiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(api)/../../admin/pages/api/auth/[...nextauth].ts\n");

/***/ }),

/***/ "(api)/../../auth.ts":
/*!*********************!*\
  !*** ../../auth.ts ***!
  \*********************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   nextAuthOptions: () => (/* binding */ nextAuthOptions),\n/* harmony export */   nextAuthSessionStrategy: () => (/* binding */ nextAuthSessionStrategy)\n/* harmony export */ });\n/* harmony import */ var cookie__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! cookie */ \"cookie\");\n/* harmony import */ var cookie__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(cookie__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var free_email_domains__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! free-email-domains */ \"free-email-domains\");\n/* harmony import */ var free_email_domains__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(free_email_domains__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var next_auth__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next-auth */ \"next-auth\");\n/* harmony import */ var next_auth__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_auth__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var _config_env__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./config/env */ \"(api)/../../config/env.ts\");\n/* harmony import */ var _context_keystoneContext__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./context/keystoneContext */ \"(api)/../../context/keystoneContext.ts\");\n/* harmony import */ var _domains_auth_userRole__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./domains/auth/userRole */ \"(api)/../../domains/auth/userRole.ts\");\n/* harmony import */ var _lib_auth_extractUserData__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./lib/auth/extractUserData */ \"(api)/../../lib/auth/extractUserData.ts\");\n/* harmony import */ var _lib_auth_providers__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./lib/auth/providers */ \"(api)/../../lib/auth/providers.ts\");\n\n\n\n\n\n\n\n\nconst freeEmailDomainSet = new Set(free_email_domains__WEBPACK_IMPORTED_MODULE_1___default().map((domain)=>domain.toLowerCase()));\nconst extractDomain = (email)=>{\n    if (!email) return null;\n    const [, domain] = email.toLowerCase().split(\"@\");\n    return domain || null;\n};\nconst isSecureCookies = _config_env__WEBPACK_IMPORTED_MODULE_3__[\"default\"].NEXTAUTH_URL.startsWith(\"https://\");\nconst cookiePrefix = isSecureCookies ? \"__Secure-\" : \"\";\nconst cookiesMappingConfig = {\n    sessionToken: `${cookiePrefix}next-auth.session-token`,\n    callbackUrl: `${cookiePrefix}next-auth.callback-url`,\n    csrfToken: `${cookiePrefix}next-auth.csrf-token`,\n    pkceCodeVerifier: `${cookiePrefix}next-auth.pkce.code_verifier`,\n    state: `${cookiePrefix}next-auth.state`,\n    nonce: `${cookiePrefix}next-auth.nonce`\n};\nconst cookies = Object.fromEntries(Object.entries(cookiesMappingConfig).map(([key, name])=>[\n        key,\n        {\n            name,\n            options: {\n                httpOnly: true,\n                sameSite: \"lax\",\n                path: \"/\",\n                secure: isSecureCookies,\n                domain: _config_env__WEBPACK_IMPORTED_MODULE_3__[\"default\"].COOKIE_DOMAIN\n            }\n        }\n    ]));\nconst nextAuthOptions = {\n    providers: _lib_auth_providers__WEBPACK_IMPORTED_MODULE_7__[\"default\"],\n    cookies,\n    secret: _config_env__WEBPACK_IMPORTED_MODULE_3__[\"default\"].SESSION_SECRET,\n    pages: {\n        error: \"/api/auth/error\"\n    },\n    callbacks: {\n        async signIn ({ user, account, profile }) {\n            const sudoContext = (await (0,_context_keystoneContext__WEBPACK_IMPORTED_MODULE_4__.getKeystoneContext)()).sudo();\n            if (!account) throw new Error(\"Missing account param\");\n            const { providerAccountId, provider } = account;\n            const email = user.email?.toLowerCase();\n            if (!email) return false;\n            const domain = extractDomain(email);\n            const nowIso = new Date().toISOString();\n            const extractedData = (0,_lib_auth_extractUserData__WEBPACK_IMPORTED_MODULE_6__[\"default\"])(provider, {\n                user,\n                profile\n            });\n            const existingUsers = await sudoContext.query.User.findMany({\n                where: {\n                    email: {\n                        equals: email\n                    }\n                },\n                query: \"id org { id } location { id }\"\n            });\n            const baseUserData = {\n                email,\n                firstName: extractedData.firstName ?? \"\",\n                lastName: extractedData.lastName ?? \"\",\n                avatarSocialUrl: extractedData.pictureUrl ?? \"\",\n                role: _domains_auth_userRole__WEBPACK_IMPORTED_MODULE_5__.UserRole.USER,\n                providerAccountId,\n                provider: provider,\n                rawAuth: {\n                    user: user,\n                    profile: profile,\n                    account: account\n                }\n            };\n            let matchedOrgId = null;\n            if (domain && !freeEmailDomainSet.has(domain)) {\n                const orgs = await sudoContext.query.Organization.findMany({\n                    query: \"id autojoinDomains\"\n                });\n                const matchedOrg = orgs.find((candidate)=>{\n                    const domains = Array.isArray(candidate.autojoinDomains) ? candidate.autojoinDomains : [];\n                    return domains.map((value)=>value?.toLowerCase?.() || \"\").includes(domain);\n                });\n                matchedOrgId = matchedOrg?.id ?? null;\n            }\n            let locationToConnect = null;\n            if (matchedOrgId) {\n                const candidateLocations = await sudoContext.query.Location.findMany({\n                    where: {\n                        org: {\n                            id: {\n                                equals: matchedOrgId\n                            }\n                        }\n                    },\n                    take: 1,\n                    query: \"id\"\n                });\n                const primaryLocation = candidateLocations?.[0];\n                if (!primaryLocation?.id) {\n                    throw new Error(\"Auto-join target organization does not have a location configured.\");\n                }\n                locationToConnect = {\n                    id: primaryLocation.id\n                };\n            }\n            if (existingUsers.length > 0) {\n                const existingUser = existingUsers[0];\n                const { role: _, ...userDataWithoutRole } = baseUserData;\n                await sudoContext.db.User.updateOne({\n                    where: {\n                        id: existingUser.id\n                    },\n                    data: {\n                        ...userDataWithoutRole,\n                        provisionedAt: nowIso,\n                        ...matchedOrgId && !existingUser.org?.id ? {\n                            org: {\n                                connect: {\n                                    id: matchedOrgId\n                                }\n                            }\n                        } : {},\n                        ...locationToConnect && !existingUser.location?.id ? {\n                            location: {\n                                connect: locationToConnect\n                            }\n                        } : {}\n                    },\n                    query: \"id\"\n                });\n                return true;\n            }\n            const created = await sudoContext.db.User.createOne({\n                data: {\n                    ...baseUserData,\n                    provisionedAt: nowIso,\n                    ...matchedOrgId ? {\n                        org: {\n                            connect: {\n                                id: matchedOrgId\n                            }\n                        }\n                    } : {},\n                    ...locationToConnect ? {\n                        location: {\n                            connect: locationToConnect\n                        }\n                    } : {}\n                },\n                query: \"id\"\n            });\n            return !!created?.id;\n        },\n        async jwt ({ token, user, account, profile }) {\n            if (!account) return token;\n            const extracted = (0,_lib_auth_extractUserData__WEBPACK_IMPORTED_MODULE_6__[\"default\"])(account.provider, {\n                user,\n                profile\n            });\n            const normalizedEmail = typeof extracted.email === \"string\" ? extracted.email.toLowerCase() : null;\n            return {\n                ...token,\n                userData: {\n                    ...extracted,\n                    email: normalizedEmail ?? extracted.email ?? null\n                }\n            };\n        },\n        async session ({ session, token }) {\n            const userData = token.userData ?? {};\n            const normalizedEmail = typeof userData?.email === \"string\" ? userData.email.toLowerCase() : null;\n            if (!normalizedEmail) {\n                throw new Error(\"Invalid session: no email found\");\n            }\n            const sudoContext = (await (0,_context_keystoneContext__WEBPACK_IMPORTED_MODULE_4__.getKeystoneContext)()).sudo();\n            const dbUser = await sudoContext.query.User.findMany({\n                where: {\n                    email: {\n                        equals: normalizedEmail\n                    }\n                },\n                query: \"id email org { id } location { id } role providerAccountId isActive seenAt avatarUrl displayName\"\n            });\n            if (!dbUser || dbUser.length === 0) {\n                throw new Error(\"User not found in database\");\n            }\n            const user = dbUser[0];\n            const isDeactivated = !user.isActive;\n            const seenAt = new Date().toISOString();\n            await sudoContext.db.User.updateOne({\n                where: {\n                    id: user.id\n                },\n                data: {\n                    seenAt\n                },\n                query: \"id\"\n            });\n            const emailDomain = extractDomain(user?.email ?? normalizedEmail);\n            const isAutojoinDomainAllowed = !!(emailDomain && !freeEmailDomainSet.has(emailDomain));\n            // Default to USER if role is not set\n            const userRole = user?.role || _domains_auth_userRole__WEBPACK_IMPORTED_MODULE_5__.UserRole.USER;\n            return {\n                ...session,\n                id: user?.id,\n                email: normalizedEmail,\n                firstName: userData?.firstName,\n                lastName: userData?.lastName,\n                avatarUrl: user?.avatarUrl || null,\n                displayName: user?.displayName || null,\n                providerAccountId: user?.providerAccountId || null,\n                orgId: user?.org?.id || null,\n                locationId: user?.location?.id || null,\n                role: userRole,\n                emailDomain,\n                isAutojoinDomainAllowed,\n                isActive: user.isActive ?? true\n            };\n        },\n        async redirect ({ url, baseUrl }) {\n            // If this is an error redirect, we can modify it to include additional parameters\n            if (url.includes(\"/api/auth/error\")) {\n                // The error page will handle displaying the email from the error context\n                return url;\n            }\n            if (!url.startsWith(_config_env__WEBPACK_IMPORTED_MODULE_3__[\"default\"].APP_URL) && !url.startsWith(baseUrl)) return baseUrl;\n            return url;\n        }\n    }\n};\nconst nextAuthSessionStrategy = {\n    async get ({ context }) {\n        const { req, res } = context;\n        const { headers } = req ?? {};\n        if (!headers?.cookie || !res) return;\n        const nextAuthSession = await (0,next_auth__WEBPACK_IMPORTED_MODULE_2__.getServerSession)({\n            headers,\n            cookies: (0,cookie__WEBPACK_IMPORTED_MODULE_0__.parse)(headers.cookie)\n        }, res, nextAuthOptions);\n        if (!nextAuthSession) return;\n        // Should we verify user line in examples?\n        // const user = await context.sudo().db.User.findOne({ where: { email: nextAuthSession.email } });\n        // if (!user) return;\n        return nextAuthSession;\n    },\n    // we don't need these as next-auth handle start and end for us\n    async start () {\n    /* empty */ },\n    async end () {\n    /* empty */ }\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QSxDQUFDa0ksUUFBUUMsTUFBTTtRQUFFLEdBQ2pERixLQUNBMUY7UUFFRixJQUFJLENBQUM2RixpQkFBaUI7UUFFdEIsMENBQTBDO1FBQzFDLGtHQUFrRztRQUNsRyxxQkFBcUI7UUFFckIsT0FBT0E7SUFDVDtJQUVBLCtEQUErRDtJQUMvRCxNQUFNQztJQUNKLFNBQVMsR0FDWDtJQUNBLE1BQU1DO0lBQ0osU0FBUyxHQUNYO0FBQ0YsRUFBRSIsInNvdXJjZXMiOlsid2VicGFjazovLy8uLi8uLi9hdXRoLnRzPzE3MzEiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHR5cGUgeyBUeXBlSW5mbyB9IGZyb20gJy5rZXlzdG9uZS90eXBlcyc7XG5pbXBvcnQgeyBKU09OVmFsdWUsIFNlc3Npb25TdHJhdGVneSB9IGZyb20gJ0BrZXlzdG9uZS02L2NvcmUvdHlwZXMnO1xuaW1wb3J0IHsgcGFyc2UgYXMgcGFyc2VDb29raWVzIH0gZnJvbSAnY29va2llJztcbmltcG9ydCBmcmVlRW1haWxEb21haW5zIGZyb20gJ2ZyZWUtZW1haWwtZG9tYWlucyc7XG5pbXBvcnQgeyBnZXRTZXJ2ZXJTZXNzaW9uLCBOZXh0QXV0aE9wdGlvbnMgfSBmcm9tICduZXh0LWF1dGgnO1xuaW1wb3J0IGVudiBmcm9tICcuL2NvbmZpZy9lbnYnO1xuaW1wb3J0IHsgZ2V0S2V5c3RvbmVDb250ZXh0IH0gZnJvbSAnLi9jb250ZXh0L2tleXN0b25lQ29udGV4dCc7XG5pbXBvcnQgeyBVc2VyUm9sZSB9IGZyb20gJy4vZG9tYWlucy9hdXRoL3VzZXJSb2xlJztcbmltcG9ydCBleHRyYWN0VXNlckRhdGEgZnJvbSAnLi9saWIvYXV0aC9leHRyYWN0VXNlckRhdGEnO1xuaW1wb3J0IHByb3ZpZGVycyBmcm9tICcuL2xpYi9hdXRoL3Byb3ZpZGVycyc7XG5cbmNvbnN0IGZyZWVFbWFpbERvbWFpblNldCA9IG5ldyBTZXQ8c3RyaW5nPigoZnJlZUVtYWlsRG9tYWlucyBhcyBzdHJpbmdbXSkubWFwKGRvbWFpbiA9PiBkb21haW4udG9Mb3dlckNhc2UoKSkpO1xuXG5jb25zdCBleHRyYWN0RG9tYWluID0gKGVtYWlsPzogc3RyaW5nIHwgbnVsbCkgPT4ge1xuICBpZiAoIWVtYWlsKSByZXR1cm4gbnVsbDtcbiAgY29uc3QgWywgZG9tYWluXSA9IGVtYWlsLnRvTG93ZXJDYXNlKCkuc3BsaXQoJ0AnKTtcbiAgcmV0dXJuIGRvbWFpbiB8fCBudWxsO1xufTtcblxudHlwZSBQcm92aWRlclR5cGUgPSAnZ29vZ2xlJztcblxudHlwZSBVc2VySXRlbSA9IFR5cGVJbmZvWydsaXN0cyddWydVc2VyJ11bJ2l0ZW0nXTtcbnR5cGUgT3JnYW5pemF0aW9uSXRlbSA9IFR5cGVJbmZvWydsaXN0cyddWydPcmdhbml6YXRpb24nXVsnaXRlbSddO1xudHlwZSBMb2NhdGlvbkl0ZW0gPSBUeXBlSW5mb1snbGlzdHMnXVsnTG9jYXRpb24nXVsnaXRlbSddO1xuXG5leHBvcnQgdHlwZSBTZXNzaW9uID0ge1xuICBpZDogc3RyaW5nO1xuICBlbWFpbDogc3RyaW5nO1xuICBmaXJzdE5hbWU/OiBzdHJpbmc7XG4gIGxhc3ROYW1lPzogc3RyaW5nO1xuICBhdmF0YXJVcmw/OiBzdHJpbmcgfCBudWxsO1xuICBkaXNwbGF5TmFtZT86IHN0cmluZyB8IG51bGw7XG4gIHJvbGU6IFVzZXJSb2xlO1xuICBvcmdJZDogc3RyaW5nIHwgbnVsbDtcbiAgbG9jYXRpb25JZDogc3RyaW5nIHwgbnVsbDtcbiAgcHJvdmlkZXJBY2NvdW50SWQ6IHN0cmluZyB8IG51bGw7XG4gIGVtYWlsRG9tYWluOiBzdHJpbmcgfCBudWxsO1xuICBpc0F1dG9qb2luRG9tYWluQWxsb3dlZDogYm9vbGVhbjtcbiAgaXNBY3RpdmU6IGJvb2xlYW47XG59O1xuXG5jb25zdCBpc1NlY3VyZUNvb2tpZXMgPSBlbnYuTkVYVEFVVEhfVVJMLnN0YXJ0c1dpdGgoJ2h0dHBzOi8vJyk7XG5jb25zdCBjb29raWVQcmVmaXggPSBpc1NlY3VyZUNvb2tpZXMgPyAnX19TZWN1cmUtJyA6ICcnO1xuXG5jb25zdCBjb29raWVzTWFwcGluZ0NvbmZpZyA9IHtcbiAgc2Vzc2lvblRva2VuOiBgJHtjb29raWVQcmVmaXh9bmV4dC1hdXRoLnNlc3Npb24tdG9rZW5gLFxuICBjYWxsYmFja1VybDogYCR7Y29va2llUHJlZml4fW5leHQtYXV0aC5jYWxsYmFjay11cmxgLFxuICBjc3JmVG9rZW46IGAke2Nvb2tpZVByZWZpeH1uZXh0LWF1dGguY3NyZi10b2tlbmAsXG4gIHBrY2VDb2RlVmVyaWZpZXI6IGAke2Nvb2tpZVByZWZpeH1uZXh0LWF1dGgucGtjZS5jb2RlX3ZlcmlmaWVyYCxcbiAgc3RhdGU6IGAke2Nvb2tpZVByZWZpeH1uZXh0LWF1dGguc3RhdGVgLFxuICBub25jZTogYCR7Y29va2llUHJlZml4fW5leHQtYXV0aC5ub25jZWBcbn07XG5cbmNvbnN0IGNvb2tpZXM6IE5leHRBdXRoT3B0aW9uc1snY29va2llcyddID0gT2JqZWN0LmZyb21FbnRyaWVzKFxuICBPYmplY3QuZW50cmllcyhjb29raWVzTWFwcGluZ0NvbmZpZykubWFwKChba2V5LCBuYW1lXSkgPT4gW1xuICAgIGtleSxcbiAgICB7XG4gICAgICBuYW1lLFxuICAgICAgb3B0aW9uczoge1xuICAgICAgICBodHRwT25seTogdHJ1ZSxcbiAgICAgICAgc2FtZVNpdGU6ICdsYXgnLFxuICAgICAgICBwYXRoOiAnLycsXG4gICAgICAgIHNlY3VyZTogaXNTZWN1cmVDb29raWVzLFxuICAgICAgICBkb21haW46IGVudi5DT09LSUVfRE9NQUlOXG4gICAgICB9XG4gICAgfVxuICBdKVxuKTtcblxuZXhwb3J0IGNvbnN0IG5leHRBdXRoT3B0aW9uczogTmV4dEF1dGhPcHRpb25zID0ge1xuICBwcm92aWRlcnMsXG4gIGNvb2tpZXMsXG4gIHNlY3JldDogZW52LlNFU1NJT05fU0VDUkVULFxuICBwYWdlczoge1xuICAgIGVycm9yOiAnL2FwaS9hdXRoL2Vycm9yJ1xuICB9LFxuICBjYWxsYmFja3M6IHtcbiAgICBhc3luYyBzaWduSW4oeyB1c2VyLCBhY2NvdW50LCBwcm9maWxlIH0pIHtcbiAgICAgIGNvbnN0IHN1ZG9Db250ZXh0ID0gKGF3YWl0IGdldEtleXN0b25lQ29udGV4dCgpKS5zdWRvKCk7XG5cbiAgICAgIGlmICghYWNjb3VudCkgdGhyb3cgbmV3IEVycm9yKCdNaXNzaW5nIGFjY291bnQgcGFyYW0nKTtcbiAgICAgIGNvbnN0IHsgcHJvdmlkZXJBY2NvdW50SWQsIHByb3ZpZGVyIH0gPSBhY2NvdW50O1xuXG4gICAgICBjb25zdCBlbWFpbCA9IHVzZXIuZW1haWw/LnRvTG93ZXJDYXNlKCk7XG4gICAgICBpZiAoIWVtYWlsKSByZXR1cm4gZmFsc2U7XG5cbiAgICAgIGNvbnN0IGRvbWFpbiA9IGV4dHJhY3REb21haW4oZW1haWwpO1xuICAgICAgY29uc3Qgbm93SXNvID0gbmV3IERhdGUoKS50b0lTT1N0cmluZygpO1xuICAgICAgY29uc3QgZXh0cmFjdGVkRGF0YSA9IGV4dHJhY3RVc2VyRGF0YShwcm92aWRlciwgeyB1c2VyLCBwcm9maWxlIH0pIGFzIFJlY29yZDxzdHJpbmcsIHVua25vd24+O1xuXG4gICAgICBjb25zdCBleGlzdGluZ1VzZXJzID0gKGF3YWl0IHN1ZG9Db250ZXh0LnF1ZXJ5LlVzZXIuZmluZE1hbnkoe1xuICAgICAgICB3aGVyZTogeyBlbWFpbDogeyBlcXVhbHM6IGVtYWlsIH0gfSxcbiAgICAgICAgcXVlcnk6ICdpZCBvcmcgeyBpZCB9IGxvY2F0aW9uIHsgaWQgfSdcbiAgICAgIH0pKSBhcyAoUGljazxVc2VySXRlbSwgJ2lkJz4gJiB7XG4gICAgICAgIG9yZzogUGljazxPcmdhbml6YXRpb25JdGVtLCAnaWQnPiB8IG51bGw7XG4gICAgICAgIGxvY2F0aW9uOiBQaWNrPExvY2F0aW9uSXRlbSwgJ2lkJz4gfCBudWxsO1xuICAgICAgfSlbXTtcblxuICAgICAgY29uc3QgYmFzZVVzZXJEYXRhID0ge1xuICAgICAgICBlbWFpbCxcbiAgICAgICAgZmlyc3ROYW1lOiBleHRyYWN0ZWREYXRhLmZpcnN0TmFtZSA/PyAnJyxcbiAgICAgICAgbGFzdE5hbWU6IGV4dHJhY3RlZERhdGEubGFzdE5hbWUgPz8gJycsXG4gICAgICAgIGF2YXRhclNvY2lhbFVybDogZXh0cmFjdGVkRGF0YS5waWN0dXJlVXJsID8/ICcnLFxuICAgICAgICByb2xlOiBVc2VyUm9sZS5VU0VSLFxuICAgICAgICBwcm92aWRlckFjY291bnRJZCxcbiAgICAgICAgcHJvdmlkZXI6IHByb3ZpZGVyIGFzIFByb3ZpZGVyVHlwZSxcbiAgICAgICAgcmF3QXV0aDoge1xuICAgICAgICAgIHVzZXI6IHVzZXIgYXMgdW5rbm93biBhcyBSZWNvcmQ8c3RyaW5nLCB1bmtub3duPixcbiAgICAgICAgICBwcm9maWxlOiBwcm9maWxlIGFzIHVua25vd24gYXMgUmVjb3JkPHN0cmluZywgdW5rbm93bj4sXG4gICAgICAgICAgYWNjb3VudDogYWNjb3VudCBhcyB1bmtub3duIGFzIFJlY29yZDxzdHJpbmcsIHVua25vd24+XG4gICAgICAgIH0gYXMgSlNPTlZhbHVlXG4gICAgICB9IHNhdGlzZmllcyBSZWNvcmQ8c3RyaW5nLCB1bmtub3duPjtcblxuICAgICAgbGV0IG1hdGNoZWRPcmdJZDogc3RyaW5nIHwgbnVsbCA9IG51bGw7XG4gICAgICBpZiAoZG9tYWluICYmICFmcmVlRW1haWxEb21haW5TZXQuaGFzKGRvbWFpbikpIHtcbiAgICAgICAgY29uc3Qgb3JncyA9IChhd2FpdCBzdWRvQ29udGV4dC5xdWVyeS5Pcmdhbml6YXRpb24uZmluZE1hbnkoe1xuICAgICAgICAgIHF1ZXJ5OiAnaWQgYXV0b2pvaW5Eb21haW5zJ1xuICAgICAgICB9KSkgYXMgKFBpY2s8T3JnYW5pemF0aW9uSXRlbSwgJ2lkJz4gJiB7IGF1dG9qb2luRG9tYWluczogdW5rbm93biB9KVtdO1xuICAgICAgICBjb25zdCBtYXRjaGVkT3JnID0gb3Jncy5maW5kKGNhbmRpZGF0ZSA9PiB7XG4gICAgICAgICAgY29uc3QgZG9tYWlucyA9IEFycmF5LmlzQXJyYXkoY2FuZGlkYXRlLmF1dG9qb2luRG9tYWlucykgPyAoY2FuZGlkYXRlLmF1dG9qb2luRG9tYWlucyBhcyBzdHJpbmdbXSkgOiBbXTtcbiAgICAgICAgICByZXR1cm4gZG9tYWlucy5tYXAodmFsdWUgPT4gdmFsdWU/LnRvTG93ZXJDYXNlPy4oKSB8fCAnJykuaW5jbHVkZXMoZG9tYWluKTtcbiAgICAgICAgfSk7XG4gICAgICAgIG1hdGNoZWRPcmdJZCA9IG1hdGNoZWRPcmc/LmlkID8/IG51bGw7XG4gICAgICB9XG5cbiAgICAgIGxldCBsb2NhdGlvblRvQ29ubmVjdDogeyBpZDogc3RyaW5nIH0gfCBudWxsID0gbnVsbDtcbiAgICAgIGlmIChtYXRjaGVkT3JnSWQpIHtcbiAgICAgICAgY29uc3QgY2FuZGlkYXRlTG9jYXRpb25zID0gKGF3YWl0IHN1ZG9Db250ZXh0LnF1ZXJ5LkxvY2F0aW9uLmZpbmRNYW55KHtcbiAgICAgICAgICB3aGVyZTogeyBvcmc6IHsgaWQ6IHsgZXF1YWxzOiBtYXRjaGVkT3JnSWQgfSB9IH0sXG4gICAgICAgICAgdGFrZTogMSxcbiAgICAgICAgICBxdWVyeTogJ2lkJ1xuICAgICAgICB9KSkgYXMgUGljazxMb2NhdGlvbkl0ZW0sICdpZCc+W107XG4gICAgICAgIGNvbnN0IHByaW1hcnlMb2NhdGlvbiA9IGNhbmRpZGF0ZUxvY2F0aW9ucz8uWzBdO1xuICAgICAgICBpZiAoIXByaW1hcnlMb2NhdGlvbj8uaWQpIHtcbiAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0F1dG8tam9pbiB0YXJnZXQgb3JnYW5pemF0aW9uIGRvZXMgbm90IGhhdmUgYSBsb2NhdGlvbiBjb25maWd1cmVkLicpO1xuICAgICAgICB9XG4gICAgICAgIGxvY2F0aW9uVG9Db25uZWN0ID0geyBpZDogcHJpbWFyeUxvY2F0aW9uLmlkIH07XG4gICAgICB9XG5cbiAgICAgIGlmIChleGlzdGluZ1VzZXJzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgY29uc3QgZXhpc3RpbmdVc2VyID0gZXhpc3RpbmdVc2Vyc1swXSBhcyBQaWNrPFVzZXJJdGVtLCAnaWQnPiAmIHtcbiAgICAgICAgICBvcmc6IFBpY2s8T3JnYW5pemF0aW9uSXRlbSwgJ2lkJz4gfCBudWxsO1xuICAgICAgICAgIGxvY2F0aW9uOiBQaWNrPExvY2F0aW9uSXRlbSwgJ2lkJz4gfCBudWxsO1xuICAgICAgICB9O1xuICAgICAgICBjb25zdCB7IHJvbGU6IF8sIC4uLnVzZXJEYXRhV2l0aG91dFJvbGUgfSA9IGJhc2VVc2VyRGF0YTtcbiAgICAgICAgYXdhaXQgc3Vkb0NvbnRleHQuZGIuVXNlci51cGRhdGVPbmUoe1xuICAgICAgICAgIHdoZXJlOiB7IGlkOiBleGlzdGluZ1VzZXIuaWQgfSxcbiAgICAgICAgICBkYXRhOiB7XG4gICAgICAgICAgICAuLi51c2VyRGF0YVdpdGhvdXRSb2xlLFxuICAgICAgICAgICAgcHJvdmlzaW9uZWRBdDogbm93SXNvLFxuICAgICAgICAgICAgLi4uKG1hdGNoZWRPcmdJZCAmJiAhZXhpc3RpbmdVc2VyLm9yZz8uaWQgPyB7IG9yZzogeyBjb25uZWN0OiB7IGlkOiBtYXRjaGVkT3JnSWQgfSB9IH0gOiB7fSksXG4gICAgICAgICAgICAuLi4obG9jYXRpb25Ub0Nvbm5lY3QgJiYgIWV4aXN0aW5nVXNlci5sb2NhdGlvbj8uaWQgPyB7IGxvY2F0aW9uOiB7IGNvbm5lY3Q6IGxvY2F0aW9uVG9Db25uZWN0IH0gfSA6IHt9KVxuICAgICAgICAgIH0sXG4gICAgICAgICAgcXVlcnk6ICdpZCdcbiAgICAgICAgfSBhcyBQYXJhbWV0ZXJzPHR5cGVvZiBzdWRvQ29udGV4dC5kYi5Vc2VyLnVwZGF0ZU9uZT5bMF0gJiB7IHF1ZXJ5OiBzdHJpbmcgfSk7XG5cbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICB9XG5cbiAgICAgIGNvbnN0IGNyZWF0ZWQgPSBhd2FpdCBzdWRvQ29udGV4dC5kYi5Vc2VyLmNyZWF0ZU9uZSh7XG4gICAgICAgIGRhdGE6IHtcbiAgICAgICAgICAuLi5iYXNlVXNlckRhdGEsXG4gICAgICAgICAgcHJvdmlzaW9uZWRBdDogbm93SXNvLFxuICAgICAgICAgIC4uLihtYXRjaGVkT3JnSWQgPyB7IG9yZzogeyBjb25uZWN0OiB7IGlkOiBtYXRjaGVkT3JnSWQgfSB9IH0gOiB7fSksXG4gICAgICAgICAgLi4uKGxvY2F0aW9uVG9Db25uZWN0ID8geyBsb2NhdGlvbjogeyBjb25uZWN0OiBsb2NhdGlvblRvQ29ubmVjdCB9IH0gOiB7fSlcbiAgICAgICAgfSxcbiAgICAgICAgcXVlcnk6ICdpZCdcbiAgICAgIH0gYXMgUGFyYW1ldGVyczx0eXBlb2Ygc3Vkb0NvbnRleHQuZGIuVXNlci5jcmVhdGVPbmU+WzBdICYgeyBxdWVyeTogc3RyaW5nIH0pO1xuXG4gICAgICByZXR1cm4gISFjcmVhdGVkPy5pZDtcbiAgICB9LFxuXG4gICAgYXN5bmMgand0KHsgdG9rZW4sIHVzZXIsIGFjY291bnQsIHByb2ZpbGUgfSkge1xuICAgICAgaWYgKCFhY2NvdW50KSByZXR1cm4gdG9rZW47XG5cbiAgICAgIGNvbnN0IGV4dHJhY3RlZCA9IGV4dHJhY3RVc2VyRGF0YShhY2NvdW50LnByb3ZpZGVyLCB7IHVzZXIsIHByb2ZpbGUgfSkgYXMgUmVjb3JkPHN0cmluZywgdW5rbm93bj47XG4gICAgICBjb25zdCBub3JtYWxpemVkRW1haWwgPSB0eXBlb2YgZXh0cmFjdGVkLmVtYWlsID09PSAnc3RyaW5nJyA/IGV4dHJhY3RlZC5lbWFpbC50b0xvd2VyQ2FzZSgpIDogbnVsbDtcblxuICAgICAgcmV0dXJuIHtcbiAgICAgICAgLi4udG9rZW4sXG4gICAgICAgIHVzZXJEYXRhOiB7XG4gICAgICAgICAgLi4uZXh0cmFjdGVkLFxuICAgICAgICAgIGVtYWlsOiBub3JtYWxpemVkRW1haWwgPz8gZXh0cmFjdGVkLmVtYWlsID8/IG51bGxcbiAgICAgICAgfVxuICAgICAgfTtcbiAgICB9LFxuXG4gICAgYXN5bmMgc2Vzc2lvbih7IHNlc3Npb24sIHRva2VuIH0pIHtcbiAgICAgIHR5cGUgVXNlckRhdGEgPSB7XG4gICAgICAgIGVtYWlsPzogc3RyaW5nIHwgbnVsbDtcbiAgICAgICAgZmlyc3ROYW1lPzogc3RyaW5nIHwgbnVsbDtcbiAgICAgICAgbGFzdE5hbWU/OiBzdHJpbmcgfCBudWxsO1xuICAgICAgfTtcbiAgICAgIGNvbnN0IHVzZXJEYXRhID0gKHRva2VuLnVzZXJEYXRhIGFzIFVzZXJEYXRhIHwgdW5kZWZpbmVkKSA/PyB7fTtcblxuICAgICAgY29uc3Qgbm9ybWFsaXplZEVtYWlsID0gdHlwZW9mIHVzZXJEYXRhPy5lbWFpbCA9PT0gJ3N0cmluZycgPyB1c2VyRGF0YS5lbWFpbC50b0xvd2VyQ2FzZSgpIDogbnVsbDtcbiAgICAgIGlmICghbm9ybWFsaXplZEVtYWlsKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcignSW52YWxpZCBzZXNzaW9uOiBubyBlbWFpbCBmb3VuZCcpO1xuICAgICAgfVxuXG4gICAgICBjb25zdCBzdWRvQ29udGV4dCA9IChhd2FpdCBnZXRLZXlzdG9uZUNvbnRleHQoKSkuc3VkbygpO1xuXG4gICAgICBjb25zdCBkYlVzZXIgPSAoYXdhaXQgc3Vkb0NvbnRleHQucXVlcnkuVXNlci5maW5kTWFueSh7XG4gICAgICAgIHdoZXJlOiB7IGVtYWlsOiB7IGVxdWFsczogbm9ybWFsaXplZEVtYWlsIH0gfSxcbiAgICAgICAgcXVlcnk6ICdpZCBlbWFpbCBvcmcgeyBpZCB9IGxvY2F0aW9uIHsgaWQgfSByb2xlIHByb3ZpZGVyQWNjb3VudElkIGlzQWN0aXZlIHNlZW5BdCBhdmF0YXJVcmwgZGlzcGxheU5hbWUnXG4gICAgICB9KSkgYXMgKFBpY2s8VXNlckl0ZW0sICdpZCcgfCAnZW1haWwnIHwgJ3JvbGUnIHwgJ3Byb3ZpZGVyQWNjb3VudElkJyB8ICdpc0FjdGl2ZScgfCAnc2VlbkF0Jz4gJiB7XG4gICAgICAgIG9yZzogUGljazxPcmdhbml6YXRpb25JdGVtLCAnaWQnPiB8IG51bGw7XG4gICAgICAgIGxvY2F0aW9uOiBQaWNrPExvY2F0aW9uSXRlbSwgJ2lkJz4gfCBudWxsO1xuICAgICAgICBhdmF0YXJVcmw/OiBzdHJpbmcgfCBudWxsO1xuICAgICAgICBkaXNwbGF5TmFtZT86IHN0cmluZyB8IG51bGw7XG4gICAgICB9KVtdO1xuXG4gICAgICBpZiAoIWRiVXNlciB8fCBkYlVzZXIubGVuZ3RoID09PSAwKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcignVXNlciBub3QgZm91bmQgaW4gZGF0YWJhc2UnKTtcbiAgICAgIH1cblxuICAgICAgY29uc3QgdXNlciA9IGRiVXNlclswXTtcblxuICAgICAgY29uc3QgaXNEZWFjdGl2YXRlZCA9ICF1c2VyLmlzQWN0aXZlO1xuXG4gICAgICBjb25zdCBzZWVuQXQgPSBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCk7XG4gICAgICBhd2FpdCBzdWRvQ29udGV4dC5kYi5Vc2VyLnVwZGF0ZU9uZSh7XG4gICAgICAgIHdoZXJlOiB7IGlkOiB1c2VyLmlkIH0sXG4gICAgICAgIGRhdGE6IHsgc2VlbkF0IH0sXG4gICAgICAgIHF1ZXJ5OiAnaWQnXG4gICAgICB9IGFzIFBhcmFtZXRlcnM8dHlwZW9mIHN1ZG9Db250ZXh0LmRiLlVzZXIudXBkYXRlT25lPlswXSAmIHsgcXVlcnk6IHN0cmluZyB9KTtcblxuICAgICAgY29uc3QgZW1haWxEb21haW4gPSBleHRyYWN0RG9tYWluKHVzZXI/LmVtYWlsID8/IG5vcm1hbGl6ZWRFbWFpbCk7XG4gICAgICBjb25zdCBpc0F1dG9qb2luRG9tYWluQWxsb3dlZCA9ICEhKGVtYWlsRG9tYWluICYmICFmcmVlRW1haWxEb21haW5TZXQuaGFzKGVtYWlsRG9tYWluKSk7XG5cbiAgICAgIC8vIERlZmF1bHQgdG8gVVNFUiBpZiByb2xlIGlzIG5vdCBzZXRcbiAgICAgIGNvbnN0IHVzZXJSb2xlOiBVc2VyUm9sZSA9ICh1c2VyPy5yb2xlIGFzIFVzZXJSb2xlKSB8fCBVc2VyUm9sZS5VU0VSO1xuXG4gICAgICByZXR1cm4ge1xuICAgICAgICAuLi5zZXNzaW9uLFxuICAgICAgICBpZDogdXNlcj8uaWQsXG4gICAgICAgIGVtYWlsOiBub3JtYWxpemVkRW1haWwsXG4gICAgICAgIGZpcnN0TmFtZTogdXNlckRhdGE/LmZpcnN0TmFtZSxcbiAgICAgICAgbGFzdE5hbWU6IHVzZXJEYXRhPy5sYXN0TmFtZSxcbiAgICAgICAgYXZhdGFyVXJsOiB1c2VyPy5hdmF0YXJVcmwgfHwgbnVsbCxcbiAgICAgICAgZGlzcGxheU5hbWU6IHVzZXI/LmRpc3BsYXlOYW1lIHx8IG51bGwsXG4gICAgICAgIHByb3ZpZGVyQWNjb3VudElkOiB1c2VyPy5wcm92aWRlckFjY291bnRJZCB8fCBudWxsLFxuICAgICAgICBvcmdJZDogdXNlcj8ub3JnPy5pZCB8fCBudWxsLFxuICAgICAgICBsb2NhdGlvbklkOiB1c2VyPy5sb2NhdGlvbj8uaWQgfHwgbnVsbCxcbiAgICAgICAgcm9sZTogdXNlclJvbGUsXG4gICAgICAgIGVtYWlsRG9tYWluLFxuICAgICAgICBpc0F1dG9qb2luRG9tYWluQWxsb3dlZCxcbiAgICAgICAgaXNBY3RpdmU6IHVzZXIuaXNBY3RpdmUgPz8gdHJ1ZVxuICAgICAgfTtcbiAgICB9LFxuXG4gICAgYXN5bmMgcmVkaXJlY3QoeyB1cmwsIGJhc2VVcmwgfSkge1xuICAgICAgLy8gSWYgdGhpcyBpcyBhbiBlcnJvciByZWRpcmVjdCwgd2UgY2FuIG1vZGlmeSBpdCB0byBpbmNsdWRlIGFkZGl0aW9uYWwgcGFyYW1ldGVyc1xuICAgICAgaWYgKHVybC5pbmNsdWRlcygnL2FwaS9hdXRoL2Vycm9yJykpIHtcbiAgICAgICAgLy8gVGhlIGVycm9yIHBhZ2Ugd2lsbCBoYW5kbGUgZGlzcGxheWluZyB0aGUgZW1haWwgZnJvbSB0aGUgZXJyb3IgY29udGV4dFxuICAgICAgICByZXR1cm4gdXJsO1xuICAgICAgfVxuXG4gICAgICBpZiAoIXVybC5zdGFydHNXaXRoKGVudi5BUFBfVVJMKSAmJiAhdXJsLnN0YXJ0c1dpdGgoYmFzZVVybCkpIHJldHVybiBiYXNlVXJsO1xuICAgICAgcmV0dXJuIHVybDtcbiAgICB9XG4gIH1cbn07XG5cbmV4cG9ydCBjb25zdCBuZXh0QXV0aFNlc3Npb25TdHJhdGVneTogU2Vzc2lvblN0cmF0ZWd5PFNlc3Npb24sIFR5cGVJbmZvPFNlc3Npb24+PiA9IHtcbiAgYXN5bmMgZ2V0KHsgY29udGV4dCB9KSB7XG4gICAgY29uc3QgeyByZXEsIHJlcyB9ID0gY29udGV4dDtcbiAgICBjb25zdCB7IGhlYWRlcnMgfSA9IHJlcSA/PyB7fTtcblxuICAgIGlmICghaGVhZGVycz8uY29va2llIHx8ICFyZXMpIHJldHVybjtcblxuICAgIGNvbnN0IG5leHRBdXRoU2Vzc2lvbiA9IGF3YWl0IGdldFNlcnZlclNlc3Npb248TmV4dEF1dGhPcHRpb25zLCBTZXNzaW9uPihcbiAgICAgIHsgaGVhZGVycywgY29va2llczogcGFyc2VDb29raWVzKGhlYWRlcnMuY29va2llKSB9IGFzIGFueSxcbiAgICAgIHJlcyxcbiAgICAgIG5leHRBdXRoT3B0aW9uc1xuICAgICk7XG4gICAgaWYgKCFuZXh0QXV0aFNlc3Npb24pIHJldHVybjtcblxuICAgIC8vIFNob3VsZCB3ZSB2ZXJpZnkgdXNlciBsaW5lIGluIGV4YW1wbGVzP1xuICAgIC8vIGNvbnN0IHVzZXIgPSBhd2FpdCBjb250ZXh0LnN1ZG8oKS5kYi5Vc2VyLmZpbmRPbmUoeyB3aGVyZTogeyBlbWFpbDogbmV4dEF1dGhTZXNzaW9uLmVtYWlsIH0gfSk7XG4gICAgLy8gaWYgKCF1c2VyKSByZXR1cm47XG5cbiAgICByZXR1cm4gbmV4dEF1dGhTZXNzaW9uO1xuICB9LFxuXG4gIC8vIHdlIGRvbid0IG5lZWQgdGhlc2UgYXMgbmV4dC1hdXRoIGhhbmRsZSBzdGFydCBhbmQgZW5kIGZvciB1c1xuICBhc3luYyBzdGFydCgpIHtcbiAgICAvKiBlbXB0eSAqL1xuICB9LFxuICBhc3luYyBlbmQoKSB7XG4gICAgLyogZW1wdHkgKi9cbiAgfVxufTtcbiJdLCJuYW1lcyI6WyJwYXJzZSIsInBhcnNlQ29va2llcyIsImZyZWVFbWFpbERvbWFpbnMiLCJnZXRTZXJ2ZXJTZXNzaW9uIiwiZW52IiwiZ2V0S2V5c3RvbmVDb250ZXh0IiwiVXNlclJvbGUiLCJleHRyYWN0VXNlckRhdGEiLCJwcm92aWRlcnMiLCJmcmVlRW1haWxEb21haW5TZXQiLCJTZXQiLCJtYXAiLCJkb21haW4iLCJ0b0xvd2VyQ2FzZSIsImV4dHJhY3REb21haW4iLCJlbWFpbCIsInNwbGl0IiwiaXNTZWN1cmVDb29raWVzIiwiTkVYVEFVVEhfVVJMIiwic3RhcnRzV2l0aCIsImNvb2tpZVByZWZpeCIsImNvb2tpZXNNYXBwaW5nQ29uZmlnIiwic2Vzc2lvblRva2VuIiwiY2FsbGJhY2tVcmwiLCJjc3JmVG9rZW4iLCJwa2NlQ29kZVZlcmlmaWVyIiwic3RhdGUiLCJub25jZSIsImNvb2tpZXMiLCJPYmplY3QiLCJmcm9tRW50cmllcyIsImVudHJpZXMiLCJrZXkiLCJuYW1lIiwib3B0aW9ucyIsImh0dHBPbmx5Iiwic2FtZVNpdGUiLCJwYXRoIiwic2VjdXJlIiwiQ09PS0lFX0RPTUFJTiIsIm5leHRBdXRoT3B0aW9ucyIsInNlY3JldCIsIlNFU1NJT05fU0VDUkVUIiwicGFnZXMiLCJlcnJvciIsImNhbGxiYWNrcyIsInNpZ25JbiIsInVzZXIiLCJhY2NvdW50IiwicHJvZmlsZSIsInN1ZG9Db250ZXh0Iiwic3VkbyIsIkVycm9yIiwicHJvdmlkZXJBY2NvdW50SWQiLCJwcm92aWRlciIsIm5vd0lzbyIsIkRhdGUiLCJ0b0lTT1N0cmluZyIsImV4dHJhY3RlZERhdGEiLCJleGlzdGluZ1VzZXJzIiwicXVlcnkiLCJVc2VyIiwiZmluZE1hbnkiLCJ3aGVyZSIsImVxdWFscyIsImJhc2VVc2VyRGF0YSIsImZpcnN0TmFtZSIsImxhc3ROYW1lIiwiYXZhdGFyU29jaWFsVXJsIiwicGljdHVyZVVybCIsInJvbGUiLCJVU0VSIiwicmF3QXV0aCIsIm1hdGNoZWRPcmdJZCIsImhhcyIsIm9yZ3MiLCJPcmdhbml6YXRpb24iLCJtYXRjaGVkT3JnIiwiZmluZCIsImNhbmRpZGF0ZSIsImRvbWFpbnMiLCJBcnJheSIsImlzQXJyYXkiLCJhdXRvam9pbkRvbWFpbnMiLCJ2YWx1ZSIsImluY2x1ZGVzIiwiaWQiLCJsb2NhdGlvblRvQ29ubmVjdCIsImNhbmRpZGF0ZUxvY2F0aW9ucyIsIkxvY2F0aW9uIiwib3JnIiwidGFrZSIsInByaW1hcnlMb2NhdGlvbiIsImxlbmd0aCIsImV4aXN0aW5nVXNlciIsIl8iLCJ1c2VyRGF0YVdpdGhvdXRSb2xlIiwiZGIiLCJ1cGRhdGVPbmUiLCJkYXRhIiwicHJvdmlzaW9uZWRBdCIsImNvbm5lY3QiLCJsb2NhdGlvbiIsImNyZWF0ZWQiLCJjcmVhdGVPbmUiLCJqd3QiLCJ0b2tlbiIsImV4dHJhY3RlZCIsIm5vcm1hbGl6ZWRFbWFpbCIsInVzZXJEYXRhIiwic2Vzc2lvbiIsImRiVXNlciIsImlzRGVhY3RpdmF0ZWQiLCJpc0FjdGl2ZSIsInNlZW5BdCIsImVtYWlsRG9tYWluIiwiaXNBdXRvam9pbkRvbWFpbkFsbG93ZWQiLCJ1c2VyUm9sZSIsImF2YXRhclVybCIsImRpc3BsYXlOYW1lIiwib3JnSWQiLCJsb2NhdGlvbklkIiwicmVkaXJlY3QiLCJ1cmwiLCJiYXNlVXJsIiwiQVBQX1VSTCIsIm5leHRBdXRoU2Vzc2lvblN0cmF0ZWd5IiwiZ2V0IiwiY29udGV4dCIsInJlcSIsInJlcyIsImhlYWRlcnMiLCJjb29raWUiLCJuZXh0QXV0aFNlc3Npb24iLCJzdGFydCIsImVuZCJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(api)/../../auth.ts\n");

/***/ }),

/***/ "(api)/../../config/env.ts":
/*!***************************!*\
  !*** ../../config/env.ts ***!
  \***************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var dotenv__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! dotenv */ \"dotenv\");\n/* harmony import */ var dotenv__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(dotenv__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var envalid__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! envalid */ \"envalid\");\n/* harmony import */ var envalid__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(envalid__WEBPACK_IMPORTED_MODULE_1__);\n\ndotenv__WEBPACK_IMPORTED_MODULE_0___default().config();\n\nconst DEFAULT_PORT = 3000;\nconst DEFAULT_APP_URL = \"http://localhost:3000\";\nconst DEFAULT_BASE_URL = `http://localhost:${DEFAULT_PORT}`;\nconst DEFAULT_ALLOWED_ORIGINS = [\n    DEFAULT_APP_URL,\n    DEFAULT_BASE_URL\n].join(\",\");\nconst env = (0,envalid__WEBPACK_IMPORTED_MODULE_1__.cleanEnv)(process.env, {\n    NODE_ENV: (0,envalid__WEBPACK_IMPORTED_MODULE_1__.str)({\n        choices: [\n            \"development\",\n            \"production\"\n        ],\n        default: \"development\"\n    }),\n    DATABASE_URL: (0,envalid__WEBPACK_IMPORTED_MODULE_1__.url)(),\n    /**\n   * The secret used to encrypt session data and magic links using @hapi/iron.\n   * Please use a 32-char or more password.\n   */ SESSION_SECRET: (0,envalid__WEBPACK_IMPORTED_MODULE_1__.str)(),\n    APP_URL: (0,envalid__WEBPACK_IMPORTED_MODULE_1__.url)({\n        default: DEFAULT_APP_URL\n    }),\n    BASE_URL: (0,envalid__WEBPACK_IMPORTED_MODULE_1__.url)({\n        default: DEFAULT_BASE_URL\n    }),\n    NEXTAUTH_URL: (0,envalid__WEBPACK_IMPORTED_MODULE_1__.url)(),\n    ALLOWED_ORIGINS: (0,envalid__WEBPACK_IMPORTED_MODULE_1__.str)({\n        default: DEFAULT_ALLOWED_ORIGINS\n    }),\n    COOKIE_DOMAIN: (0,envalid__WEBPACK_IMPORTED_MODULE_1__.str)({\n        default: \"localhost\"\n    }),\n    DATABASE_PROVIDER: (0,envalid__WEBPACK_IMPORTED_MODULE_1__.str)({\n        choices: [\n            \"sqlite\",\n            \"postgresql\",\n            \"mysql\"\n        ],\n        default: \"sqlite\"\n    }),\n    GOOGLE_CLIENT_ID: (0,envalid__WEBPACK_IMPORTED_MODULE_1__.str)(),\n    GOOGLE_CLIENT_SECRET: (0,envalid__WEBPACK_IMPORTED_MODULE_1__.str)(),\n    CLOUDINARY_CLOUD_NAME: (0,envalid__WEBPACK_IMPORTED_MODULE_1__.str)(),\n    CLOUDINARY_API_KEY: (0,envalid__WEBPACK_IMPORTED_MODULE_1__.str)(),\n    CLOUDINARY_API_SECRET: (0,envalid__WEBPACK_IMPORTED_MODULE_1__.str)(),\n    CLOUDINARY_API_FOLDER: (0,envalid__WEBPACK_IMPORTED_MODULE_1__.str)()\n});\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (env);\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi4vLi4vY29uZmlnL2Vudi50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7OztBQUE0QjtBQUM1QkEsb0RBQWE7QUFFZ0M7QUFFN0MsTUFBTUssZUFBZTtBQUNyQixNQUFNQyxrQkFBa0I7QUFDeEIsTUFBTUMsbUJBQW1CLENBQUMsaUJBQWlCLEVBQUVGLGFBQWEsQ0FBQztBQUMzRCxNQUFNRywwQkFBMEI7SUFBQ0Y7SUFBaUJDO0NBQWlCLENBQUNFLElBQUksQ0FBQztBQUV6RSxNQUFNQyxNQUFNUixpREFBUUEsQ0FBQ1MsUUFBUUQsR0FBRyxFQUFFO0lBQ2hDRSxVQUFVVCw0Q0FBR0EsQ0FBQztRQUFFVSxTQUFTO1lBQUM7WUFBZTtTQUFhO1FBQUVDLFNBQVM7SUFBYztJQUMvRUMsY0FBY1gsNENBQUdBO0lBQ2pCOzs7R0FHQyxHQUNEWSxnQkFBZ0JiLDRDQUFHQTtJQUNuQmMsU0FBU2IsNENBQUdBLENBQUM7UUFBRVUsU0FBU1I7SUFBZ0I7SUFDeENZLFVBQVVkLDRDQUFHQSxDQUFDO1FBQUVVLFNBQVNQO0lBQWlCO0lBQzFDWSxjQUFjZiw0Q0FBR0E7SUFDakJnQixpQkFBaUJqQiw0Q0FBR0EsQ0FBQztRQUFFVyxTQUFTTjtJQUF3QjtJQUV4RGEsZUFBZWxCLDRDQUFHQSxDQUFDO1FBQUVXLFNBQVM7SUFBWTtJQUUxQ1EsbUJBQW1CbkIsNENBQUdBLENBQUM7UUFBRVUsU0FBUztZQUFDO1lBQVU7WUFBYztTQUFRO1FBQUVDLFNBQVM7SUFBUztJQUV2RlMsa0JBQWtCcEIsNENBQUdBO0lBQ3JCcUIsc0JBQXNCckIsNENBQUdBO0lBRXpCc0IsdUJBQXVCdEIsNENBQUdBO0lBQzFCdUIsb0JBQW9CdkIsNENBQUdBO0lBQ3ZCd0IsdUJBQXVCeEIsNENBQUdBO0lBQzFCeUIsdUJBQXVCekIsNENBQUdBO0FBQzVCO0FBRUEsaUVBQWVPLEdBQUdBLEVBQUMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi4vLi4vY29uZmlnL2Vudi50cz8zOWNmIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBkb3RlbnYgZnJvbSAnZG90ZW52JztcbmRvdGVudi5jb25maWcoKTtcblxuaW1wb3J0IHsgY2xlYW5FbnYsIHN0ciwgdXJsIH0gZnJvbSAnZW52YWxpZCc7XG5cbmNvbnN0IERFRkFVTFRfUE9SVCA9IDMwMDA7XG5jb25zdCBERUZBVUxUX0FQUF9VUkwgPSAnaHR0cDovL2xvY2FsaG9zdDozMDAwJztcbmNvbnN0IERFRkFVTFRfQkFTRV9VUkwgPSBgaHR0cDovL2xvY2FsaG9zdDoke0RFRkFVTFRfUE9SVH1gO1xuY29uc3QgREVGQVVMVF9BTExPV0VEX09SSUdJTlMgPSBbREVGQVVMVF9BUFBfVVJMLCBERUZBVUxUX0JBU0VfVVJMXS5qb2luKCcsJyk7XG5cbmNvbnN0IGVudiA9IGNsZWFuRW52KHByb2Nlc3MuZW52LCB7XG4gIE5PREVfRU5WOiBzdHIoeyBjaG9pY2VzOiBbJ2RldmVsb3BtZW50JywgJ3Byb2R1Y3Rpb24nXSwgZGVmYXVsdDogJ2RldmVsb3BtZW50JyB9KSxcbiAgREFUQUJBU0VfVVJMOiB1cmwoKSxcbiAgLyoqXG4gICAqIFRoZSBzZWNyZXQgdXNlZCB0byBlbmNyeXB0IHNlc3Npb24gZGF0YSBhbmQgbWFnaWMgbGlua3MgdXNpbmcgQGhhcGkvaXJvbi5cbiAgICogUGxlYXNlIHVzZSBhIDMyLWNoYXIgb3IgbW9yZSBwYXNzd29yZC5cbiAgICovXG4gIFNFU1NJT05fU0VDUkVUOiBzdHIoKSxcbiAgQVBQX1VSTDogdXJsKHsgZGVmYXVsdDogREVGQVVMVF9BUFBfVVJMIH0pLFxuICBCQVNFX1VSTDogdXJsKHsgZGVmYXVsdDogREVGQVVMVF9CQVNFX1VSTCB9KSxcbiAgTkVYVEFVVEhfVVJMOiB1cmwoKSwgLy8gbXVzdCBiZSBzZXQgaW4gLmVudiAtIHRoZSBucG0gcGFja2FnZSByZWFkcyBmcm9tIHRoZXJlXG4gIEFMTE9XRURfT1JJR0lOUzogc3RyKHsgZGVmYXVsdDogREVGQVVMVF9BTExPV0VEX09SSUdJTlMgfSksXG5cbiAgQ09PS0lFX0RPTUFJTjogc3RyKHsgZGVmYXVsdDogJ2xvY2FsaG9zdCcgfSksXG5cbiAgREFUQUJBU0VfUFJPVklERVI6IHN0cih7IGNob2ljZXM6IFsnc3FsaXRlJywgJ3Bvc3RncmVzcWwnLCAnbXlzcWwnXSwgZGVmYXVsdDogJ3NxbGl0ZScgfSksXG5cbiAgR09PR0xFX0NMSUVOVF9JRDogc3RyKCksXG4gIEdPT0dMRV9DTElFTlRfU0VDUkVUOiBzdHIoKSxcblxuICBDTE9VRElOQVJZX0NMT1VEX05BTUU6IHN0cigpLFxuICBDTE9VRElOQVJZX0FQSV9LRVk6IHN0cigpLFxuICBDTE9VRElOQVJZX0FQSV9TRUNSRVQ6IHN0cigpLFxuICBDTE9VRElOQVJZX0FQSV9GT0xERVI6IHN0cigpXG59KTtcblxuZXhwb3J0IGRlZmF1bHQgZW52O1xuIl0sIm5hbWVzIjpbImRvdGVudiIsImNvbmZpZyIsImNsZWFuRW52Iiwic3RyIiwidXJsIiwiREVGQVVMVF9QT1JUIiwiREVGQVVMVF9BUFBfVVJMIiwiREVGQVVMVF9CQVNFX1VSTCIsIkRFRkFVTFRfQUxMT1dFRF9PUklHSU5TIiwiam9pbiIsImVudiIsInByb2Nlc3MiLCJOT0RFX0VOViIsImNob2ljZXMiLCJkZWZhdWx0IiwiREFUQUJBU0VfVVJMIiwiU0VTU0lPTl9TRUNSRVQiLCJBUFBfVVJMIiwiQkFTRV9VUkwiLCJORVhUQVVUSF9VUkwiLCJBTExPV0VEX09SSUdJTlMiLCJDT09LSUVfRE9NQUlOIiwiREFUQUJBU0VfUFJPVklERVIiLCJHT09HTEVfQ0xJRU5UX0lEIiwiR09PR0xFX0NMSUVOVF9TRUNSRVQiLCJDTE9VRElOQVJZX0NMT1VEX05BTUUiLCJDTE9VRElOQVJZX0FQSV9LRVkiLCJDTE9VRElOQVJZX0FQSV9TRUNSRVQiLCJDTE9VRElOQVJZX0FQSV9GT0xERVIiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(api)/../../config/env.ts\n");

/***/ }),

/***/ "(api)/../../context/keystoneContext.ts":
/*!****************************************!*\
  !*** ../../context/keystoneContext.ts ***!
  \****************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   getKeystoneContext: () => (/* binding */ getKeystoneContext)\n/* harmony export */ });\n/* harmony import */ var _keystone_6_core_context__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @keystone-6/core/context */ \"@keystone-6/core/context\");\n/* harmony import */ var _keystone_6_core_context__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_keystone_6_core_context__WEBPACK_IMPORTED_MODULE_0__);\n\nlet _keystoneContext = globalThis._keystoneContext;\nconst getKeystoneContext = async ()=>{\n    _keystoneContext = _keystoneContext || (0,_keystone_6_core_context__WEBPACK_IMPORTED_MODULE_0__.getContext)((await __webpack_require__.e(/*! import() */ \"_api_keystone_ts\").then(__webpack_require__.bind(__webpack_require__, /*! ../keystone */ \"(api)/../../keystone.ts\"))).default, await Promise.resolve(/*! import() */).then(__webpack_require__.t.bind(__webpack_require__, /*! @prisma/client */ \"@prisma/client\", 23)));\n    if (true) {\n        globalThis._keystoneContext = _keystoneContext;\n    }\n    return _keystoneContext;\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi4vLi4vY29udGV4dC9rZXlzdG9uZUNvbnRleHQudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQXNEO0FBR3RELElBQUlDLG1CQUE0QixXQUFvQkEsZ0JBQWdCO0FBQzdELE1BQU1FLHFCQUFxQjtJQUNoQ0YsbUJBQ0VBLG9CQUFvQkQsb0VBQVVBLENBQUMsQ0FBQyxNQUFNLDJKQUFvQixFQUFHSSxPQUFPLEVBQUUsTUFBTSxrSUFBTztJQUNyRixJQUFJQyxJQUF5QixFQUFjO1FBQ3hDSCxXQUFtQkQsZ0JBQWdCLEdBQUdBO0lBQ3pDO0lBQ0EsT0FBT0E7QUFDVCxFQUFFIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLy4uLy4uL2NvbnRleHQva2V5c3RvbmVDb250ZXh0LnRzPzk1ZmIiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgZ2V0Q29udGV4dCB9IGZyb20gJ0BrZXlzdG9uZS02L2NvcmUvY29udGV4dCc7XG5pbXBvcnQgeyBDb250ZXh0IH0gZnJvbSAnLmtleXN0b25lL3R5cGVzJztcblxubGV0IF9rZXlzdG9uZUNvbnRleHQ6IENvbnRleHQgPSAoZ2xvYmFsVGhpcyBhcyBhbnkpLl9rZXlzdG9uZUNvbnRleHQ7XG5leHBvcnQgY29uc3QgZ2V0S2V5c3RvbmVDb250ZXh0ID0gYXN5bmMgKCkgPT4ge1xuICBfa2V5c3RvbmVDb250ZXh0ID1cbiAgICBfa2V5c3RvbmVDb250ZXh0IHx8IGdldENvbnRleHQoKGF3YWl0IGltcG9ydCgnLi4va2V5c3RvbmUnKSkuZGVmYXVsdCwgYXdhaXQgaW1wb3J0KCdAcHJpc21hL2NsaWVudCcpKTtcbiAgaWYgKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicpIHtcbiAgICAoZ2xvYmFsVGhpcyBhcyBhbnkpLl9rZXlzdG9uZUNvbnRleHQgPSBfa2V5c3RvbmVDb250ZXh0O1xuICB9XG4gIHJldHVybiBfa2V5c3RvbmVDb250ZXh0O1xufTtcbiJdLCJuYW1lcyI6WyJnZXRDb250ZXh0IiwiX2tleXN0b25lQ29udGV4dCIsImdsb2JhbFRoaXMiLCJnZXRLZXlzdG9uZUNvbnRleHQiLCJkZWZhdWx0IiwicHJvY2VzcyJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(api)/../../context/keystoneContext.ts\n");

/***/ }),

/***/ "(api)/../../domains/auth/google.ts":
/*!************************************!*\
  !*** ../../domains/auth/google.ts ***!
  \************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   getInformationFromProfile: () => (/* binding */ getInformationFromProfile)\n/* harmony export */ });\nconst getInformationFromProfile = ({ profile })=>({\n        email: profile.email,\n        firstName: profile.given_name,\n        lastName: profile.family_name,\n        pictureUrl: profile.picture\n    });\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi4vLi4vZG9tYWlucy9hdXRoL2dvb2dsZS50cyIsIm1hcHBpbmdzIjoiOzs7O0FBRU8sTUFBTUEsNEJBQTRCLENBQUMsRUFBRUMsT0FBTyxFQUE4QixHQUFNO1FBQ3JGQyxPQUFPRCxRQUFRQyxLQUFLO1FBQ3BCQyxXQUFXRixRQUFRRyxVQUFVO1FBQzdCQyxVQUFVSixRQUFRSyxXQUFXO1FBQzdCQyxZQUFZTixRQUFRTyxPQUFPO0lBQzdCLEdBQUciLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi4vLi4vZG9tYWlucy9hdXRoL2dvb2dsZS50cz82ZGFhIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEdvb2dsZVByb2ZpbGUgfSBmcm9tICduZXh0LWF1dGgvcHJvdmlkZXJzL2dvb2dsZSc7XG5cbmV4cG9ydCBjb25zdCBnZXRJbmZvcm1hdGlvbkZyb21Qcm9maWxlID0gKHsgcHJvZmlsZSB9OiB7IHByb2ZpbGU6IEdvb2dsZVByb2ZpbGUgfSkgPT4gKHtcbiAgZW1haWw6IHByb2ZpbGUuZW1haWwsXG4gIGZpcnN0TmFtZTogcHJvZmlsZS5naXZlbl9uYW1lLFxuICBsYXN0TmFtZTogcHJvZmlsZS5mYW1pbHlfbmFtZSxcbiAgcGljdHVyZVVybDogcHJvZmlsZS5waWN0dXJlXG59KTtcbiJdLCJuYW1lcyI6WyJnZXRJbmZvcm1hdGlvbkZyb21Qcm9maWxlIiwicHJvZmlsZSIsImVtYWlsIiwiZmlyc3ROYW1lIiwiZ2l2ZW5fbmFtZSIsImxhc3ROYW1lIiwiZmFtaWx5X25hbWUiLCJwaWN0dXJlVXJsIiwicGljdHVyZSJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(api)/../../domains/auth/google.ts\n");

/***/ }),

/***/ "(api)/../../domains/auth/userRole.ts":
/*!**************************************!*\
  !*** ../../domains/auth/userRole.ts ***!
  \**************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   UserRole: () => (/* binding */ UserRole),\n/* harmony export */   canEditLocationData: () => (/* binding */ canEditLocationData),\n/* harmony export */   canEditOrgData: () => (/* binding */ canEditOrgData),\n/* harmony export */   canEditUserByRole: () => (/* binding */ canEditUserByRole),\n/* harmony export */   filterByUserLocation: () => (/* binding */ filterByUserLocation),\n/* harmony export */   filterByUserOrg: () => (/* binding */ filterByUserOrg),\n/* harmony export */   filterPoliciesByUserLocation: () => (/* binding */ filterPoliciesByUserLocation),\n/* harmony export */   filterTimeTypesByUserLocation: () => (/* binding */ filterTimeTypesByUserLocation),\n/* harmony export */   hasRole: () => (/* binding */ hasRole),\n/* harmony export */   isAnyAdmin: () => (/* binding */ isAnyAdmin),\n/* harmony export */   isAuthenticated: () => (/* binding */ isAuthenticated),\n/* harmony export */   isGod: () => (/* binding */ isGod),\n/* harmony export */   isLocationAdmin: () => (/* binding */ isLocationAdmin),\n/* harmony export */   isOrgAdmin: () => (/* binding */ isOrgAdmin),\n/* harmony export */   isOrgAdminOrAbove: () => (/* binding */ isOrgAdminOrAbove),\n/* harmony export */   isOrgScoped: () => (/* binding */ isOrgScoped),\n/* harmony export */   isSelf: () => (/* binding */ isSelf),\n/* harmony export */   roleHierarchy: () => (/* binding */ roleHierarchy)\n/* harmony export */ });\nvar UserRole;\n(function(UserRole) {\n    UserRole[\"USER\"] = \"USER\";\n    UserRole[\"LOCATION_ADMIN\"] = \"LOCATION_ADMIN\";\n    UserRole[\"ORG_ADMIN\"] = \"ORG_ADMIN\";\n    UserRole[\"ORG_OWNER\"] = \"ORG_OWNER\";\n    UserRole[\"GOD\"] = \"GOD\";\n})(UserRole || (UserRole = {}));\nconst roleHierarchy = {\n    [\"USER\"]: 0,\n    [\"LOCATION_ADMIN\"]: 1,\n    [\"ORG_ADMIN\"]: 2,\n    [\"ORG_OWNER\"]: 3,\n    [\"GOD\"]: 4\n};\nconst isAuthenticated = ({ session })=>!!session?.email;\nconst hasRole = (roles)=>({ session })=>{\n        if (!session?.role) return false;\n        return roles.includes(session?.role);\n    };\n// Semantic helper functions for common role checks\nconst isGod = hasRole([\n    \"GOD\"\n]);\nconst isOrgAdmin = hasRole([\n    \"ORG_ADMIN\",\n    \"ORG_OWNER\"\n]);\nconst isLocationAdmin = hasRole([\n    \"LOCATION_ADMIN\"\n]);\nconst isOrgAdminOrAbove = hasRole([\n    \"GOD\",\n    \"ORG_ADMIN\",\n    \"ORG_OWNER\"\n]);\nconst isAnyAdmin = hasRole([\n    \"GOD\",\n    \"ORG_ADMIN\",\n    \"ORG_OWNER\",\n    \"LOCATION_ADMIN\"\n]);\nconst isOrgScoped = async ({ session })=>{\n    if (isGod({\n        session\n    })) return true;\n    if (!session?.orgId) return false;\n    return {\n        org: {\n            id: {\n                equals: session.orgId\n            }\n        }\n    };\n};\nconst isSelf = async ({ session })=>{\n    if (!session?.id) return false;\n    return {\n        id: {\n            equals: session.id\n        }\n    };\n};\nconst canEditOrgData = ({ session })=>isGod({\n        session\n    }) || isOrgAdmin({\n        session\n    });\nconst canEditLocationData = ({ session })=>isGod({\n        session\n    }) || isOrgAdmin({\n        session\n    }) || isLocationAdmin({\n        session\n    });\nconst filterByUserLocation = async ({ session })=>{\n    if (!session?.locationId) return false;\n    return {\n        location: {\n            id: {\n                equals: session.locationId\n            }\n        }\n    };\n};\nconst filterByUserOrg = async ({ session })=>{\n    if (!session?.orgId) return false;\n    return {\n        org: {\n            id: {\n                equals: session.orgId\n            }\n        }\n    };\n};\nconst filterTimeTypesByUserLocation = async ({ session })=>{\n    if (!session?.orgId || !session?.locationId) return false;\n    return {\n        org: {\n            id: {\n                equals: session.orgId\n            }\n        },\n        timePolicies: {\n            some: {\n                locations: {\n                    some: {\n                        id: {\n                            equals: session.locationId\n                        }\n                    }\n                }\n            }\n        }\n    };\n};\nconst filterPoliciesByUserLocation = async ({ session })=>{\n    if (!session?.orgId || !session?.locationId) return false;\n    return {\n        org: {\n            id: {\n                equals: session.orgId\n            }\n        },\n        locations: {\n            some: {\n                id: {\n                    equals: session.locationId\n                }\n            }\n        }\n    };\n};\n/**\n * Check if a user can edit another user based on role hierarchy\n * - LOCATION_ADMIN can only edit USER or LOCATION_ADMIN\n * - ORG_ADMIN can only edit USER, LOCATION_ADMIN, ORG_ADMIN\n * - ORG_OWNER can only edit USER, LOCATION_ADMIN, ORG_ADMIN, ORG_OWNER\n * - GOD can edit anyone\n */ const canEditUserByRole = (editorRole, targetRole)=>{\n    if (!editorRole || !targetRole) return false;\n    // GOD can edit anyone\n    if (editorRole === \"GOD\") return true;\n    const editorLevel = roleHierarchy[editorRole] ?? -1;\n    const targetLevel = roleHierarchy[targetRole] ?? Number.MAX_SAFE_INTEGER;\n    // Editor can only edit users with equal or lower role level\n    return targetLevel <= editorLevel;\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi4vLi4vZG9tYWlucy9hdXRoL3VzZXJSb2xlLnRzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7VUFHWUE7Ozs7OztHQUFBQSxhQUFBQTtBQVFMLE1BQU1DLGdCQUEwQztJQUNyRCxRQUFlLEVBQUU7SUFDakIsa0JBQXlCLEVBQUU7SUFDM0IsYUFBb0IsRUFBRTtJQUN0QixhQUFvQixFQUFFO0lBQ3RCLE9BQWMsRUFBRTtBQUNsQixFQUFFO0FBS0ssTUFBTUMsa0JBQWtCLENBQUMsRUFBRUMsT0FBTyxFQUF3QixHQUFLLENBQUMsQ0FBQ0EsU0FBU0MsTUFBTTtBQUVoRixNQUFNQyxVQUNYLENBQUNDLFFBQ0QsQ0FBQyxFQUFFSCxPQUFPLEVBQXdCO1FBQ2hDLElBQUksQ0FBQ0EsU0FBU0ksTUFBTSxPQUFPO1FBQzNCLE9BQU9ELE1BQU1FLFFBQVEsQ0FBQ0wsU0FBU0k7SUFDakMsRUFBRTtBQUVKLG1EQUFtRDtBQUM1QyxNQUFNRSxRQUFRSixRQUFROztDQUFjLEVBQUU7QUFDdEMsTUFBTUssYUFBYUwsUUFBUTs7O0NBQXdDLEVBQUU7QUFDckUsTUFBTU0sa0JBQWtCTixRQUFROztDQUF5QixFQUFFO0FBQzNELE1BQU1PLG9CQUFvQlAsUUFBUTs7OztDQUFzRCxFQUFFO0FBQzFGLE1BQU1RLGFBQWFSLFFBQVE7Ozs7O0NBQStFLEVBQUU7QUFFNUcsTUFBTVMsY0FBYyxPQUFPLEVBQUVYLE9BQU8sRUFBa0I7SUFDM0QsSUFBSU0sTUFBTTtRQUFFTjtJQUFRLElBQUksT0FBTztJQUMvQixJQUFJLENBQUNBLFNBQVNZLE9BQU8sT0FBTztJQUM1QixPQUFPO1FBQUVDLEtBQUs7WUFBRUMsSUFBSTtnQkFBRUMsUUFBUWYsUUFBUVksS0FBSztZQUFDO1FBQUU7SUFBRTtBQUNsRCxFQUFFO0FBRUssTUFBTUksU0FBUyxPQUFPLEVBQUVoQixPQUFPLEVBQXdCO0lBQzVELElBQUksQ0FBQ0EsU0FBU2MsSUFBSSxPQUFPO0lBQ3pCLE9BQU87UUFBRUEsSUFBSTtZQUFFQyxRQUFRZixRQUFRYyxFQUFFO1FBQUM7SUFBRTtBQUN0QyxFQUFFO0FBRUssTUFBTUcsaUJBQWlCLENBQUMsRUFBRWpCLE9BQU8sRUFBd0IsR0FBS00sTUFBTTtRQUFFTjtJQUFRLE1BQU1PLFdBQVc7UUFBRVA7SUFBUSxHQUFHO0FBRTVHLE1BQU1rQixzQkFBc0IsQ0FBQyxFQUFFbEIsT0FBTyxFQUF3QixHQUNuRU0sTUFBTTtRQUFFTjtJQUFRLE1BQU1PLFdBQVc7UUFBRVA7SUFBUSxNQUFNUSxnQkFBZ0I7UUFBRVI7SUFBUSxHQUFHO0FBRXpFLE1BQU1tQix1QkFBdUIsT0FBTyxFQUFFbkIsT0FBTyxFQUFrQjtJQUNwRSxJQUFJLENBQUNBLFNBQVNvQixZQUFZLE9BQU87SUFDakMsT0FBTztRQUFFQyxVQUFVO1lBQUVQLElBQUk7Z0JBQUVDLFFBQVFmLFFBQVFvQixVQUFVO1lBQUM7UUFBRTtJQUFFO0FBQzVELEVBQUU7QUFFSyxNQUFNRSxrQkFBa0IsT0FBTyxFQUFFdEIsT0FBTyxFQUFrQjtJQUMvRCxJQUFJLENBQUNBLFNBQVNZLE9BQU8sT0FBTztJQUM1QixPQUFPO1FBQUVDLEtBQUs7WUFBRUMsSUFBSTtnQkFBRUMsUUFBUWYsUUFBUVksS0FBSztZQUFDO1FBQUU7SUFBRTtBQUNsRCxFQUFFO0FBRUssTUFBTVcsZ0NBQWdDLE9BQU8sRUFBRXZCLE9BQU8sRUFBa0I7SUFDN0UsSUFBSSxDQUFDQSxTQUFTWSxTQUFTLENBQUNaLFNBQVNvQixZQUFZLE9BQU87SUFDcEQsT0FBTztRQUNMUCxLQUFLO1lBQUVDLElBQUk7Z0JBQUVDLFFBQVFmLFFBQVFZLEtBQUs7WUFBQztRQUFFO1FBQ3JDWSxjQUFjO1lBQ1pDLE1BQU07Z0JBQ0pDLFdBQVc7b0JBQ1RELE1BQU07d0JBQ0pYLElBQUk7NEJBQUVDLFFBQVFmLFFBQVFvQixVQUFVO3dCQUFDO29CQUNuQztnQkFDRjtZQUNGO1FBQ0Y7SUFDRjtBQUNGLEVBQUU7QUFFSyxNQUFNTywrQkFBK0IsT0FBTyxFQUFFM0IsT0FBTyxFQUFrQjtJQUM1RSxJQUFJLENBQUNBLFNBQVNZLFNBQVMsQ0FBQ1osU0FBU29CLFlBQVksT0FBTztJQUNwRCxPQUFPO1FBQ0xQLEtBQUs7WUFBRUMsSUFBSTtnQkFBRUMsUUFBUWYsUUFBUVksS0FBSztZQUFDO1FBQUU7UUFDckNjLFdBQVc7WUFDVEQsTUFBTTtnQkFDSlgsSUFBSTtvQkFBRUMsUUFBUWYsUUFBUW9CLFVBQVU7Z0JBQUM7WUFDbkM7UUFDRjtJQUNGO0FBQ0YsRUFBRTtBQUVGOzs7Ozs7Q0FNQyxHQUNNLE1BQU1RLG9CQUFvQixDQUMvQkMsWUFDQUM7SUFFQSxJQUFJLENBQUNELGNBQWMsQ0FBQ0MsWUFBWSxPQUFPO0lBRXZDLHNCQUFzQjtJQUN0QixJQUFJRCxzQkFBNkIsT0FBTztJQUV4QyxNQUFNRSxjQUFjakMsYUFBYSxDQUFDK0IsV0FBVyxJQUFJLENBQUM7SUFDbEQsTUFBTUcsY0FBY2xDLGFBQWEsQ0FBQ2dDLFdBQVcsSUFBSUcsT0FBT0MsZ0JBQWdCO0lBRXhFLDREQUE0RDtJQUM1RCxPQUFPRixlQUFlRDtBQUN4QixFQUFFIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLy4uLy4uL2RvbWFpbnMvYXV0aC91c2VyUm9sZS50cz85ODczIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IFNlc3Npb24gfSBmcm9tICcuLi8uLi9hdXRoJztcbmltcG9ydCB7IFVzZXIgfSBmcm9tICcuLi8uLi90eXBlcy9Vc2VyJztcblxuZXhwb3J0IGVudW0gVXNlclJvbGUge1xuICBVU0VSID0gJ1VTRVInLFxuICBMT0NBVElPTl9BRE1JTiA9ICdMT0NBVElPTl9BRE1JTicsXG4gIE9SR19BRE1JTiA9ICdPUkdfQURNSU4nLFxuICBPUkdfT1dORVIgPSAnT1JHX09XTkVSJyxcbiAgR09EID0gJ0dPRCdcbn1cblxuZXhwb3J0IGNvbnN0IHJvbGVIaWVyYXJjaHk6IFJlY29yZDxVc2VyUm9sZSwgbnVtYmVyPiA9IHtcbiAgW1VzZXJSb2xlLlVTRVJdOiAwLFxuICBbVXNlclJvbGUuTE9DQVRJT05fQURNSU5dOiAxLFxuICBbVXNlclJvbGUuT1JHX0FETUlOXTogMixcbiAgW1VzZXJSb2xlLk9SR19PV05FUl06IDMsXG4gIFtVc2VyUm9sZS5HT0RdOiA0XG59O1xuXG50eXBlIFNlc3Npb25PclVzZXJDb250ZXh0ID0geyBzZXNzaW9uPzogU2Vzc2lvbiB8IFVzZXIgfCBudWxsIH07XG50eXBlIFNlc3Npb25Db250ZXh0ID0geyBzZXNzaW9uPzogU2Vzc2lvbiB8IG51bGwgfTtcblxuZXhwb3J0IGNvbnN0IGlzQXV0aGVudGljYXRlZCA9ICh7IHNlc3Npb24gfTogU2Vzc2lvbk9yVXNlckNvbnRleHQpID0+ICEhc2Vzc2lvbj8uZW1haWw7XG5cbmV4cG9ydCBjb25zdCBoYXNSb2xlID1cbiAgKHJvbGVzOiBVc2VyUm9sZVtdKSA9PlxuICAoeyBzZXNzaW9uIH06IFNlc3Npb25PclVzZXJDb250ZXh0KSA9PiB7XG4gICAgaWYgKCFzZXNzaW9uPy5yb2xlKSByZXR1cm4gZmFsc2U7XG4gICAgcmV0dXJuIHJvbGVzLmluY2x1ZGVzKHNlc3Npb24/LnJvbGUpO1xuICB9O1xuXG4vLyBTZW1hbnRpYyBoZWxwZXIgZnVuY3Rpb25zIGZvciBjb21tb24gcm9sZSBjaGVja3NcbmV4cG9ydCBjb25zdCBpc0dvZCA9IGhhc1JvbGUoW1VzZXJSb2xlLkdPRF0pO1xuZXhwb3J0IGNvbnN0IGlzT3JnQWRtaW4gPSBoYXNSb2xlKFtVc2VyUm9sZS5PUkdfQURNSU4sIFVzZXJSb2xlLk9SR19PV05FUl0pO1xuZXhwb3J0IGNvbnN0IGlzTG9jYXRpb25BZG1pbiA9IGhhc1JvbGUoW1VzZXJSb2xlLkxPQ0FUSU9OX0FETUlOXSk7XG5leHBvcnQgY29uc3QgaXNPcmdBZG1pbk9yQWJvdmUgPSBoYXNSb2xlKFtVc2VyUm9sZS5HT0QsIFVzZXJSb2xlLk9SR19BRE1JTiwgVXNlclJvbGUuT1JHX09XTkVSXSk7XG5leHBvcnQgY29uc3QgaXNBbnlBZG1pbiA9IGhhc1JvbGUoW1VzZXJSb2xlLkdPRCwgVXNlclJvbGUuT1JHX0FETUlOLCBVc2VyUm9sZS5PUkdfT1dORVIsIFVzZXJSb2xlLkxPQ0FUSU9OX0FETUlOXSk7XG5cbmV4cG9ydCBjb25zdCBpc09yZ1Njb3BlZCA9IGFzeW5jICh7IHNlc3Npb24gfTogU2Vzc2lvbkNvbnRleHQpID0+IHtcbiAgaWYgKGlzR29kKHsgc2Vzc2lvbiB9KSkgcmV0dXJuIHRydWU7XG4gIGlmICghc2Vzc2lvbj8ub3JnSWQpIHJldHVybiBmYWxzZTtcbiAgcmV0dXJuIHsgb3JnOiB7IGlkOiB7IGVxdWFsczogc2Vzc2lvbi5vcmdJZCB9IH0gfTtcbn07XG5cbmV4cG9ydCBjb25zdCBpc1NlbGYgPSBhc3luYyAoeyBzZXNzaW9uIH06IFNlc3Npb25PclVzZXJDb250ZXh0KSA9PiB7XG4gIGlmICghc2Vzc2lvbj8uaWQpIHJldHVybiBmYWxzZTtcbiAgcmV0dXJuIHsgaWQ6IHsgZXF1YWxzOiBzZXNzaW9uLmlkIH0gfTtcbn07XG5cbmV4cG9ydCBjb25zdCBjYW5FZGl0T3JnRGF0YSA9ICh7IHNlc3Npb24gfTogU2Vzc2lvbk9yVXNlckNvbnRleHQpID0+IGlzR29kKHsgc2Vzc2lvbiB9KSB8fCBpc09yZ0FkbWluKHsgc2Vzc2lvbiB9KTtcblxuZXhwb3J0IGNvbnN0IGNhbkVkaXRMb2NhdGlvbkRhdGEgPSAoeyBzZXNzaW9uIH06IFNlc3Npb25PclVzZXJDb250ZXh0KSA9PlxuICBpc0dvZCh7IHNlc3Npb24gfSkgfHwgaXNPcmdBZG1pbih7IHNlc3Npb24gfSkgfHwgaXNMb2NhdGlvbkFkbWluKHsgc2Vzc2lvbiB9KTtcblxuZXhwb3J0IGNvbnN0IGZpbHRlckJ5VXNlckxvY2F0aW9uID0gYXN5bmMgKHsgc2Vzc2lvbiB9OiBTZXNzaW9uQ29udGV4dCkgPT4ge1xuICBpZiAoIXNlc3Npb24/LmxvY2F0aW9uSWQpIHJldHVybiBmYWxzZTtcbiAgcmV0dXJuIHsgbG9jYXRpb246IHsgaWQ6IHsgZXF1YWxzOiBzZXNzaW9uLmxvY2F0aW9uSWQgfSB9IH07XG59O1xuXG5leHBvcnQgY29uc3QgZmlsdGVyQnlVc2VyT3JnID0gYXN5bmMgKHsgc2Vzc2lvbiB9OiBTZXNzaW9uQ29udGV4dCkgPT4ge1xuICBpZiAoIXNlc3Npb24/Lm9yZ0lkKSByZXR1cm4gZmFsc2U7XG4gIHJldHVybiB7IG9yZzogeyBpZDogeyBlcXVhbHM6IHNlc3Npb24ub3JnSWQgfSB9IH07XG59O1xuXG5leHBvcnQgY29uc3QgZmlsdGVyVGltZVR5cGVzQnlVc2VyTG9jYXRpb24gPSBhc3luYyAoeyBzZXNzaW9uIH06IFNlc3Npb25Db250ZXh0KSA9PiB7XG4gIGlmICghc2Vzc2lvbj8ub3JnSWQgfHwgIXNlc3Npb24/LmxvY2F0aW9uSWQpIHJldHVybiBmYWxzZTtcbiAgcmV0dXJuIHtcbiAgICBvcmc6IHsgaWQ6IHsgZXF1YWxzOiBzZXNzaW9uLm9yZ0lkIH0gfSxcbiAgICB0aW1lUG9saWNpZXM6IHtcbiAgICAgIHNvbWU6IHtcbiAgICAgICAgbG9jYXRpb25zOiB7XG4gICAgICAgICAgc29tZToge1xuICAgICAgICAgICAgaWQ6IHsgZXF1YWxzOiBzZXNzaW9uLmxvY2F0aW9uSWQgfVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgfTtcbn07XG5cbmV4cG9ydCBjb25zdCBmaWx0ZXJQb2xpY2llc0J5VXNlckxvY2F0aW9uID0gYXN5bmMgKHsgc2Vzc2lvbiB9OiBTZXNzaW9uQ29udGV4dCkgPT4ge1xuICBpZiAoIXNlc3Npb24/Lm9yZ0lkIHx8ICFzZXNzaW9uPy5sb2NhdGlvbklkKSByZXR1cm4gZmFsc2U7XG4gIHJldHVybiB7XG4gICAgb3JnOiB7IGlkOiB7IGVxdWFsczogc2Vzc2lvbi5vcmdJZCB9IH0sXG4gICAgbG9jYXRpb25zOiB7XG4gICAgICBzb21lOiB7XG4gICAgICAgIGlkOiB7IGVxdWFsczogc2Vzc2lvbi5sb2NhdGlvbklkIH1cbiAgICAgIH1cbiAgICB9XG4gIH07XG59O1xuXG4vKipcbiAqIENoZWNrIGlmIGEgdXNlciBjYW4gZWRpdCBhbm90aGVyIHVzZXIgYmFzZWQgb24gcm9sZSBoaWVyYXJjaHlcbiAqIC0gTE9DQVRJT05fQURNSU4gY2FuIG9ubHkgZWRpdCBVU0VSIG9yIExPQ0FUSU9OX0FETUlOXG4gKiAtIE9SR19BRE1JTiBjYW4gb25seSBlZGl0IFVTRVIsIExPQ0FUSU9OX0FETUlOLCBPUkdfQURNSU5cbiAqIC0gT1JHX09XTkVSIGNhbiBvbmx5IGVkaXQgVVNFUiwgTE9DQVRJT05fQURNSU4sIE9SR19BRE1JTiwgT1JHX09XTkVSXG4gKiAtIEdPRCBjYW4gZWRpdCBhbnlvbmVcbiAqL1xuZXhwb3J0IGNvbnN0IGNhbkVkaXRVc2VyQnlSb2xlID0gKFxuICBlZGl0b3JSb2xlOiBVc2VyUm9sZSB8IG51bGwgfCB1bmRlZmluZWQsXG4gIHRhcmdldFJvbGU6IFVzZXJSb2xlIHwgbnVsbCB8IHVuZGVmaW5lZFxuKTogYm9vbGVhbiA9PiB7XG4gIGlmICghZWRpdG9yUm9sZSB8fCAhdGFyZ2V0Um9sZSkgcmV0dXJuIGZhbHNlO1xuXG4gIC8vIEdPRCBjYW4gZWRpdCBhbnlvbmVcbiAgaWYgKGVkaXRvclJvbGUgPT09IFVzZXJSb2xlLkdPRCkgcmV0dXJuIHRydWU7XG5cbiAgY29uc3QgZWRpdG9yTGV2ZWwgPSByb2xlSGllcmFyY2h5W2VkaXRvclJvbGVdID8/IC0xO1xuICBjb25zdCB0YXJnZXRMZXZlbCA9IHJvbGVIaWVyYXJjaHlbdGFyZ2V0Um9sZV0gPz8gTnVtYmVyLk1BWF9TQUZFX0lOVEVHRVI7XG5cbiAgLy8gRWRpdG9yIGNhbiBvbmx5IGVkaXQgdXNlcnMgd2l0aCBlcXVhbCBvciBsb3dlciByb2xlIGxldmVsXG4gIHJldHVybiB0YXJnZXRMZXZlbCA8PSBlZGl0b3JMZXZlbDtcbn07XG4iXSwibmFtZXMiOlsiVXNlclJvbGUiLCJyb2xlSGllcmFyY2h5IiwiaXNBdXRoZW50aWNhdGVkIiwic2Vzc2lvbiIsImVtYWlsIiwiaGFzUm9sZSIsInJvbGVzIiwicm9sZSIsImluY2x1ZGVzIiwiaXNHb2QiLCJpc09yZ0FkbWluIiwiaXNMb2NhdGlvbkFkbWluIiwiaXNPcmdBZG1pbk9yQWJvdmUiLCJpc0FueUFkbWluIiwiaXNPcmdTY29wZWQiLCJvcmdJZCIsIm9yZyIsImlkIiwiZXF1YWxzIiwiaXNTZWxmIiwiY2FuRWRpdE9yZ0RhdGEiLCJjYW5FZGl0TG9jYXRpb25EYXRhIiwiZmlsdGVyQnlVc2VyTG9jYXRpb24iLCJsb2NhdGlvbklkIiwibG9jYXRpb24iLCJmaWx0ZXJCeVVzZXJPcmciLCJmaWx0ZXJUaW1lVHlwZXNCeVVzZXJMb2NhdGlvbiIsInRpbWVQb2xpY2llcyIsInNvbWUiLCJsb2NhdGlvbnMiLCJmaWx0ZXJQb2xpY2llc0J5VXNlckxvY2F0aW9uIiwiY2FuRWRpdFVzZXJCeVJvbGUiLCJlZGl0b3JSb2xlIiwidGFyZ2V0Um9sZSIsImVkaXRvckxldmVsIiwidGFyZ2V0TGV2ZWwiLCJOdW1iZXIiLCJNQVhfU0FGRV9JTlRFR0VSIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(api)/../../domains/auth/userRole.ts\n");

/***/ }),

/***/ "(api)/../../lib/auth/extractUserData.ts":
/*!*****************************************!*\
  !*** ../../lib/auth/extractUserData.ts ***!
  \*****************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var lodash_pick__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! lodash/pick */ \"lodash/pick\");\n/* harmony import */ var lodash_pick__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(lodash_pick__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _domains_auth_google__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../domains/auth/google */ \"(api)/../../domains/auth/google.ts\");\n\n\nconst extractUserData = (provider, { user, profile })=>{\n    const handler = {\n        google: ()=>(0,_domains_auth_google__WEBPACK_IMPORTED_MODULE_1__.getInformationFromProfile)({\n                profile: profile\n            }),\n        credentials: ()=>lodash_pick__WEBPACK_IMPORTED_MODULE_0___default()(user, [\n                \"email\",\n                \"firstName\",\n                \"lastName\"\n            ])\n    }[provider];\n    if (!handler) throw new Error(`Unknown provider: ${provider}`);\n    const userData = handler();\n    return {\n        ...userData\n    };\n};\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (extractUserData);\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi4vLi4vbGliL2F1dGgvZXh0cmFjdFVzZXJEYXRhLnRzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7QUFBOEI7QUFLd0M7QUFFdEUsTUFBTUUsa0JBQWtCLENBQUNDLFVBQTBCLEVBQUVDLElBQUksRUFBRUMsT0FBTyxFQUE2QztJQUM3RyxNQUFNQyxVQUFVO1FBQ2RDLFFBQVEsSUFBTU4sK0VBQXlCQSxDQUFDO2dCQUFFSSxTQUFTQTtZQUF5QjtRQUM1RUcsYUFBYSxJQUFNUixrREFBSUEsQ0FBQ0ksTUFBTTtnQkFBQztnQkFBUztnQkFBYTthQUFXO0lBQ2xFLENBQUMsQ0FBQ0QsU0FBUztJQUVYLElBQUksQ0FBQ0csU0FBUyxNQUFNLElBQUlHLE1BQU0sQ0FBQyxrQkFBa0IsRUFBRU4sU0FBUyxDQUFDO0lBRTdELE1BQU1PLFdBQVdKO0lBQ2pCLE9BQU87UUFBRSxHQUFHSSxRQUFRO0lBQUM7QUFDdkI7QUFFQSxpRUFBZVIsZUFBZUEsRUFBQyIsInNvdXJjZXMiOlsid2VicGFjazovLy8uLi8uLi9saWIvYXV0aC9leHRyYWN0VXNlckRhdGEudHM/N2UyMSJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBwaWNrIH0gZnJvbSAnbG9kYXNoJztcbmltcG9ydCB7IERlZmF1bHRVc2VyLCBQcm9maWxlIH0gZnJvbSAnbmV4dC1hdXRoJztcbmltcG9ydCB7IFByb3ZpZGVyIH0gZnJvbSAnbmV4dC1hdXRoL3Byb3ZpZGVycyc7XG5pbXBvcnQgeyBHb29nbGVQcm9maWxlIH0gZnJvbSAnbmV4dC1hdXRoL3Byb3ZpZGVycy9nb29nbGUnO1xuaW1wb3J0IHsgU2Vzc2lvbiB9IGZyb20gJy4uLy4uL2F1dGgnO1xuaW1wb3J0IHsgZ2V0SW5mb3JtYXRpb25Gcm9tUHJvZmlsZSB9IGZyb20gJy4uLy4uL2RvbWFpbnMvYXV0aC9nb29nbGUnO1xuXG5jb25zdCBleHRyYWN0VXNlckRhdGEgPSAocHJvdmlkZXI6IFByb3ZpZGVyWydpZCddLCB7IHVzZXIsIHByb2ZpbGUgfTogeyB1c2VyPzogRGVmYXVsdFVzZXI7IHByb2ZpbGU/OiBQcm9maWxlIH0pID0+IHtcbiAgY29uc3QgaGFuZGxlciA9IHtcbiAgICBnb29nbGU6ICgpID0+IGdldEluZm9ybWF0aW9uRnJvbVByb2ZpbGUoeyBwcm9maWxlOiBwcm9maWxlIGFzIEdvb2dsZVByb2ZpbGUgfSksXG4gICAgY3JlZGVudGlhbHM6ICgpID0+IHBpY2sodXNlciwgWydlbWFpbCcsICdmaXJzdE5hbWUnLCAnbGFzdE5hbWUnXSlcbiAgfVtwcm92aWRlcl07XG5cbiAgaWYgKCFoYW5kbGVyKSB0aHJvdyBuZXcgRXJyb3IoYFVua25vd24gcHJvdmlkZXI6ICR7cHJvdmlkZXJ9YCk7XG5cbiAgY29uc3QgdXNlckRhdGEgPSBoYW5kbGVyKCk7XG4gIHJldHVybiB7IC4uLnVzZXJEYXRhIH0gYXMgU2Vzc2lvbjtcbn07XG5cbmV4cG9ydCBkZWZhdWx0IGV4dHJhY3RVc2VyRGF0YTtcbiJdLCJuYW1lcyI6WyJwaWNrIiwiZ2V0SW5mb3JtYXRpb25Gcm9tUHJvZmlsZSIsImV4dHJhY3RVc2VyRGF0YSIsInByb3ZpZGVyIiwidXNlciIsInByb2ZpbGUiLCJoYW5kbGVyIiwiZ29vZ2xlIiwiY3JlZGVudGlhbHMiLCJFcnJvciIsInVzZXJEYXRhIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(api)/../../lib/auth/extractUserData.ts\n");

/***/ }),

/***/ "(api)/../../lib/auth/providers.ts":
/*!***********************************!*\
  !*** ../../lib/auth/providers.ts ***!
  \***********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var _config_env__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../config/env */ \"(api)/../../config/env.ts\");\n/* harmony import */ var next_auth_providers_google__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next-auth/providers/google */ \"next-auth/providers/google\");\n/* harmony import */ var next_auth_providers_google__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(next_auth_providers_google__WEBPACK_IMPORTED_MODULE_1__);\n\n\nconst providers = [\n    next_auth_providers_google__WEBPACK_IMPORTED_MODULE_1___default()({\n        clientId: _config_env__WEBPACK_IMPORTED_MODULE_0__[\"default\"].GOOGLE_CLIENT_ID,\n        clientSecret: _config_env__WEBPACK_IMPORTED_MODULE_0__[\"default\"].GOOGLE_CLIENT_SECRET\n    })\n];\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (providers);\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi4vLi4vbGliL2F1dGgvcHJvdmlkZXJzLnRzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7QUFBbUM7QUFDYTtBQUVoRCxNQUFNRSxZQUFZO0lBQ2hCRCxpRUFBTUEsQ0FBQztRQUNMRSxVQUFVSCxvRUFBb0I7UUFDOUJLLGNBQWNMLHdFQUF3QjtJQUN4QztDQUNEO0FBRUQsaUVBQWVFLFNBQVNBLEVBQUMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi4vLi4vbGliL2F1dGgvcHJvdmlkZXJzLnRzPzI4YzgiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IGVudiBmcm9tICcuLi8uLi9jb25maWcvZW52JztcbmltcG9ydCBHb29nbGUgZnJvbSAnbmV4dC1hdXRoL3Byb3ZpZGVycy9nb29nbGUnO1xuXG5jb25zdCBwcm92aWRlcnMgPSBbXG4gIEdvb2dsZSh7XG4gICAgY2xpZW50SWQ6IGVudi5HT09HTEVfQ0xJRU5UX0lELFxuICAgIGNsaWVudFNlY3JldDogZW52LkdPT0dMRV9DTElFTlRfU0VDUkVUXG4gIH0pXG5dO1xuXG5leHBvcnQgZGVmYXVsdCBwcm92aWRlcnM7XG4iXSwibmFtZXMiOlsiZW52IiwiR29vZ2xlIiwicHJvdmlkZXJzIiwiY2xpZW50SWQiLCJHT09HTEVfQ0xJRU5UX0lEIiwiY2xpZW50U2VjcmV0IiwiR09PR0xFX0NMSUVOVF9TRUNSRVQiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(api)/../../lib/auth/providers.ts\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../webpack-api-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next"], () => (__webpack_exec__("(api)/../../../../node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fauth%2F%5B...nextauth%5D&preferredRegion=&absolutePagePath=.%2Fpages%2Fapi%2Fauth%2F%5B...nextauth%5D.ts&middlewareConfigBase64=e30%3D!")));
module.exports = __webpack_exports__;

})();