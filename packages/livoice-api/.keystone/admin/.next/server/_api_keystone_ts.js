"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
exports.id = "_api_keystone_ts";
exports.ids = ["_api_keystone_ts"];
exports.modules = {

/***/ "(api)/../../keystone.ts":
/*!*************************!*\
  !*** ../../keystone.ts ***!
  \*************************/
/***/ ((module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.a(module, async (__webpack_handle_async_dependencies__, __webpack_async_result__) => { try {\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var _keystone_6_core__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @keystone-6/core */ \"@keystone-6/core\");\n/* harmony import */ var _keystone_6_core__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_keystone_6_core__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _schemas__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./schemas */ \"(api)/../../schemas/index.ts\");\n/* harmony import */ var _config_env__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./config/env */ \"(api)/../../config/env.ts\");\n/* harmony import */ var _auth__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./auth */ \"(api)/../../auth.ts\");\n/* harmony import */ var _lib_auth_providers__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./lib/auth/providers */ \"(api)/../../lib/auth/providers.ts\");\n/* harmony import */ var _lib_cors__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./lib/cors */ \"(api)/../../lib/cors.ts\");\n/* harmony import */ var _routes__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./routes */ \"(api)/../../routes/index.ts\");\nvar __webpack_async_dependencies__ = __webpack_handle_async_dependencies__([_schemas__WEBPACK_IMPORTED_MODULE_1__]);\n_schemas__WEBPACK_IMPORTED_MODULE_1__ = (__webpack_async_dependencies__.then ? (await __webpack_async_dependencies__)() : __webpack_async_dependencies__)[0];\n\n\n\n\n\n\n\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_keystone_6_core__WEBPACK_IMPORTED_MODULE_0__.config)({\n    db: {\n        provider: _config_env__WEBPACK_IMPORTED_MODULE_2__[\"default\"].DATABASE_PROVIDER,\n        url: _config_env__WEBPACK_IMPORTED_MODULE_2__[\"default\"].DATABASE_URL\n    },\n    lists: _schemas__WEBPACK_IMPORTED_MODULE_1__[\"default\"],\n    session: _auth__WEBPACK_IMPORTED_MODULE_3__.nextAuthSessionStrategy,\n    ui: {\n        publicPages: [\n            \"/api/auth/csrf\",\n            \"/api/auth/signin\",\n            \"/api/auth/callback\",\n            \"/api/auth/session\",\n            \"/api/auth/providers\",\n            \"/api/auth/signout\",\n            \"/api/auth/error\",\n            ..._lib_auth_providers__WEBPACK_IMPORTED_MODULE_4__[\"default\"].flatMap(({ id })=>[\n                    `/api/auth/signin/${id}`,\n                    `/api/auth/callback/${id}`\n                ])\n        ],\n        pageMiddleware: async ({ wasAccessAllowed })=>{\n            if (wasAccessAllowed) return;\n            return {\n                kind: \"redirect\",\n                to: \"/api/auth/signin\"\n            };\n        }\n    },\n    server: {\n        cors: _lib_cors__WEBPACK_IMPORTED_MODULE_5__[\"default\"],\n        extendExpressApp: _routes__WEBPACK_IMPORTED_MODULE_6__[\"default\"]\n    },\n    graphql: {\n        path: \"/api/graphql\",\n        debug: false,\n        // use the builder-style GraphQL extensions\n        extendGraphqlSchema: _schemas__WEBPACK_IMPORTED_MODULE_1__.extendGraphqlSchema\n    }\n}));\n\n__webpack_async_result__();\n} catch(e) { __webpack_async_result__(e); } });//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi4vLi4va2V5c3RvbmUudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7O0FBQTBDO0FBQ2E7QUFFeEI7QUFDa0I7QUFDSjtBQUNmO0FBQ1U7QUFFeEMsaUVBQWVBLHdEQUFNQSxDQUFDO0lBQ3BCUSxJQUFJO1FBQ0ZDLFVBQVVOLHFFQUFxQjtRQUMvQlEsS0FBS1IsZ0VBQWdCO0lBQ3ZCO0lBQ0FGLEtBQUtBLGtEQUFBQTtJQUNMWSxTQUFTVCwwREFBdUJBO0lBQ2hDVSxJQUFJO1FBQ0ZDLGFBQWE7WUFDWDtZQUNBO1lBQ0E7WUFDQTtZQUNBO1lBQ0E7WUFDQTtlQUNHVixtRUFBaUIsQ0FBQyxDQUFDLEVBQUVZLEVBQUUsRUFBRSxHQUFLO29CQUFDLENBQUMsaUJBQWlCLEVBQUVBLEdBQUcsQ0FBQztvQkFBRSxDQUFDLG1CQUFtQixFQUFFQSxHQUFHLENBQUM7aUJBQUM7U0FDeEY7UUFFREMsZ0JBQWdCLE9BQU8sRUFBRUMsZ0JBQWdCLEVBQUU7WUFDekMsSUFBSUEsa0JBQWtCO1lBQ3RCLE9BQU87Z0JBQ0xDLE1BQU07Z0JBQ05DLElBQUk7WUFDTjtRQUNGO0lBQ0Y7SUFDQUMsUUFBUTtRQUNOaEIsSUFBSUEsbURBQUFBO1FBQ0pDLGdCQUFnQkEsaURBQUFBO0lBQ2xCO0lBQ0FnQixTQUFTO1FBQ1BDLE1BQU07UUFDTkMsT0FBTztRQUNQLDJDQUEyQztRQUMzQ3ZCLG1CQUFtQkEsMkRBQUFBO0lBQ3JCO0FBQ0YsRUFBRSxFQUFDIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLy4uLy4uL2tleXN0b25lLnRzP2Q0ZGYiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgY29uZmlnIH0gZnJvbSAnQGtleXN0b25lLTYvY29yZSc7XG5pbXBvcnQgbGlzdHMsIHsgZXh0ZW5kR3JhcGhxbFNjaGVtYSB9IGZyb20gJy4vc2NoZW1hcyc7XG5pbXBvcnQgeyBEYXRhYmFzZVByb3ZpZGVyIH0gZnJvbSAnQGtleXN0b25lLTYvY29yZS90eXBlcyc7XG5pbXBvcnQgZW52IGZyb20gJy4vY29uZmlnL2Vudic7XG5pbXBvcnQgeyBuZXh0QXV0aFNlc3Npb25TdHJhdGVneSB9IGZyb20gJy4vYXV0aCc7XG5pbXBvcnQgcHJvdmlkZXJzIGZyb20gJy4vbGliL2F1dGgvcHJvdmlkZXJzJztcbmltcG9ydCBjb3JzIGZyb20gJy4vbGliL2NvcnMnO1xuaW1wb3J0IGV4dGVuZEV4cHJlc3NBcHAgZnJvbSAnLi9yb3V0ZXMnO1xuXG5leHBvcnQgZGVmYXVsdCBjb25maWcoe1xuICBkYjoge1xuICAgIHByb3ZpZGVyOiBlbnYuREFUQUJBU0VfUFJPVklERVIgYXMgRGF0YWJhc2VQcm92aWRlcixcbiAgICB1cmw6IGVudi5EQVRBQkFTRV9VUkxcbiAgfSxcbiAgbGlzdHMsXG4gIHNlc3Npb246IG5leHRBdXRoU2Vzc2lvblN0cmF0ZWd5LFxuICB1aToge1xuICAgIHB1YmxpY1BhZ2VzOiBbXG4gICAgICAnL2FwaS9hdXRoL2NzcmYnLFxuICAgICAgJy9hcGkvYXV0aC9zaWduaW4nLFxuICAgICAgJy9hcGkvYXV0aC9jYWxsYmFjaycsXG4gICAgICAnL2FwaS9hdXRoL3Nlc3Npb24nLFxuICAgICAgJy9hcGkvYXV0aC9wcm92aWRlcnMnLFxuICAgICAgJy9hcGkvYXV0aC9zaWdub3V0JyxcbiAgICAgICcvYXBpL2F1dGgvZXJyb3InLFxuICAgICAgLi4ucHJvdmlkZXJzLmZsYXRNYXAoKHsgaWQgfSkgPT4gW2AvYXBpL2F1dGgvc2lnbmluLyR7aWR9YCwgYC9hcGkvYXV0aC9jYWxsYmFjay8ke2lkfWBdKVxuICAgIF0sXG5cbiAgICBwYWdlTWlkZGxld2FyZTogYXN5bmMgKHsgd2FzQWNjZXNzQWxsb3dlZCB9KSA9PiB7XG4gICAgICBpZiAod2FzQWNjZXNzQWxsb3dlZCkgcmV0dXJuO1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAga2luZDogJ3JlZGlyZWN0JyxcbiAgICAgICAgdG86ICcvYXBpL2F1dGgvc2lnbmluJ1xuICAgICAgfTtcbiAgICB9XG4gIH0sXG4gIHNlcnZlcjoge1xuICAgIGNvcnMsXG4gICAgZXh0ZW5kRXhwcmVzc0FwcFxuICB9LFxuICBncmFwaHFsOiB7XG4gICAgcGF0aDogJy9hcGkvZ3JhcGhxbCcsXG4gICAgZGVidWc6IGZhbHNlLFxuICAgIC8vIHVzZSB0aGUgYnVpbGRlci1zdHlsZSBHcmFwaFFMIGV4dGVuc2lvbnNcbiAgICBleHRlbmRHcmFwaHFsU2NoZW1hXG4gIH1cbn0pO1xuIl0sIm5hbWVzIjpbImNvbmZpZyIsImxpc3RzIiwiZXh0ZW5kR3JhcGhxbFNjaGVtYSIsImVudiIsIm5leHRBdXRoU2Vzc2lvblN0cmF0ZWd5IiwicHJvdmlkZXJzIiwiY29ycyIsImV4dGVuZEV4cHJlc3NBcHAiLCJkYiIsInByb3ZpZGVyIiwiREFUQUJBU0VfUFJPVklERVIiLCJ1cmwiLCJEQVRBQkFTRV9VUkwiLCJzZXNzaW9uIiwidWkiLCJwdWJsaWNQYWdlcyIsImZsYXRNYXAiLCJpZCIsInBhZ2VNaWRkbGV3YXJlIiwid2FzQWNjZXNzQWxsb3dlZCIsImtpbmQiLCJ0byIsInNlcnZlciIsImdyYXBocWwiLCJwYXRoIiwiZGVidWciXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(api)/../../keystone.ts\n");

/***/ }),

/***/ "(api)/../../lib/cors.ts":
/*!*************************!*\
  !*** ../../lib/cors.ts ***!
  \*************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var _config_env__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../config/env */ \"(api)/../../config/env.ts\");\n\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ({\n    credentials: true,\n    origin (origin, callback) {\n        const allowed = [\n            ..._config_env__WEBPACK_IMPORTED_MODULE_0__[\"default\"].ALLOWED_ORIGINS.split(\",\"),\n            _config_env__WEBPACK_IMPORTED_MODULE_0__[\"default\"].APP_URL,\n            _config_env__WEBPACK_IMPORTED_MODULE_0__[\"default\"].BASE_URL\n        ].filter(Boolean);\n        if (!origin || allowed.includes(origin)) {\n            callback(null, true);\n        } else {\n            callback(new Error(`Origin ${origin} not allowed by CORS`));\n        }\n    }\n});\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi4vLi4vbGliL2NvcnMudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7QUFDZ0M7QUFFaEMsaUVBQWU7SUFDYkMsYUFBYTtJQUNiQyxRQUFPQSxNQUFNLEVBQUVDLFFBQVE7UUFDckIsTUFBTUMsVUFBVTtlQUFJSixtRUFBbUIsQ0FBQ00sS0FBSyxDQUFDO1lBQU1OLDJEQUFXO1lBQUVBLDREQUFZO1NBQUMsQ0FBQ1MsTUFBTSxDQUNuRkM7UUFFRixJQUFJLENBQUNSLFVBQVVFLFFBQVFPLFFBQVEsQ0FBQ1QsU0FBUztZQUN2Q0MsU0FBUyxNQUFNO1FBQ2pCLE9BQU87WUFDTEEsU0FBUyxJQUFJUyxNQUFNLENBQUMsT0FBTyxFQUFFVixPQUFPLG9CQUFvQixDQUFDO1FBQzNEO0lBQ0Y7QUFDRixDQUFDLEVBQXVCIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLy4uLy4uL2xpYi9jb3JzLnRzP2U2NzciXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHR5cGUgeyBDb3JzT3B0aW9ucyB9IGZyb20gJ2NvcnMnO1xuaW1wb3J0IGVudiBmcm9tICcuLi9jb25maWcvZW52JztcblxuZXhwb3J0IGRlZmF1bHQge1xuICBjcmVkZW50aWFsczogdHJ1ZSxcbiAgb3JpZ2luKG9yaWdpbiwgY2FsbGJhY2spIHtcbiAgICBjb25zdCBhbGxvd2VkID0gWy4uLmVudi5BTExPV0VEX09SSUdJTlMuc3BsaXQoJywnKSwgZW52LkFQUF9VUkwsIGVudi5CQVNFX1VSTF0uZmlsdGVyKFxuICAgICAgQm9vbGVhblxuICAgICk7XG4gICAgaWYgKCFvcmlnaW4gfHwgYWxsb3dlZC5pbmNsdWRlcyhvcmlnaW4pKSB7XG4gICAgICBjYWxsYmFjayhudWxsLCB0cnVlKTtcbiAgICB9IGVsc2Uge1xuICAgICAgY2FsbGJhY2sobmV3IEVycm9yKGBPcmlnaW4gJHtvcmlnaW59IG5vdCBhbGxvd2VkIGJ5IENPUlNgKSk7XG4gICAgfVxuICB9XG59IHNhdGlzZmllcyBDb3JzT3B0aW9ucztcbiJdLCJuYW1lcyI6WyJlbnYiLCJjcmVkZW50aWFscyIsIm9yaWdpbiIsImNhbGxiYWNrIiwiYWxsb3dlZCIsIkFMTE9XRURfT1JJR0lOUyIsInNwbGl0IiwiQVBQX1VSTCIsIkJBU0VfVVJMIiwiZmlsdGVyIiwiQm9vbGVhbiIsImluY2x1ZGVzIiwiRXJyb3IiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(api)/../../lib/cors.ts\n");

/***/ }),

/***/ "(api)/../../lib/openai.ts":
/*!***************************!*\
  !*** ../../lib/openai.ts ***!
  \***************************/
/***/ ((module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.a(module, async (__webpack_handle_async_dependencies__, __webpack_async_result__) => { try {\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   createEmbeddings: () => (/* binding */ createEmbeddings),\n/* harmony export */   embeddingModel: () => (/* binding */ embeddingModel),\n/* harmony export */   getOpenAIClient: () => (/* binding */ getOpenAIClient),\n/* harmony export */   openAiModel: () => (/* binding */ openAiModel)\n/* harmony export */ });\n/* harmony import */ var openai__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! openai */ \"openai\");\n/* harmony import */ var _config_env__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../config/env */ \"(api)/../../config/env.ts\");\nvar __webpack_async_dependencies__ = __webpack_handle_async_dependencies__([openai__WEBPACK_IMPORTED_MODULE_0__]);\nopenai__WEBPACK_IMPORTED_MODULE_0__ = (__webpack_async_dependencies__.then ? (await __webpack_async_dependencies__)() : __webpack_async_dependencies__)[0];\n\n\nconst apiKey = _config_env__WEBPACK_IMPORTED_MODULE_1__[\"default\"].OPENAI_API_KEY.trim();\nlet client = null;\nconst ensureClient = ()=>{\n    if (!apiKey) {\n        throw new Error(\"OPENAI_API_KEY is not configured\");\n    }\n    if (!client) {\n        client = new openai__WEBPACK_IMPORTED_MODULE_0__[\"default\"]({\n            apiKey\n        });\n    }\n    return client;\n};\nconst getOpenAIClient = ()=>ensureClient();\nconst openAiModel = _config_env__WEBPACK_IMPORTED_MODULE_1__[\"default\"].OPENAI_MODEL || \"gpt-4o-mini\";\nconst embeddingModel = _config_env__WEBPACK_IMPORTED_MODULE_1__[\"default\"].OPENAI_EMBEDDING_MODEL || \"text-embedding-3-small\";\nconst createEmbeddings = async (input)=>{\n    if (!input.length) return [];\n    const openai = ensureClient();\n    const response = await openai.embeddings.create({\n        model: embeddingModel,\n        input\n    });\n    if (!response.data || !response.data.length) {\n        throw new Error(\"OpenAI returned no embeddings\");\n    }\n    return response.data.map((item)=>item.embedding ?? []);\n};\n\n__webpack_async_result__();\n} catch(e) { __webpack_async_result__(e); } });//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi4vLi4vbGliL29wZW5haS50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7QUFBNEI7QUFDSTtBQUVoQyxNQUFNRSxTQUFTRCxrRUFBa0IsQ0FBQ0csSUFBSTtBQUN0QyxJQUFJQyxTQUF3QjtBQUU1QixNQUFNQyxlQUFlO0lBQ25CLElBQUksQ0FBQ0osUUFBUTtRQUNYLE1BQU0sSUFBSUssTUFBTTtJQUNsQjtJQUVBLElBQUksQ0FBQ0YsUUFBUTtRQUNYQSxTQUFTLElBQUlMLDhDQUFNQSxDQUFDO1lBQUVFO1FBQU87SUFDL0I7SUFFQSxPQUFPRztBQUNUO0FBRU8sTUFBTUcsa0JBQWtCLElBQU1GLGVBQWU7QUFDN0MsTUFBTUcsY0FBY1IsZ0VBQWdCLElBQUksY0FBYztBQUN0RCxNQUFNVSxpQkFBaUJWLDBFQUEwQixJQUFJLHlCQUF5QjtBQUU5RSxNQUFNWSxtQkFBbUIsT0FBT0M7SUFDckMsSUFBSSxDQUFDQSxNQUFNQyxNQUFNLEVBQUUsT0FBTyxFQUFFO0lBRTVCLE1BQU1DLFNBQVNWO0lBQ2YsTUFBTVcsV0FBVyxNQUFNRCxPQUFPRSxVQUFVLENBQUNDLE1BQU0sQ0FBQztRQUM5Q0MsT0FBT1Q7UUFDUEc7SUFDRjtJQUVBLElBQUksQ0FBQ0csU0FBU0ksSUFBSSxJQUFJLENBQUNKLFNBQVNJLElBQUksQ0FBQ04sTUFBTSxFQUFFO1FBQzNDLE1BQU0sSUFBSVIsTUFBTTtJQUNsQjtJQUVBLE9BQU9VLFNBQVNJLElBQUksQ0FBQ0MsR0FBRyxDQUFDQyxDQUFBQSxPQUFRQSxLQUFLQyxTQUFTLElBQUksRUFBRTtBQUN2RCxFQUFFIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLy4uLy4uL2xpYi9vcGVuYWkudHM/NzEzMyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgT3BlbkFJIGZyb20gJ29wZW5haSc7XG5pbXBvcnQgZW52IGZyb20gJy4uL2NvbmZpZy9lbnYnO1xuXG5jb25zdCBhcGlLZXkgPSBlbnYuT1BFTkFJX0FQSV9LRVkudHJpbSgpO1xubGV0IGNsaWVudDogT3BlbkFJIHwgbnVsbCA9IG51bGw7XG5cbmNvbnN0IGVuc3VyZUNsaWVudCA9ICgpID0+IHtcbiAgaWYgKCFhcGlLZXkpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ09QRU5BSV9BUElfS0VZIGlzIG5vdCBjb25maWd1cmVkJyk7XG4gIH1cblxuICBpZiAoIWNsaWVudCkge1xuICAgIGNsaWVudCA9IG5ldyBPcGVuQUkoeyBhcGlLZXkgfSk7XG4gIH1cblxuICByZXR1cm4gY2xpZW50O1xufTtcblxuZXhwb3J0IGNvbnN0IGdldE9wZW5BSUNsaWVudCA9ICgpID0+IGVuc3VyZUNsaWVudCgpO1xuZXhwb3J0IGNvbnN0IG9wZW5BaU1vZGVsID0gZW52Lk9QRU5BSV9NT0RFTCB8fCAnZ3B0LTRvLW1pbmknO1xuZXhwb3J0IGNvbnN0IGVtYmVkZGluZ01vZGVsID0gZW52Lk9QRU5BSV9FTUJFRERJTkdfTU9ERUwgfHwgJ3RleHQtZW1iZWRkaW5nLTMtc21hbGwnO1xuXG5leHBvcnQgY29uc3QgY3JlYXRlRW1iZWRkaW5ncyA9IGFzeW5jIChpbnB1dDogc3RyaW5nW10pOiBQcm9taXNlPG51bWJlcltdW10+ID0+IHtcbiAgaWYgKCFpbnB1dC5sZW5ndGgpIHJldHVybiBbXTtcblxuICBjb25zdCBvcGVuYWkgPSBlbnN1cmVDbGllbnQoKTtcbiAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBvcGVuYWkuZW1iZWRkaW5ncy5jcmVhdGUoe1xuICAgIG1vZGVsOiBlbWJlZGRpbmdNb2RlbCxcbiAgICBpbnB1dFxuICB9KTtcblxuICBpZiAoIXJlc3BvbnNlLmRhdGEgfHwgIXJlc3BvbnNlLmRhdGEubGVuZ3RoKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKCdPcGVuQUkgcmV0dXJuZWQgbm8gZW1iZWRkaW5ncycpO1xuICB9XG5cbiAgcmV0dXJuIHJlc3BvbnNlLmRhdGEubWFwKGl0ZW0gPT4gaXRlbS5lbWJlZGRpbmcgPz8gW10pO1xufTtcbiJdLCJuYW1lcyI6WyJPcGVuQUkiLCJlbnYiLCJhcGlLZXkiLCJPUEVOQUlfQVBJX0tFWSIsInRyaW0iLCJjbGllbnQiLCJlbnN1cmVDbGllbnQiLCJFcnJvciIsImdldE9wZW5BSUNsaWVudCIsIm9wZW5BaU1vZGVsIiwiT1BFTkFJX01PREVMIiwiZW1iZWRkaW5nTW9kZWwiLCJPUEVOQUlfRU1CRURESU5HX01PREVMIiwiY3JlYXRlRW1iZWRkaW5ncyIsImlucHV0IiwibGVuZ3RoIiwib3BlbmFpIiwicmVzcG9uc2UiLCJlbWJlZGRpbmdzIiwiY3JlYXRlIiwibW9kZWwiLCJkYXRhIiwibWFwIiwiaXRlbSIsImVtYmVkZGluZyJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(api)/../../lib/openai.ts\n");

/***/ }),

/***/ "(api)/../../lib/pgvector.ts":
/*!*****************************!*\
  !*** ../../lib/pgvector.ts ***!
  \*****************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   formatVectorLiteral: () => (/* binding */ formatVectorLiteral)\n/* harmony export */ });\nconst formatVectorLiteral = (values)=>{\n    if (!values?.length) return;\n    return `vector'[${values.map((value)=>Number.isFinite(value) ? value.toString() : \"0\").join(\",\")}]'`;\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi4vLi4vbGliL3BndmVjdG9yLnRzIiwibWFwcGluZ3MiOiI7Ozs7QUFBTyxNQUFNQSxzQkFBc0IsQ0FBQ0M7SUFDbEMsSUFBSSxDQUFDQSxRQUFRQyxRQUFRO0lBRXJCLE9BQU8sQ0FBQyxRQUFRLEVBQUVELE9BQU9FLEdBQUcsQ0FBQ0MsQ0FBQUEsUUFBVUMsT0FBT0MsUUFBUSxDQUFDRixTQUFTQSxNQUFNRyxRQUFRLEtBQUssS0FBTUMsSUFBSSxDQUFDLEtBQUssRUFBRSxDQUFDO0FBQ3hHLEVBQUUiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi4vLi4vbGliL3BndmVjdG9yLnRzP2VkZjUiXSwic291cmNlc0NvbnRlbnQiOlsiZXhwb3J0IGNvbnN0IGZvcm1hdFZlY3RvckxpdGVyYWwgPSAodmFsdWVzOiBudW1iZXJbXSB8IHVuZGVmaW5lZCkgPT4ge1xuICBpZiAoIXZhbHVlcz8ubGVuZ3RoKSByZXR1cm47XG5cbiAgcmV0dXJuIGB2ZWN0b3InWyR7dmFsdWVzLm1hcCh2YWx1ZSA9PiAoTnVtYmVyLmlzRmluaXRlKHZhbHVlKSA/IHZhbHVlLnRvU3RyaW5nKCkgOiAnMCcpKS5qb2luKCcsJyl9XSdgO1xufTtcbiJdLCJuYW1lcyI6WyJmb3JtYXRWZWN0b3JMaXRlcmFsIiwidmFsdWVzIiwibGVuZ3RoIiwibWFwIiwidmFsdWUiLCJOdW1iZXIiLCJpc0Zpbml0ZSIsInRvU3RyaW5nIiwiam9pbiJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(api)/../../lib/pgvector.ts\n");

/***/ }),

/***/ "(api)/../../routes/example/index.ts":
/*!*************************************!*\
  !*** ../../routes/example/index.ts ***!
  \*************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var express__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! express */ \"express\");\n/* harmony import */ var express__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(express__WEBPACK_IMPORTED_MODULE_0__);\n\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((context)=>{\n    const router = express__WEBPACK_IMPORTED_MODULE_0___default().Router({\n        mergeParams: true,\n        caseSensitive: false\n    });\n    router.get(\"/\", async (req, res)=>{\n        return res.redirect(301, \"https://google.com\");\n    });\n    return router;\n});\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi4vLi4vcm91dGVzL2V4YW1wbGUvaW5kZXgudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQzhCO0FBRTlCLGlFQUFlLENBQUNDO0lBQ2QsTUFBTUMsU0FBU0YscURBQWMsQ0FBQztRQUFFSSxhQUFhO1FBQU1DLGVBQWU7SUFBTTtJQUV4RUgsT0FBT0ksR0FBRyxDQUFDLEtBQUssT0FBT0MsS0FBS0M7UUFFMUIsT0FBT0EsSUFBSUMsUUFBUSxDQUFDLEtBQUs7SUFDM0I7SUFFQSxPQUFPUDtBQUNULEdBQUUiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi4vLi4vcm91dGVzL2V4YW1wbGUvaW5kZXgudHM/MWNkOSJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgdHlwZSB7IENvbnRleHQgfSBmcm9tICcua2V5c3RvbmUvdHlwZXMnO1xuaW1wb3J0IGV4cHJlc3MgZnJvbSAnZXhwcmVzcyc7XG5cbmV4cG9ydCBkZWZhdWx0IChjb250ZXh0OiBDb250ZXh0KSA9PiB7XG4gIGNvbnN0IHJvdXRlciA9IGV4cHJlc3MuUm91dGVyKHsgbWVyZ2VQYXJhbXM6IHRydWUsIGNhc2VTZW5zaXRpdmU6IGZhbHNlIH0pO1xuXG4gIHJvdXRlci5nZXQoJy8nLCBhc3luYyAocmVxLCByZXMpID0+IHtcblxuICAgIHJldHVybiByZXMucmVkaXJlY3QoMzAxLCBcImh0dHBzOi8vZ29vZ2xlLmNvbVwiKTtcbiAgfSk7XG5cbiAgcmV0dXJuIHJvdXRlcjtcbn07XG4iXSwibmFtZXMiOlsiZXhwcmVzcyIsImNvbnRleHQiLCJyb3V0ZXIiLCJSb3V0ZXIiLCJtZXJnZVBhcmFtcyIsImNhc2VTZW5zaXRpdmUiLCJnZXQiLCJyZXEiLCJyZXMiLCJyZWRpcmVjdCJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(api)/../../routes/example/index.ts\n");

/***/ }),

/***/ "(api)/../../routes/index.ts":
/*!*****************************!*\
  !*** ../../routes/index.ts ***!
  \*****************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var express__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! express */ \"express\");\n/* harmony import */ var express__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(express__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var path__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! path */ \"path\");\n/* harmony import */ var path__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(path__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var _example__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./example */ \"(api)/../../routes/example/index.ts\");\n\n\n// import ratehawk from './ratehawk';\n\nconst publicDir = path__WEBPACK_IMPORTED_MODULE_1___default().resolve(__dirname, \"..\", \"public\");\nconst extendExpressApp = async (app, context)=>{\n    app.use(\"/public\", express__WEBPACK_IMPORTED_MODULE_0___default()[\"static\"](publicDir));\n    app.use(\"/example\", (0,_example__WEBPACK_IMPORTED_MODULE_2__[\"default\"])(context));\n};\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (extendExpressApp);\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi4vLi4vcm91dGVzL2luZGV4LnRzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7OztBQUU4QjtBQUNOO0FBQ3hCLHFDQUFxQztBQUNMO0FBRWhDLE1BQU1HLFlBQVlGLG1EQUFZLENBQUNJLFdBQVcsTUFBTTtBQUVoRCxNQUFNQyxtQkFBbUIsT0FBT0MsS0FBa0JDO0lBRWhERCxJQUFJRSxHQUFHLENBQUMsV0FBV1Qsd0RBQWMsQ0FBQ0c7SUFHbENJLElBQUlFLEdBQUcsQ0FBQyxZQUFZUCxvREFBT0EsQ0FBQ007QUFDOUI7QUFFQSxpRUFBZUYsZ0JBQWdCQSxFQUFDIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLy4uLy4uL3JvdXRlcy9pbmRleC50cz83NGNiIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB0eXBlIHsgQXBwbGljYXRpb24gfSBmcm9tICdleHByZXNzJztcbmltcG9ydCB0eXBlIHsgQ29udGV4dCB9IGZyb20gJy5rZXlzdG9uZS90eXBlcyc7XG5pbXBvcnQgZXhwcmVzcyBmcm9tICdleHByZXNzJztcbmltcG9ydCBwYXRoIGZyb20gJ3BhdGgnO1xuLy8gaW1wb3J0IHJhdGVoYXdrIGZyb20gJy4vcmF0ZWhhd2snO1xuaW1wb3J0IGV4YW1wbGUgZnJvbSAnLi9leGFtcGxlJztcblxuY29uc3QgcHVibGljRGlyID0gcGF0aC5yZXNvbHZlKF9fZGlybmFtZSwgJy4uJywgJ3B1YmxpYycpO1xuXG5jb25zdCBleHRlbmRFeHByZXNzQXBwID0gYXN5bmMgKGFwcDogQXBwbGljYXRpb24sIGNvbnRleHQ6IENvbnRleHQpID0+IHtcblxuICBhcHAudXNlKCcvcHVibGljJywgZXhwcmVzcy5zdGF0aWMocHVibGljRGlyKSk7XG5cblxuICBhcHAudXNlKCcvZXhhbXBsZScsIGV4YW1wbGUoY29udGV4dCkpO1xufTtcblxuZXhwb3J0IGRlZmF1bHQgZXh0ZW5kRXhwcmVzc0FwcDtcbiJdLCJuYW1lcyI6WyJleHByZXNzIiwicGF0aCIsImV4YW1wbGUiLCJwdWJsaWNEaXIiLCJyZXNvbHZlIiwiX19kaXJuYW1lIiwiZXh0ZW5kRXhwcmVzc0FwcCIsImFwcCIsImNvbnRleHQiLCJ1c2UiLCJzdGF0aWMiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(api)/../../routes/index.ts\n");

/***/ }),

/***/ "(api)/../../schemas/Chat.ts":
/*!*****************************!*\
  !*** ../../schemas/Chat.ts ***!
  \*****************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var _keystone_6_core__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @keystone-6/core */ \"@keystone-6/core\");\n/* harmony import */ var _keystone_6_core__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_keystone_6_core__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _keystone_6_core_fields__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @keystone-6/core/fields */ \"@keystone-6/core/fields\");\n/* harmony import */ var _keystone_6_core_fields__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(_keystone_6_core_fields__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var _domains_auth_userRole__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../domains/auth/userRole */ \"(api)/../../domains/auth/userRole.ts\");\n\n\n\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_keystone_6_core__WEBPACK_IMPORTED_MODULE_0__.list)({\n    fields: {\n        title: (0,_keystone_6_core_fields__WEBPACK_IMPORTED_MODULE_1__.text)({\n            validation: {\n                isRequired: true\n            },\n            defaultValue: \"AI chat\"\n        }),\n        contextType: (0,_keystone_6_core_fields__WEBPACK_IMPORTED_MODULE_1__.select)({\n            options: [\n                {\n                    label: \"Transcript\",\n                    value: \"TRANSCRIPT\"\n                },\n                {\n                    label: \"Project\",\n                    value: \"PROJECT\"\n                }\n            ],\n            validation: {\n                isRequired: true\n            }\n        }),\n        org: (0,_keystone_6_core_fields__WEBPACK_IMPORTED_MODULE_1__.relationship)({\n            ref: \"Organization.chats\",\n            many: false\n        }),\n        project: (0,_keystone_6_core_fields__WEBPACK_IMPORTED_MODULE_1__.relationship)({\n            ref: \"Project.chats\",\n            many: false\n        }),\n        transcript: (0,_keystone_6_core_fields__WEBPACK_IMPORTED_MODULE_1__.relationship)({\n            ref: \"Transcript.chats\",\n            many: false\n        }),\n        messages: (0,_keystone_6_core_fields__WEBPACK_IMPORTED_MODULE_1__.relationship)({\n            ref: \"ChatMessage.chat\",\n            many: true\n        }),\n        createdAt: (0,_keystone_6_core_fields__WEBPACK_IMPORTED_MODULE_1__.timestamp)({\n            defaultValue: {\n                kind: \"now\"\n            },\n            ui: {\n                createView: {\n                    fieldMode: \"hidden\"\n                }\n            }\n        }),\n        updatedAt: (0,_keystone_6_core_fields__WEBPACK_IMPORTED_MODULE_1__.timestamp)({\n            db: {\n                updatedAt: true\n            },\n            ui: {\n                createView: {\n                    fieldMode: \"hidden\"\n                }\n            }\n        })\n    },\n    access: {\n        operation: {\n            query: _domains_auth_userRole__WEBPACK_IMPORTED_MODULE_2__.isAuthenticated,\n            create: _domains_auth_userRole__WEBPACK_IMPORTED_MODULE_2__.isAuthenticated,\n            update: _domains_auth_userRole__WEBPACK_IMPORTED_MODULE_2__.isOrgAdmin,\n            delete: _domains_auth_userRole__WEBPACK_IMPORTED_MODULE_2__.isOrgAdmin\n        },\n        filter: {\n            query: async ({ session })=>{\n                if (!(0,_domains_auth_userRole__WEBPACK_IMPORTED_MODULE_2__.isAuthenticated)({\n                    session\n                })) return false;\n                if ((0,_domains_auth_userRole__WEBPACK_IMPORTED_MODULE_2__.isGod)({\n                    session\n                })) return true;\n                return (0,_domains_auth_userRole__WEBPACK_IMPORTED_MODULE_2__.filterByUserOrg)({\n                    session\n                });\n            }\n        }\n    }\n}));\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi4vLi4vc2NoZW1hcy9DaGF0LnRzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7OztBQUN3QztBQUN3QztBQUNlO0FBRS9GLGlFQUFlQSxzREFBSUEsQ0FBQztJQUNsQlMsUUFBUTtRQUNOQyxPQUFPUCw2REFBSUEsQ0FBQztZQUFFUSxZQUFZO2dCQUFFQyxZQUFZO1lBQUs7WUFBR0MsY0FBYztRQUFVO1FBQ3hFQyxhQUFhWiwrREFBTUEsQ0FBQztZQUNsQmEsU0FBUztnQkFDUDtvQkFBRUMsT0FBTztvQkFBY0MsT0FBTztnQkFBYTtnQkFDM0M7b0JBQUVELE9BQU87b0JBQVdDLE9BQU87Z0JBQVU7YUFDdEM7WUFDRE4sWUFBWTtnQkFBRUMsWUFBWTtZQUFLO1FBQ2pDO1FBQ0FNLEtBQUtqQixxRUFBWUEsQ0FBQztZQUFFa0IsS0FBSztZQUFzQkMsTUFBTTtRQUFNO1FBQzNEQyxTQUFTcEIscUVBQVlBLENBQUM7WUFBRWtCLEtBQUs7WUFBaUJDLE1BQU07UUFBTTtRQUMxREUsWUFBWXJCLHFFQUFZQSxDQUFDO1lBQUVrQixLQUFLO1lBQW9CQyxNQUFNO1FBQU07UUFDaEVHLFVBQVV0QixxRUFBWUEsQ0FBQztZQUFFa0IsS0FBSztZQUFvQkMsTUFBTTtRQUFLO1FBQzdESSxXQUFXcEIsa0VBQVNBLENBQUM7WUFBRVMsY0FBYztnQkFBRVksTUFBTTtZQUFNO1lBQUdDLElBQUk7Z0JBQUVDLFlBQVk7b0JBQUVDLFdBQVc7Z0JBQVM7WUFBRTtRQUFFO1FBQ2xHQyxXQUFXekIsa0VBQVNBLENBQUM7WUFBRTBCLElBQUk7Z0JBQUVELFdBQVc7WUFBSztZQUFHSCxJQUFJO2dCQUFFQyxZQUFZO29CQUFFQyxXQUFXO2dCQUFTO1lBQUU7UUFBRTtJQUM5RjtJQUNBRyxRQUFRO1FBQ05DLFdBQVc7WUFDVEMsT0FBTzNCLG1FQUFlQTtZQUN0QjRCLFFBQVE1QixtRUFBZUE7WUFDdkI2QixRQUFRM0IsOERBQVVBO1lBQ2xCNEIsUUFBUTVCLDhEQUFVQTtRQUNwQjtRQUNBNkIsUUFBUTtZQUNOSixPQUFPLE9BQU8sRUFBRUssT0FBTyxFQUFFO2dCQUN2QixJQUFJLENBQUNoQyx1RUFBZUEsQ0FBQztvQkFBRWdDO2dCQUFRLElBQUksT0FBTztnQkFDMUMsSUFBSS9CLDZEQUFLQSxDQUFDO29CQUFFK0I7Z0JBQVEsSUFBSSxPQUFPO2dCQUMvQixPQUFPakMsdUVBQWVBLENBQUM7b0JBQUVpQztnQkFBUTtZQUNuQztRQUNGO0lBQ0Y7QUFDRixFQUFFLEVBQXlCIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLy4uLy4uL3NjaGVtYXMvQ2hhdC50cz84YjYxIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IHR5cGUgTGlzdHMgfSBmcm9tICcua2V5c3RvbmUvdHlwZXMnO1xuaW1wb3J0IHsgbGlzdCB9IGZyb20gJ0BrZXlzdG9uZS02L2NvcmUnO1xuaW1wb3J0IHsgcmVsYXRpb25zaGlwLCBzZWxlY3QsIHRleHQsIHRpbWVzdGFtcCB9IGZyb20gJ0BrZXlzdG9uZS02L2NvcmUvZmllbGRzJztcbmltcG9ydCB7IGZpbHRlckJ5VXNlck9yZywgaXNBdXRoZW50aWNhdGVkLCBpc0dvZCwgaXNPcmdBZG1pbiB9IGZyb20gJy4uL2RvbWFpbnMvYXV0aC91c2VyUm9sZSc7XG5cbmV4cG9ydCBkZWZhdWx0IGxpc3Qoe1xuICBmaWVsZHM6IHtcbiAgICB0aXRsZTogdGV4dCh7IHZhbGlkYXRpb246IHsgaXNSZXF1aXJlZDogdHJ1ZSB9LCBkZWZhdWx0VmFsdWU6ICdBSSBjaGF0JyB9KSxcbiAgICBjb250ZXh0VHlwZTogc2VsZWN0KHtcbiAgICAgIG9wdGlvbnM6IFtcbiAgICAgICAgeyBsYWJlbDogJ1RyYW5zY3JpcHQnLCB2YWx1ZTogJ1RSQU5TQ1JJUFQnIH0sXG4gICAgICAgIHsgbGFiZWw6ICdQcm9qZWN0JywgdmFsdWU6ICdQUk9KRUNUJyB9XG4gICAgICBdLFxuICAgICAgdmFsaWRhdGlvbjogeyBpc1JlcXVpcmVkOiB0cnVlIH1cbiAgICB9KSxcbiAgICBvcmc6IHJlbGF0aW9uc2hpcCh7IHJlZjogJ09yZ2FuaXphdGlvbi5jaGF0cycsIG1hbnk6IGZhbHNlIH0pLFxuICAgIHByb2plY3Q6IHJlbGF0aW9uc2hpcCh7IHJlZjogJ1Byb2plY3QuY2hhdHMnLCBtYW55OiBmYWxzZSB9KSxcbiAgICB0cmFuc2NyaXB0OiByZWxhdGlvbnNoaXAoeyByZWY6ICdUcmFuc2NyaXB0LmNoYXRzJywgbWFueTogZmFsc2UgfSksXG4gICAgbWVzc2FnZXM6IHJlbGF0aW9uc2hpcCh7IHJlZjogJ0NoYXRNZXNzYWdlLmNoYXQnLCBtYW55OiB0cnVlIH0pLFxuICAgIGNyZWF0ZWRBdDogdGltZXN0YW1wKHsgZGVmYXVsdFZhbHVlOiB7IGtpbmQ6ICdub3cnIH0sIHVpOiB7IGNyZWF0ZVZpZXc6IHsgZmllbGRNb2RlOiAnaGlkZGVuJyB9IH0gfSksXG4gICAgdXBkYXRlZEF0OiB0aW1lc3RhbXAoeyBkYjogeyB1cGRhdGVkQXQ6IHRydWUgfSwgdWk6IHsgY3JlYXRlVmlldzogeyBmaWVsZE1vZGU6ICdoaWRkZW4nIH0gfSB9KVxuICB9LFxuICBhY2Nlc3M6IHtcbiAgICBvcGVyYXRpb246IHtcbiAgICAgIHF1ZXJ5OiBpc0F1dGhlbnRpY2F0ZWQsXG4gICAgICBjcmVhdGU6IGlzQXV0aGVudGljYXRlZCxcbiAgICAgIHVwZGF0ZTogaXNPcmdBZG1pbixcbiAgICAgIGRlbGV0ZTogaXNPcmdBZG1pblxuICAgIH0sXG4gICAgZmlsdGVyOiB7XG4gICAgICBxdWVyeTogYXN5bmMgKHsgc2Vzc2lvbiB9KSA9PiB7XG4gICAgICAgIGlmICghaXNBdXRoZW50aWNhdGVkKHsgc2Vzc2lvbiB9KSkgcmV0dXJuIGZhbHNlO1xuICAgICAgICBpZiAoaXNHb2QoeyBzZXNzaW9uIH0pKSByZXR1cm4gdHJ1ZTtcbiAgICAgICAgcmV0dXJuIGZpbHRlckJ5VXNlck9yZyh7IHNlc3Npb24gfSk7XG4gICAgICB9XG4gICAgfVxuICB9XG59KSBzYXRpc2ZpZXMgTGlzdHNbJ0NoYXQnXTtcblxuIl0sIm5hbWVzIjpbImxpc3QiLCJyZWxhdGlvbnNoaXAiLCJzZWxlY3QiLCJ0ZXh0IiwidGltZXN0YW1wIiwiZmlsdGVyQnlVc2VyT3JnIiwiaXNBdXRoZW50aWNhdGVkIiwiaXNHb2QiLCJpc09yZ0FkbWluIiwiZmllbGRzIiwidGl0bGUiLCJ2YWxpZGF0aW9uIiwiaXNSZXF1aXJlZCIsImRlZmF1bHRWYWx1ZSIsImNvbnRleHRUeXBlIiwib3B0aW9ucyIsImxhYmVsIiwidmFsdWUiLCJvcmciLCJyZWYiLCJtYW55IiwicHJvamVjdCIsInRyYW5zY3JpcHQiLCJtZXNzYWdlcyIsImNyZWF0ZWRBdCIsImtpbmQiLCJ1aSIsImNyZWF0ZVZpZXciLCJmaWVsZE1vZGUiLCJ1cGRhdGVkQXQiLCJkYiIsImFjY2VzcyIsIm9wZXJhdGlvbiIsInF1ZXJ5IiwiY3JlYXRlIiwidXBkYXRlIiwiZGVsZXRlIiwiZmlsdGVyIiwic2Vzc2lvbiJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(api)/../../schemas/Chat.ts\n");

/***/ }),

/***/ "(api)/../../schemas/ChatMessage.ts":
/*!************************************!*\
  !*** ../../schemas/ChatMessage.ts ***!
  \************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var _keystone_6_core__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @keystone-6/core */ \"@keystone-6/core\");\n/* harmony import */ var _keystone_6_core__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_keystone_6_core__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _keystone_6_core_fields__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @keystone-6/core/fields */ \"@keystone-6/core/fields\");\n/* harmony import */ var _keystone_6_core_fields__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(_keystone_6_core_fields__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var _domains_auth_userRole__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../domains/auth/userRole */ \"(api)/../../domains/auth/userRole.ts\");\n\n\n\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_keystone_6_core__WEBPACK_IMPORTED_MODULE_0__.list)({\n    fields: {\n        chat: (0,_keystone_6_core_fields__WEBPACK_IMPORTED_MODULE_1__.relationship)({\n            ref: \"Chat.messages\",\n            many: false\n        }),\n        role: (0,_keystone_6_core_fields__WEBPACK_IMPORTED_MODULE_1__.select)({\n            options: [\n                {\n                    label: \"User\",\n                    value: \"user\"\n                },\n                {\n                    label: \"Assistant\",\n                    value: \"assistant\"\n                }\n            ],\n            validation: {\n                isRequired: true\n            },\n            defaultValue: \"user\"\n        }),\n        content: (0,_keystone_6_core_fields__WEBPACK_IMPORTED_MODULE_1__.text)({\n            ui: {\n                displayMode: \"textarea\"\n            },\n            validation: {\n                isRequired: true\n            }\n        }),\n        segments: (0,_keystone_6_core_fields__WEBPACK_IMPORTED_MODULE_1__.relationship)({\n            ref: \"TranscriptSegment.chatMessages\",\n            many: true\n        }),\n        createdAt: (0,_keystone_6_core_fields__WEBPACK_IMPORTED_MODULE_1__.timestamp)({\n            defaultValue: {\n                kind: \"now\"\n            },\n            ui: {\n                createView: {\n                    fieldMode: \"hidden\"\n                }\n            }\n        })\n    },\n    access: {\n        operation: {\n            query: _domains_auth_userRole__WEBPACK_IMPORTED_MODULE_2__.isAuthenticated,\n            create: _domains_auth_userRole__WEBPACK_IMPORTED_MODULE_2__.isAuthenticated,\n            update: _domains_auth_userRole__WEBPACK_IMPORTED_MODULE_2__.isOrgAdmin,\n            delete: _domains_auth_userRole__WEBPACK_IMPORTED_MODULE_2__.isOrgAdmin\n        },\n        filter: {\n            query: async ({ session })=>{\n                if (!(0,_domains_auth_userRole__WEBPACK_IMPORTED_MODULE_2__.isAuthenticated)({\n                    session\n                })) return false;\n                if ((0,_domains_auth_userRole__WEBPACK_IMPORTED_MODULE_2__.isGod)({\n                    session\n                })) return true;\n                return (0,_domains_auth_userRole__WEBPACK_IMPORTED_MODULE_2__.filterByUserOrg)({\n                    session\n                });\n            }\n        }\n    }\n}));\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi4vLi4vc2NoZW1hcy9DaGF0TWVzc2FnZS50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7QUFDd0M7QUFDd0M7QUFDZTtBQUUvRixpRUFBZUEsc0RBQUlBLENBQUM7SUFDbEJTLFFBQVE7UUFDTkMsTUFBTVQscUVBQVlBLENBQUM7WUFBRVUsS0FBSztZQUFpQkMsTUFBTTtRQUFNO1FBQ3ZEQyxNQUFNWCwrREFBTUEsQ0FBQztZQUNYWSxTQUFTO2dCQUNQO29CQUFFQyxPQUFPO29CQUFRQyxPQUFPO2dCQUFPO2dCQUMvQjtvQkFBRUQsT0FBTztvQkFBYUMsT0FBTztnQkFBWTthQUMxQztZQUNEQyxZQUFZO2dCQUFFQyxZQUFZO1lBQUs7WUFDL0JDLGNBQWM7UUFDaEI7UUFDQUMsU0FBU2pCLDZEQUFJQSxDQUFDO1lBQUVrQixJQUFJO2dCQUFFQyxhQUFhO1lBQVc7WUFBR0wsWUFBWTtnQkFBRUMsWUFBWTtZQUFLO1FBQUU7UUFDbEZLLFVBQVV0QixxRUFBWUEsQ0FBQztZQUFFVSxLQUFLO1lBQWtDQyxNQUFNO1FBQUs7UUFDM0VZLFdBQVdwQixrRUFBU0EsQ0FBQztZQUFFZSxjQUFjO2dCQUFFTSxNQUFNO1lBQU07WUFBR0osSUFBSTtnQkFBRUssWUFBWTtvQkFBRUMsV0FBVztnQkFBUztZQUFFO1FBQUU7SUFDcEc7SUFDQUMsUUFBUTtRQUNOQyxXQUFXO1lBQ1RDLE9BQU94QixtRUFBZUE7WUFDdEJ5QixRQUFRekIsbUVBQWVBO1lBQ3ZCMEIsUUFBUXhCLDhEQUFVQTtZQUNsQnlCLFFBQVF6Qiw4REFBVUE7UUFDcEI7UUFDQTBCLFFBQVE7WUFDTkosT0FBTyxPQUFPLEVBQUVLLE9BQU8sRUFBRTtnQkFDdkIsSUFBSSxDQUFDN0IsdUVBQWVBLENBQUM7b0JBQUU2QjtnQkFBUSxJQUFJLE9BQU87Z0JBQzFDLElBQUk1Qiw2REFBS0EsQ0FBQztvQkFBRTRCO2dCQUFRLElBQUksT0FBTztnQkFDL0IsT0FBTzlCLHVFQUFlQSxDQUFDO29CQUFFOEI7Z0JBQVE7WUFDbkM7UUFDRjtJQUNGO0FBQ0YsRUFBRSxFQUFnQyIsInNvdXJjZXMiOlsid2VicGFjazovLy8uLi8uLi9zY2hlbWFzL0NoYXRNZXNzYWdlLnRzPzAyZTciXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgdHlwZSBMaXN0cyB9IGZyb20gJy5rZXlzdG9uZS90eXBlcyc7XG5pbXBvcnQgeyBsaXN0IH0gZnJvbSAnQGtleXN0b25lLTYvY29yZSc7XG5pbXBvcnQgeyByZWxhdGlvbnNoaXAsIHNlbGVjdCwgdGV4dCwgdGltZXN0YW1wIH0gZnJvbSAnQGtleXN0b25lLTYvY29yZS9maWVsZHMnO1xuaW1wb3J0IHsgZmlsdGVyQnlVc2VyT3JnLCBpc0F1dGhlbnRpY2F0ZWQsIGlzR29kLCBpc09yZ0FkbWluIH0gZnJvbSAnLi4vZG9tYWlucy9hdXRoL3VzZXJSb2xlJztcblxuZXhwb3J0IGRlZmF1bHQgbGlzdCh7XG4gIGZpZWxkczoge1xuICAgIGNoYXQ6IHJlbGF0aW9uc2hpcCh7IHJlZjogJ0NoYXQubWVzc2FnZXMnLCBtYW55OiBmYWxzZSB9KSxcbiAgICByb2xlOiBzZWxlY3Qoe1xuICAgICAgb3B0aW9uczogW1xuICAgICAgICB7IGxhYmVsOiAnVXNlcicsIHZhbHVlOiAndXNlcicgfSxcbiAgICAgICAgeyBsYWJlbDogJ0Fzc2lzdGFudCcsIHZhbHVlOiAnYXNzaXN0YW50JyB9XG4gICAgICBdLFxuICAgICAgdmFsaWRhdGlvbjogeyBpc1JlcXVpcmVkOiB0cnVlIH0sXG4gICAgICBkZWZhdWx0VmFsdWU6ICd1c2VyJ1xuICAgIH0pLFxuICAgIGNvbnRlbnQ6IHRleHQoeyB1aTogeyBkaXNwbGF5TW9kZTogJ3RleHRhcmVhJyB9LCB2YWxpZGF0aW9uOiB7IGlzUmVxdWlyZWQ6IHRydWUgfSB9KSxcbiAgICBzZWdtZW50czogcmVsYXRpb25zaGlwKHsgcmVmOiAnVHJhbnNjcmlwdFNlZ21lbnQuY2hhdE1lc3NhZ2VzJywgbWFueTogdHJ1ZSB9KSxcbiAgICBjcmVhdGVkQXQ6IHRpbWVzdGFtcCh7IGRlZmF1bHRWYWx1ZTogeyBraW5kOiAnbm93JyB9LCB1aTogeyBjcmVhdGVWaWV3OiB7IGZpZWxkTW9kZTogJ2hpZGRlbicgfSB9IH0pXG4gIH0sXG4gIGFjY2Vzczoge1xuICAgIG9wZXJhdGlvbjoge1xuICAgICAgcXVlcnk6IGlzQXV0aGVudGljYXRlZCxcbiAgICAgIGNyZWF0ZTogaXNBdXRoZW50aWNhdGVkLFxuICAgICAgdXBkYXRlOiBpc09yZ0FkbWluLFxuICAgICAgZGVsZXRlOiBpc09yZ0FkbWluXG4gICAgfSxcbiAgICBmaWx0ZXI6IHtcbiAgICAgIHF1ZXJ5OiBhc3luYyAoeyBzZXNzaW9uIH0pID0+IHtcbiAgICAgICAgaWYgKCFpc0F1dGhlbnRpY2F0ZWQoeyBzZXNzaW9uIH0pKSByZXR1cm4gZmFsc2U7XG4gICAgICAgIGlmIChpc0dvZCh7IHNlc3Npb24gfSkpIHJldHVybiB0cnVlO1xuICAgICAgICByZXR1cm4gZmlsdGVyQnlVc2VyT3JnKHsgc2Vzc2lvbiB9KTtcbiAgICAgIH1cbiAgICB9XG4gIH1cbn0pIHNhdGlzZmllcyBMaXN0c1snQ2hhdE1lc3NhZ2UnXTtcblxuIl0sIm5hbWVzIjpbImxpc3QiLCJyZWxhdGlvbnNoaXAiLCJzZWxlY3QiLCJ0ZXh0IiwidGltZXN0YW1wIiwiZmlsdGVyQnlVc2VyT3JnIiwiaXNBdXRoZW50aWNhdGVkIiwiaXNHb2QiLCJpc09yZ0FkbWluIiwiZmllbGRzIiwiY2hhdCIsInJlZiIsIm1hbnkiLCJyb2xlIiwib3B0aW9ucyIsImxhYmVsIiwidmFsdWUiLCJ2YWxpZGF0aW9uIiwiaXNSZXF1aXJlZCIsImRlZmF1bHRWYWx1ZSIsImNvbnRlbnQiLCJ1aSIsImRpc3BsYXlNb2RlIiwic2VnbWVudHMiLCJjcmVhdGVkQXQiLCJraW5kIiwiY3JlYXRlVmlldyIsImZpZWxkTW9kZSIsImFjY2VzcyIsIm9wZXJhdGlvbiIsInF1ZXJ5IiwiY3JlYXRlIiwidXBkYXRlIiwiZGVsZXRlIiwiZmlsdGVyIiwic2Vzc2lvbiJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(api)/../../schemas/ChatMessage.ts\n");

/***/ }),

/***/ "(api)/../../schemas/Organization.ts":
/*!*************************************!*\
  !*** ../../schemas/Organization.ts ***!
  \*************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var _keystone_6_core__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @keystone-6/core */ \"@keystone-6/core\");\n/* harmony import */ var _keystone_6_core__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_keystone_6_core__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _keystone_6_core_fields__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @keystone-6/core/fields */ \"@keystone-6/core/fields\");\n/* harmony import */ var _keystone_6_core_fields__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(_keystone_6_core_fields__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var free_email_domains__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! free-email-domains */ \"free-email-domains\");\n/* harmony import */ var free_email_domains__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(free_email_domains__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var _domains_auth_userRole__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../domains/auth/userRole */ \"(api)/../../domains/auth/userRole.ts\");\n\n\n\n\nconst freeEmailDomainSet = new Set(free_email_domains__WEBPACK_IMPORTED_MODULE_2___default().map((domain)=>domain.toLowerCase()));\nconst normalizeDomains = (value)=>{\n    if (!Array.isArray(value)) return [];\n    const seen = new Set();\n    const result = [];\n    value.map((domain)=>typeof domain === \"string\" ? domain.trim().toLowerCase() : \"\").filter(Boolean).forEach((domain)=>{\n        if (seen.has(domain)) return;\n        seen.add(domain);\n        result.push(domain);\n    });\n    return result;\n};\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_keystone_6_core__WEBPACK_IMPORTED_MODULE_0__.list)({\n    fields: {\n        name: (0,_keystone_6_core_fields__WEBPACK_IMPORTED_MODULE_1__.text)({\n            validation: {\n                isRequired: true\n            }\n        }),\n        autojoinDomains: (0,_keystone_6_core_fields__WEBPACK_IMPORTED_MODULE_1__.json)({\n            defaultValue: [],\n            ui: {\n                description: 'Array of domains allowed to auto-join (e.g. [\"example.com\"])'\n            }\n        }),\n        users: (0,_keystone_6_core_fields__WEBPACK_IMPORTED_MODULE_1__.relationship)({\n            ref: \"User.org\",\n            many: true\n        }),\n        projects: (0,_keystone_6_core_fields__WEBPACK_IMPORTED_MODULE_1__.relationship)({\n            ref: \"Project.org\",\n            many: true\n        }),\n        transcripts: (0,_keystone_6_core_fields__WEBPACK_IMPORTED_MODULE_1__.relationship)({\n            ref: \"Transcript.org\",\n            many: true\n        }),\n        chats: (0,_keystone_6_core_fields__WEBPACK_IMPORTED_MODULE_1__.relationship)({\n            ref: \"Chat.org\",\n            many: true\n        })\n    },\n    ui: {\n        labelField: \"name\"\n    },\n    access: {\n        operation: {\n            query: _domains_auth_userRole__WEBPACK_IMPORTED_MODULE_3__.isAuthenticated,\n            create: _domains_auth_userRole__WEBPACK_IMPORTED_MODULE_3__.isAuthenticated,\n            update: (0,_domains_auth_userRole__WEBPACK_IMPORTED_MODULE_3__.hasRole)([\n                _domains_auth_userRole__WEBPACK_IMPORTED_MODULE_3__.UserRole.GOD,\n                _domains_auth_userRole__WEBPACK_IMPORTED_MODULE_3__.UserRole.ORG_OWNER\n            ]),\n            delete: _domains_auth_userRole__WEBPACK_IMPORTED_MODULE_3__.isGod\n        },\n        item: {\n            update: async ({ session, item })=>{\n                if ((0,_domains_auth_userRole__WEBPACK_IMPORTED_MODULE_3__.isGod)({\n                    session\n                })) return true;\n                return session?.orgId === item.id;\n            }\n        }\n    },\n    hooks: {\n        resolveInput: {\n            create: async ({ resolvedData })=>({\n                    ...resolvedData,\n                    autojoinDomains: normalizeDomains(resolvedData.autojoinDomains)\n                }),\n            update: async ({ resolvedData })=>{\n                if (!Object.prototype.hasOwnProperty.call(resolvedData, \"autojoinDomains\")) return resolvedData;\n                return {\n                    ...resolvedData,\n                    autojoinDomains: normalizeDomains(resolvedData.autojoinDomains)\n                };\n            }\n        },\n        afterOperation: {\n            create: async ({ item, context })=>{\n                const session = context.session;\n                if (session?.id && item?.id) {\n                    const sudo = context.sudo();\n                    const user = await sudo.query.User.findOne({\n                        where: {\n                            id: session.id\n                        },\n                        query: \"id project { id }\"\n                    });\n                    // Only auto-connect if user already has a project (not in onboarding flow)\n                    // During onboarding, the completeOnboarding mutation will handle connecting both org and project\n                    if (user?.project?.id) {\n                        await sudo.db.User.updateOne({\n                            where: {\n                                id: session.id\n                            },\n                            data: {\n                                role: _domains_auth_userRole__WEBPACK_IMPORTED_MODULE_3__.UserRole.ORG_OWNER,\n                                org: {\n                                    connect: {\n                                        id: item.id\n                                    }\n                                }\n                            }\n                        });\n                    }\n                }\n            }\n        },\n        validateInput: async ({ resolvedData, item, addValidationError })=>{\n            const candidate = Object.prototype.hasOwnProperty.call(resolvedData, \"autojoinDomains\") ? normalizeDomains(resolvedData.autojoinDomains) : normalizeDomains(item?.autojoinDomains);\n            const invalidDomain = candidate.find((domain)=>freeEmailDomainSet.has(domain));\n            if (invalidDomain) {\n                addValidationError(`Domain ${invalidDomain} is a free email provider and cannot be used for auto-join.`);\n            }\n        }\n    }\n}));\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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O3dCQUN6Q0MsT0FBTzs0QkFBRWQsSUFBSUYsUUFBUUUsRUFBRTt3QkFBQzt3QkFDeEJULE9BQU87b0JBQ1Q7b0JBRUEsMkVBQTJFO29CQUMzRSxpR0FBaUc7b0JBQ2pHLElBQUlvQixNQUFNSSxTQUFTZixJQUFJO3dCQUNyQixNQUFNVSxLQUFLTSxFQUFFLENBQUNKLElBQUksQ0FBQ0ssU0FBUyxDQUFDOzRCQUMzQkgsT0FBTztnQ0FBRWQsSUFBSUYsUUFBUUUsRUFBRTs0QkFBQzs0QkFDeEJrQixNQUFNO2dDQUNKQyxNQUFNaEUsNERBQVFBLENBQUN3QyxTQUFTO2dDQUN4QnlCLEtBQUs7b0NBQUVDLFNBQVM7d0NBQUVyQixJQUFJSCxLQUFLRyxFQUFFO29DQUFXO2dDQUFFOzRCQUM1Qzt3QkFDRjtvQkFDRjtnQkFDRjtZQUNGO1FBQ0Y7UUFDQXNCLGVBQWUsT0FBTyxFQUFFbkIsWUFBWSxFQUFFTixJQUFJLEVBQUUwQixrQkFBa0IsRUFBRTtZQUM5RCxNQUFNQyxZQUFZcEIsT0FBT0MsU0FBUyxDQUFDQyxjQUFjLENBQUNDLElBQUksQ0FBQ0osY0FBYyxxQkFDakUxQyxpQkFBaUIwQyxhQUFhekIsZUFBZSxJQUM3Q2pCLGlCQUFpQm9DLE1BQU1uQjtZQUUzQixNQUFNK0MsZ0JBQWdCRCxVQUFVRSxJQUFJLENBQUNuRSxDQUFBQSxTQUFVSCxtQkFBbUJlLEdBQUcsQ0FBQ1o7WUFDdEUsSUFBSWtFLGVBQWU7Z0JBQ2pCRixtQkFBbUIsQ0FBQyxPQUFPLEVBQUVFLGNBQWMsMkRBQTJELENBQUM7WUFDekc7UUFDRjtJQUNGO0FBQ0YsRUFBRSxFQUFpQyIsInNvdXJjZXMiOlsid2VicGFjazovLy8uLi8uLi9zY2hlbWFzL09yZ2FuaXphdGlvbi50cz85N2YxIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IHR5cGUgTGlzdHMgfSBmcm9tICcua2V5c3RvbmUvdHlwZXMnO1xuaW1wb3J0IHsgbGlzdCB9IGZyb20gJ0BrZXlzdG9uZS02L2NvcmUnO1xuaW1wb3J0IHsganNvbiwgcmVsYXRpb25zaGlwLCB0ZXh0IH0gZnJvbSAnQGtleXN0b25lLTYvY29yZS9maWVsZHMnO1xuaW1wb3J0IGZyZWVFbWFpbERvbWFpbnMgZnJvbSAnZnJlZS1lbWFpbC1kb21haW5zJztcbmltcG9ydCB0eXBlIHsgU2Vzc2lvbiB9IGZyb20gJy4uL2F1dGgnO1xuaW1wb3J0IHsgaGFzUm9sZSwgaXNBdXRoZW50aWNhdGVkLCBpc0dvZCwgVXNlclJvbGUgfSBmcm9tICcuLi9kb21haW5zL2F1dGgvdXNlclJvbGUnO1xuXG5jb25zdCBmcmVlRW1haWxEb21haW5TZXQgPSBuZXcgU2V0PHN0cmluZz4oKGZyZWVFbWFpbERvbWFpbnMgYXMgc3RyaW5nW10pLm1hcChkb21haW4gPT4gZG9tYWluLnRvTG93ZXJDYXNlKCkpKTtcblxuY29uc3Qgbm9ybWFsaXplRG9tYWlucyA9ICh2YWx1ZTogdW5rbm93bik6IHN0cmluZ1tdID0+IHtcbiAgaWYgKCFBcnJheS5pc0FycmF5KHZhbHVlKSkgcmV0dXJuIFtdO1xuICBjb25zdCBzZWVuID0gbmV3IFNldDxzdHJpbmc+KCk7XG4gIGNvbnN0IHJlc3VsdDogc3RyaW5nW10gPSBbXTtcbiAgdmFsdWVcbiAgICAubWFwKGRvbWFpbiA9PiAodHlwZW9mIGRvbWFpbiA9PT0gJ3N0cmluZycgPyBkb21haW4udHJpbSgpLnRvTG93ZXJDYXNlKCkgOiAnJykpXG4gICAgLmZpbHRlcihCb29sZWFuKVxuICAgIC5mb3JFYWNoKGRvbWFpbiA9PiB7XG4gICAgICBpZiAoc2Vlbi5oYXMoZG9tYWluKSkgcmV0dXJuO1xuICAgICAgc2Vlbi5hZGQoZG9tYWluKTtcbiAgICAgIHJlc3VsdC5wdXNoKGRvbWFpbik7XG4gICAgfSk7XG4gIHJldHVybiByZXN1bHQ7XG59O1xuXG5leHBvcnQgZGVmYXVsdCBsaXN0KHtcbiAgZmllbGRzOiB7XG4gICAgbmFtZTogdGV4dCh7IHZhbGlkYXRpb246IHsgaXNSZXF1aXJlZDogdHJ1ZSB9IH0pLFxuICAgIGF1dG9qb2luRG9tYWluczoganNvbih7XG4gICAgICBkZWZhdWx0VmFsdWU6IFtdLFxuICAgICAgdWk6IHtcbiAgICAgICAgZGVzY3JpcHRpb246ICdBcnJheSBvZiBkb21haW5zIGFsbG93ZWQgdG8gYXV0by1qb2luIChlLmcuIFtcImV4YW1wbGUuY29tXCJdKSdcbiAgICAgIH1cbiAgICB9KSxcbiAgICB1c2VyczogcmVsYXRpb25zaGlwKHsgcmVmOiAnVXNlci5vcmcnLCBtYW55OiB0cnVlIH0pLFxuICAgIHByb2plY3RzOiByZWxhdGlvbnNoaXAoeyByZWY6ICdQcm9qZWN0Lm9yZycsIG1hbnk6IHRydWUgfSksXG4gICAgdHJhbnNjcmlwdHM6IHJlbGF0aW9uc2hpcCh7IHJlZjogJ1RyYW5zY3JpcHQub3JnJywgbWFueTogdHJ1ZSB9KSxcbiAgICBjaGF0czogcmVsYXRpb25zaGlwKHsgcmVmOiAnQ2hhdC5vcmcnLCBtYW55OiB0cnVlIH0pXG4gIH0sXG4gIHVpOiB7XG4gICAgbGFiZWxGaWVsZDogJ25hbWUnXG4gIH0sXG4gIGFjY2Vzczoge1xuICAgIG9wZXJhdGlvbjoge1xuICAgICAgcXVlcnk6IGlzQXV0aGVudGljYXRlZCxcbiAgICAgIGNyZWF0ZTogaXNBdXRoZW50aWNhdGVkLFxuICAgICAgdXBkYXRlOiBoYXNSb2xlKFtVc2VyUm9sZS5HT0QsIFVzZXJSb2xlLk9SR19PV05FUl0pLFxuICAgICAgZGVsZXRlOiBpc0dvZFxuICAgIH0sXG4gICAgaXRlbToge1xuICAgICAgdXBkYXRlOiBhc3luYyAoeyBzZXNzaW9uLCBpdGVtIH0pID0+IHtcbiAgICAgICAgaWYgKGlzR29kKHsgc2Vzc2lvbiB9KSkgcmV0dXJuIHRydWU7XG4gICAgICAgIHJldHVybiBzZXNzaW9uPy5vcmdJZCA9PT0gaXRlbS5pZDtcbiAgICAgIH1cbiAgICB9XG4gIH0sXG4gIGhvb2tzOiB7XG4gICAgcmVzb2x2ZUlucHV0OiB7XG4gICAgICBjcmVhdGU6IGFzeW5jICh7IHJlc29sdmVkRGF0YSB9KSA9PiAoe1xuICAgICAgICAuLi5yZXNvbHZlZERhdGEsXG4gICAgICAgIGF1dG9qb2luRG9tYWluczogbm9ybWFsaXplRG9tYWlucyhyZXNvbHZlZERhdGEuYXV0b2pvaW5Eb21haW5zKVxuICAgICAgfSksXG4gICAgICB1cGRhdGU6IGFzeW5jICh7IHJlc29sdmVkRGF0YSB9KSA9PiB7XG4gICAgICAgIGlmICghT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKHJlc29sdmVkRGF0YSwgJ2F1dG9qb2luRG9tYWlucycpKSByZXR1cm4gcmVzb2x2ZWREYXRhO1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIC4uLnJlc29sdmVkRGF0YSxcbiAgICAgICAgICBhdXRvam9pbkRvbWFpbnM6IG5vcm1hbGl6ZURvbWFpbnMocmVzb2x2ZWREYXRhLmF1dG9qb2luRG9tYWlucylcbiAgICAgICAgfTtcbiAgICAgIH1cbiAgICB9LFxuICAgIGFmdGVyT3BlcmF0aW9uOiB7XG4gICAgICBjcmVhdGU6IGFzeW5jICh7IGl0ZW0sIGNvbnRleHQgfSkgPT4ge1xuICAgICAgICBjb25zdCBzZXNzaW9uID0gY29udGV4dC5zZXNzaW9uIGFzIFNlc3Npb24gfCBudWxsO1xuICAgICAgICBpZiAoc2Vzc2lvbj8uaWQgJiYgaXRlbT8uaWQpIHtcbiAgICAgICAgICBjb25zdCBzdWRvID0gY29udGV4dC5zdWRvKCk7XG4gICAgICAgICAgY29uc3QgdXNlciA9IGF3YWl0IHN1ZG8ucXVlcnkuVXNlci5maW5kT25lKHtcbiAgICAgICAgICAgIHdoZXJlOiB7IGlkOiBzZXNzaW9uLmlkIH0sXG4gICAgICAgICAgICBxdWVyeTogJ2lkIHByb2plY3QgeyBpZCB9J1xuICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgLy8gT25seSBhdXRvLWNvbm5lY3QgaWYgdXNlciBhbHJlYWR5IGhhcyBhIHByb2plY3QgKG5vdCBpbiBvbmJvYXJkaW5nIGZsb3cpXG4gICAgICAgICAgLy8gRHVyaW5nIG9uYm9hcmRpbmcsIHRoZSBjb21wbGV0ZU9uYm9hcmRpbmcgbXV0YXRpb24gd2lsbCBoYW5kbGUgY29ubmVjdGluZyBib3RoIG9yZyBhbmQgcHJvamVjdFxuICAgICAgICAgIGlmICh1c2VyPy5wcm9qZWN0Py5pZCkge1xuICAgICAgICAgICAgYXdhaXQgc3Vkby5kYi5Vc2VyLnVwZGF0ZU9uZSh7XG4gICAgICAgICAgICAgIHdoZXJlOiB7IGlkOiBzZXNzaW9uLmlkIH0sXG4gICAgICAgICAgICAgIGRhdGE6IHtcbiAgICAgICAgICAgICAgICByb2xlOiBVc2VyUm9sZS5PUkdfT1dORVIsXG4gICAgICAgICAgICAgICAgb3JnOiB7IGNvbm5lY3Q6IHsgaWQ6IGl0ZW0uaWQgYXMgc3RyaW5nIH0gfVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9LFxuICAgIHZhbGlkYXRlSW5wdXQ6IGFzeW5jICh7IHJlc29sdmVkRGF0YSwgaXRlbSwgYWRkVmFsaWRhdGlvbkVycm9yIH0pID0+IHtcbiAgICAgIGNvbnN0IGNhbmRpZGF0ZSA9IE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChyZXNvbHZlZERhdGEsICdhdXRvam9pbkRvbWFpbnMnKVxuICAgICAgICA/IG5vcm1hbGl6ZURvbWFpbnMocmVzb2x2ZWREYXRhLmF1dG9qb2luRG9tYWlucylcbiAgICAgICAgOiBub3JtYWxpemVEb21haW5zKGl0ZW0/LmF1dG9qb2luRG9tYWlucyk7XG5cbiAgICAgIGNvbnN0IGludmFsaWREb21haW4gPSBjYW5kaWRhdGUuZmluZChkb21haW4gPT4gZnJlZUVtYWlsRG9tYWluU2V0Lmhhcyhkb21haW4pKTtcbiAgICAgIGlmIChpbnZhbGlkRG9tYWluKSB7XG4gICAgICAgIGFkZFZhbGlkYXRpb25FcnJvcihgRG9tYWluICR7aW52YWxpZERvbWFpbn0gaXMgYSBmcmVlIGVtYWlsIHByb3ZpZGVyIGFuZCBjYW5ub3QgYmUgdXNlZCBmb3IgYXV0by1qb2luLmApO1xuICAgICAgfVxuICAgIH1cbiAgfVxufSkgc2F0aXNmaWVzIExpc3RzWydPcmdhbml6YXRpb24nXTtcbiJdLCJuYW1lcyI6WyJsaXN0IiwianNvbiIsInJlbGF0aW9uc2hpcCIsInRleHQiLCJmcmVlRW1haWxEb21haW5zIiwiaGFzUm9sZSIsImlzQXV0aGVudGljYXRlZCIsImlzR29kIiwiVXNlclJvbGUiLCJmcmVlRW1haWxEb21haW5TZXQiLCJTZXQiLCJtYXAiLCJkb21haW4iLCJ0b0xvd2VyQ2FzZSIsIm5vcm1hbGl6ZURvbWFpbnMiLCJ2YWx1ZSIsIkFycmF5IiwiaXNBcnJheSIsInNlZW4iLCJyZXN1bHQiLCJ0cmltIiwiZmlsdGVyIiwiQm9vbGVhbiIsImZvckVhY2giLCJoYXMiLCJhZGQiLCJwdXNoIiwiZmllbGRzIiwibmFtZSIsInZhbGlkYXRpb24iLCJpc1JlcXVpcmVkIiwiYXV0b2pvaW5Eb21haW5zIiwiZGVmYXVsdFZhbHVlIiwidWkiLCJkZXNjcmlwdGlvbiIsInVzZXJzIiwicmVmIiwibWFueSIsInByb2plY3RzIiwidHJhbnNjcmlwdHMiLCJjaGF0cyIsImxhYmVsRmllbGQiLCJhY2Nlc3MiLCJvcGVyYXRpb24iLCJxdWVyeSIsImNyZWF0ZSIsInVwZGF0ZSIsIkdPRCIsIk9SR19PV05FUiIsImRlbGV0ZSIsIml0ZW0iLCJzZXNzaW9uIiwib3JnSWQiLCJpZCIsImhvb2tzIiwicmVzb2x2ZUlucHV0IiwicmVzb2x2ZWREYXRhIiwiT2JqZWN0IiwicHJvdG90eXBlIiwiaGFzT3duUHJvcGVydHkiLCJjYWxsIiwiYWZ0ZXJPcGVyYXRpb24iLCJjb250ZXh0Iiwic3VkbyIsInVzZXIiLCJVc2VyIiwiZmluZE9uZSIsIndoZXJlIiwicHJvamVjdCIsImRiIiwidXBkYXRlT25lIiwiZGF0YSIsInJvbGUiLCJvcmciLCJjb25uZWN0IiwidmFsaWRhdGVJbnB1dCIsImFkZFZhbGlkYXRpb25FcnJvciIsImNhbmRpZGF0ZSIsImludmFsaWREb21haW4iLCJmaW5kIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(api)/../../schemas/Organization.ts\n");

/***/ }),

/***/ "(api)/../../schemas/Project.ts":
/*!********************************!*\
  !*** ../../schemas/Project.ts ***!
  \********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var _keystone_6_core__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @keystone-6/core */ \"@keystone-6/core\");\n/* harmony import */ var _keystone_6_core__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_keystone_6_core__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _keystone_6_core_fields__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @keystone-6/core/fields */ \"@keystone-6/core/fields\");\n/* harmony import */ var _keystone_6_core_fields__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(_keystone_6_core_fields__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var _domains_auth_userRole__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../domains/auth/userRole */ \"(api)/../../domains/auth/userRole.ts\");\n\n\n\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_keystone_6_core__WEBPACK_IMPORTED_MODULE_0__.list)({\n    fields: {\n        name: (0,_keystone_6_core_fields__WEBPACK_IMPORTED_MODULE_1__.text)({\n            validation: {\n                isRequired: true\n            }\n        }),\n        description: (0,_keystone_6_core_fields__WEBPACK_IMPORTED_MODULE_1__.text)({\n            ui: {\n                displayMode: \"textarea\"\n            },\n            validation: {\n                isRequired: false\n            }\n        }),\n        org: (0,_keystone_6_core_fields__WEBPACK_IMPORTED_MODULE_1__.relationship)({\n            ref: \"Organization.projects\",\n            many: false\n        }),\n        users: (0,_keystone_6_core_fields__WEBPACK_IMPORTED_MODULE_1__.relationship)({\n            ref: \"User.project\",\n            many: true\n        }),\n        transcripts: (0,_keystone_6_core_fields__WEBPACK_IMPORTED_MODULE_1__.relationship)({\n            ref: \"Transcript.project\",\n            many: true\n        }),\n        chats: (0,_keystone_6_core_fields__WEBPACK_IMPORTED_MODULE_1__.relationship)({\n            ref: \"Chat.project\",\n            many: true\n        })\n    },\n    ui: {\n        labelField: \"name\"\n    },\n    access: {\n        operation: {\n            query: ({ session })=>(0,_domains_auth_userRole__WEBPACK_IMPORTED_MODULE_2__.isAuthenticated)({\n                    session\n                }),\n            create: _domains_auth_userRole__WEBPACK_IMPORTED_MODULE_2__.canEditOrgData,\n            update: _domains_auth_userRole__WEBPACK_IMPORTED_MODULE_2__.canEditProjectData,\n            delete: _domains_auth_userRole__WEBPACK_IMPORTED_MODULE_2__.canEditOrgData\n        },\n        item: {\n            update: async ({ session, item, context })=>{\n                if ((0,_domains_auth_userRole__WEBPACK_IMPORTED_MODULE_2__.isGod)({\n                    session\n                })) return true;\n                if (!item?.id) return false;\n                const targetProjectId = String(item.id);\n                const sudoContext = context.sudo();\n                const project = await sudoContext.query.Project.findOne({\n                    where: {\n                        id: targetProjectId\n                    },\n                    query: \"id org { id }\"\n                });\n                if (!project) return false;\n                if ((0,_domains_auth_userRole__WEBPACK_IMPORTED_MODULE_2__.isOrgAdmin)({\n                    session\n                })) {\n                    if (!session?.orgId) return false;\n                    return project.org?.id ? String(project.org.id) === String(session.orgId) : false;\n                }\n                if ((0,_domains_auth_userRole__WEBPACK_IMPORTED_MODULE_2__.isProjectAdmin)({\n                    session\n                })) {\n                    if (!session?.projectId) return false;\n                    return targetProjectId === String(session.projectId);\n                }\n                return false;\n            },\n            delete: async ({ session, item, context })=>{\n                if ((0,_domains_auth_userRole__WEBPACK_IMPORTED_MODULE_2__.isGod)({\n                    session\n                })) return true;\n                if (!(0,_domains_auth_userRole__WEBPACK_IMPORTED_MODULE_2__.isOrgAdmin)({\n                    session\n                })) return false;\n                if (!session?.orgId || !item?.id) return false;\n                const sudoContext = context.sudo();\n                const project = await sudoContext.query.Project.findOne({\n                    where: {\n                        id: String(item.id)\n                    },\n                    query: \"id org { id }\"\n                });\n                if (!project?.org?.id) return false;\n                return String(project.org.id) === String(session.orgId);\n            }\n        },\n        filter: {\n            query: async ({ session })=>{\n                if (!(0,_domains_auth_userRole__WEBPACK_IMPORTED_MODULE_2__.isAuthenticated)({\n                    session\n                })) return false;\n                if ((0,_domains_auth_userRole__WEBPACK_IMPORTED_MODULE_2__.isGod)({\n                    session\n                })) return true;\n                if ((0,_domains_auth_userRole__WEBPACK_IMPORTED_MODULE_2__.isOrgAdmin)({\n                    session\n                })) return (0,_domains_auth_userRole__WEBPACK_IMPORTED_MODULE_2__.filterByUserOrg)({\n                    session\n                });\n                if (!session?.projectId) return false;\n                return {\n                    id: {\n                        equals: session.projectId\n                    }\n                };\n            }\n        }\n    },\n    hooks: {\n        resolveInput: {\n            create: async ({ resolvedData, context })=>{\n                if (resolvedData.org) return resolvedData;\n                const orgId = context.session?.orgId;\n                if (!orgId) return resolvedData;\n                return {\n                    ...resolvedData,\n                    org: {\n                        connect: {\n                            id: orgId\n                        }\n                    }\n                };\n            }\n        },\n        validateDelete: async ({ item, context, addValidationError })=>{\n            if (!item?.id) return;\n            const sudoContext = context.sudo();\n            const projectId = String(item.id);\n            const project = await sudoContext.query.Project.findOne({\n                where: {\n                    id: projectId\n                },\n                query: \"id org { id }\"\n            });\n            if (!project?.org?.id) {\n                addValidationError(\"Project is missing organization context.\");\n                return;\n            }\n            const [orgProjectCount, userCount] = await Promise.all([\n                sudoContext.db.Project.count({\n                    where: {\n                        org: {\n                            id: {\n                                equals: project.org.id\n                            }\n                        }\n                    }\n                }),\n                sudoContext.db.User.count({\n                    where: {\n                        project: {\n                            id: {\n                                equals: projectId\n                            }\n                        }\n                    }\n                })\n            ]);\n            if (userCount > 0) {\n                addValidationError(\"You cannot delete a project that still has users.\");\n                return;\n            }\n            if (orgProjectCount <= 1) {\n                addValidationError(\"Each organization must have at least one project.\");\n            }\n        }\n    }\n}));\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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VTtnQkFBVTtnQkFDdkJqQixPQUFPO1lBQ1Q7WUFFQSxJQUFJLENBQUNZLFNBQVNyQixLQUFLZ0IsSUFBSTtnQkFDckJrQixtQkFBbUI7Z0JBQ25CO1lBQ0Y7WUFFQSxNQUFNLENBQUNDLGlCQUFpQkMsVUFBVSxHQUFHLE1BQU1DLFFBQVFDLEdBQUcsQ0FBQztnQkFDckRuQixZQUFZb0IsRUFBRSxDQUFDakIsT0FBTyxDQUFDa0IsS0FBSyxDQUFDO29CQUFFaEIsT0FBTzt3QkFBRXhCLEtBQUs7NEJBQUVnQixJQUFJO2dDQUFFWSxRQUFRUCxRQUFRckIsR0FBRyxDQUFDZ0IsRUFBRTs0QkFBQzt3QkFBRTtvQkFBRTtnQkFBRTtnQkFDbEZHLFlBQVlvQixFQUFFLENBQUNFLElBQUksQ0FBQ0QsS0FBSyxDQUFDO29CQUFFaEIsT0FBTzt3QkFBRUgsU0FBUzs0QkFBRUwsSUFBSTtnQ0FBRVksUUFBUUY7NEJBQVU7d0JBQUU7b0JBQUU7Z0JBQUU7YUFDL0U7WUFFRCxJQUFJVSxZQUFZLEdBQUc7Z0JBQ2pCRixtQkFBbUI7Z0JBQ25CO1lBQ0Y7WUFFQSxJQUFJQyxtQkFBbUIsR0FBRztnQkFDeEJELG1CQUFtQjtZQUNyQjtRQUNGO0lBQ0Y7QUFDRixFQUFFLEVBQTRCIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLy4uLy4uL3NjaGVtYXMvUHJvamVjdC50cz85MDhlIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IHR5cGUgTGlzdHMgfSBmcm9tICcua2V5c3RvbmUvdHlwZXMnO1xuaW1wb3J0IHsgbGlzdCB9IGZyb20gJ0BrZXlzdG9uZS02L2NvcmUnO1xuaW1wb3J0IHsgcmVsYXRpb25zaGlwLCB0ZXh0IH0gZnJvbSAnQGtleXN0b25lLTYvY29yZS9maWVsZHMnO1xuaW1wb3J0IHtcbiAgY2FuRWRpdE9yZ0RhdGEsXG4gIGNhbkVkaXRQcm9qZWN0RGF0YSxcbiAgZmlsdGVyQnlVc2VyT3JnLFxuICBpc0F1dGhlbnRpY2F0ZWQsXG4gIGlzR29kLFxuICBpc09yZ0FkbWluLFxuICBpc1Byb2plY3RBZG1pblxufSBmcm9tICcuLi9kb21haW5zL2F1dGgvdXNlclJvbGUnO1xuXG5leHBvcnQgZGVmYXVsdCBsaXN0KHtcbiAgZmllbGRzOiB7XG4gICAgbmFtZTogdGV4dCh7IHZhbGlkYXRpb246IHsgaXNSZXF1aXJlZDogdHJ1ZSB9IH0pLFxuICAgIGRlc2NyaXB0aW9uOiB0ZXh0KHsgdWk6IHsgZGlzcGxheU1vZGU6ICd0ZXh0YXJlYScgfSwgdmFsaWRhdGlvbjogeyBpc1JlcXVpcmVkOiBmYWxzZSB9IH0pLFxuICAgIG9yZzogcmVsYXRpb25zaGlwKHsgcmVmOiAnT3JnYW5pemF0aW9uLnByb2plY3RzJywgbWFueTogZmFsc2UgfSksXG4gICAgdXNlcnM6IHJlbGF0aW9uc2hpcCh7IHJlZjogJ1VzZXIucHJvamVjdCcsIG1hbnk6IHRydWUgfSksXG4gICAgdHJhbnNjcmlwdHM6IHJlbGF0aW9uc2hpcCh7IHJlZjogJ1RyYW5zY3JpcHQucHJvamVjdCcsIG1hbnk6IHRydWUgfSksXG4gICAgY2hhdHM6IHJlbGF0aW9uc2hpcCh7IHJlZjogJ0NoYXQucHJvamVjdCcsIG1hbnk6IHRydWUgfSlcbiAgfSxcbiAgdWk6IHtcbiAgICBsYWJlbEZpZWxkOiAnbmFtZSdcbiAgfSxcbiAgYWNjZXNzOiB7XG4gICAgb3BlcmF0aW9uOiB7XG4gICAgICBxdWVyeTogKHsgc2Vzc2lvbiB9KSA9PiBpc0F1dGhlbnRpY2F0ZWQoeyBzZXNzaW9uIH0pLFxuICAgICAgY3JlYXRlOiBjYW5FZGl0T3JnRGF0YSxcbiAgICAgIHVwZGF0ZTogY2FuRWRpdFByb2plY3REYXRhLFxuICAgICAgZGVsZXRlOiBjYW5FZGl0T3JnRGF0YVxuICAgIH0sXG4gICAgaXRlbToge1xuICAgICAgdXBkYXRlOiBhc3luYyAoeyBzZXNzaW9uLCBpdGVtLCBjb250ZXh0IH0pID0+IHtcbiAgICAgICAgaWYgKGlzR29kKHsgc2Vzc2lvbiB9KSkgcmV0dXJuIHRydWU7XG4gICAgICAgIGlmICghaXRlbT8uaWQpIHJldHVybiBmYWxzZTtcblxuICAgICAgICBjb25zdCB0YXJnZXRQcm9qZWN0SWQgPSBTdHJpbmcoaXRlbS5pZCk7XG4gICAgICAgIGNvbnN0IHN1ZG9Db250ZXh0ID0gY29udGV4dC5zdWRvKCk7XG4gICAgICAgIGNvbnN0IHByb2plY3QgPSAoYXdhaXQgc3Vkb0NvbnRleHQucXVlcnkuUHJvamVjdC5maW5kT25lKHtcbiAgICAgICAgICB3aGVyZTogeyBpZDogdGFyZ2V0UHJvamVjdElkIH0sXG4gICAgICAgICAgcXVlcnk6ICdpZCBvcmcgeyBpZCB9J1xuICAgICAgICB9KSkgYXMgeyBpZDogc3RyaW5nOyBvcmc6IHsgaWQ6IHN0cmluZyB9IHwgbnVsbCB9IHwgbnVsbDtcblxuICAgICAgICBpZiAoIXByb2plY3QpIHJldHVybiBmYWxzZTtcblxuICAgICAgICBpZiAoaXNPcmdBZG1pbih7IHNlc3Npb24gfSkpIHtcbiAgICAgICAgICBpZiAoIXNlc3Npb24/Lm9yZ0lkKSByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgcmV0dXJuIHByb2plY3Qub3JnPy5pZCA/IFN0cmluZyhwcm9qZWN0Lm9yZy5pZCkgPT09IFN0cmluZyhzZXNzaW9uLm9yZ0lkKSA6IGZhbHNlO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKGlzUHJvamVjdEFkbWluKHsgc2Vzc2lvbiB9KSkge1xuICAgICAgICAgIGlmICghc2Vzc2lvbj8ucHJvamVjdElkKSByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgcmV0dXJuIHRhcmdldFByb2plY3RJZCA9PT0gU3RyaW5nKHNlc3Npb24ucHJvamVjdElkKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgIH0sXG4gICAgICBkZWxldGU6IGFzeW5jICh7IHNlc3Npb24sIGl0ZW0sIGNvbnRleHQgfSkgPT4ge1xuICAgICAgICBpZiAoaXNHb2QoeyBzZXNzaW9uIH0pKSByZXR1cm4gdHJ1ZTtcbiAgICAgICAgaWYgKCFpc09yZ0FkbWluKHsgc2Vzc2lvbiB9KSkgcmV0dXJuIGZhbHNlO1xuICAgICAgICBpZiAoIXNlc3Npb24/Lm9yZ0lkIHx8ICFpdGVtPy5pZCkgcmV0dXJuIGZhbHNlO1xuXG4gICAgICAgIGNvbnN0IHN1ZG9Db250ZXh0ID0gY29udGV4dC5zdWRvKCk7XG4gICAgICAgIGNvbnN0IHByb2plY3QgPSAoYXdhaXQgc3Vkb0NvbnRleHQucXVlcnkuUHJvamVjdC5maW5kT25lKHtcbiAgICAgICAgICB3aGVyZTogeyBpZDogU3RyaW5nKGl0ZW0uaWQpIH0sXG4gICAgICAgICAgcXVlcnk6ICdpZCBvcmcgeyBpZCB9J1xuICAgICAgICB9KSkgYXMgeyBvcmc6IHsgaWQ6IHN0cmluZyB9IHwgbnVsbCB9IHwgbnVsbDtcblxuICAgICAgICBpZiAoIXByb2plY3Q/Lm9yZz8uaWQpIHJldHVybiBmYWxzZTtcbiAgICAgICAgcmV0dXJuIFN0cmluZyhwcm9qZWN0Lm9yZy5pZCkgPT09IFN0cmluZyhzZXNzaW9uLm9yZ0lkKTtcbiAgICAgIH1cbiAgICB9LFxuICAgIGZpbHRlcjoge1xuICAgICAgcXVlcnk6IGFzeW5jICh7IHNlc3Npb24gfSkgPT4ge1xuICAgICAgICBpZiAoIWlzQXV0aGVudGljYXRlZCh7IHNlc3Npb24gfSkpIHJldHVybiBmYWxzZTtcbiAgICAgICAgaWYgKGlzR29kKHsgc2Vzc2lvbiB9KSkgcmV0dXJuIHRydWU7XG4gICAgICAgIGlmIChpc09yZ0FkbWluKHsgc2Vzc2lvbiB9KSkgcmV0dXJuIGZpbHRlckJ5VXNlck9yZyh7IHNlc3Npb24gfSk7XG4gICAgICAgIGlmICghc2Vzc2lvbj8ucHJvamVjdElkKSByZXR1cm4gZmFsc2U7XG4gICAgICAgIHJldHVybiB7IGlkOiB7IGVxdWFsczogc2Vzc2lvbi5wcm9qZWN0SWQgfSB9O1xuICAgICAgfVxuICAgIH1cbiAgfSxcbiAgaG9va3M6IHtcbiAgICByZXNvbHZlSW5wdXQ6IHtcbiAgICAgIGNyZWF0ZTogYXN5bmMgKHsgcmVzb2x2ZWREYXRhLCBjb250ZXh0IH0pID0+IHtcbiAgICAgICAgaWYgKHJlc29sdmVkRGF0YS5vcmcpIHJldHVybiByZXNvbHZlZERhdGE7XG4gICAgICAgIGNvbnN0IG9yZ0lkID0gY29udGV4dC5zZXNzaW9uPy5vcmdJZCBhcyBzdHJpbmcgfCB1bmRlZmluZWQ7XG4gICAgICAgIGlmICghb3JnSWQpIHJldHVybiByZXNvbHZlZERhdGE7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgLi4ucmVzb2x2ZWREYXRhLFxuICAgICAgICAgIG9yZzogeyBjb25uZWN0OiB7IGlkOiBvcmdJZCB9IH1cbiAgICAgICAgfTtcbiAgICAgIH1cbiAgICB9LFxuICAgIHZhbGlkYXRlRGVsZXRlOiBhc3luYyAoeyBpdGVtLCBjb250ZXh0LCBhZGRWYWxpZGF0aW9uRXJyb3IgfSkgPT4ge1xuICAgICAgaWYgKCFpdGVtPy5pZCkgcmV0dXJuO1xuXG4gICAgICBjb25zdCBzdWRvQ29udGV4dCA9IGNvbnRleHQuc3VkbygpO1xuICAgICAgY29uc3QgcHJvamVjdElkID0gU3RyaW5nKGl0ZW0uaWQpO1xuXG4gICAgICBjb25zdCBwcm9qZWN0ID0gKGF3YWl0IHN1ZG9Db250ZXh0LnF1ZXJ5LlByb2plY3QuZmluZE9uZSh7XG4gICAgICAgIHdoZXJlOiB7IGlkOiBwcm9qZWN0SWQgfSxcbiAgICAgICAgcXVlcnk6ICdpZCBvcmcgeyBpZCB9J1xuICAgICAgfSkpIGFzIHsgb3JnOiB7IGlkOiBzdHJpbmcgfSB8IG51bGwgfSB8IG51bGw7XG5cbiAgICAgIGlmICghcHJvamVjdD8ub3JnPy5pZCkge1xuICAgICAgICBhZGRWYWxpZGF0aW9uRXJyb3IoJ1Byb2plY3QgaXMgbWlzc2luZyBvcmdhbml6YXRpb24gY29udGV4dC4nKTtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICBjb25zdCBbb3JnUHJvamVjdENvdW50LCB1c2VyQ291bnRdID0gYXdhaXQgUHJvbWlzZS5hbGwoW1xuICAgICAgICBzdWRvQ29udGV4dC5kYi5Qcm9qZWN0LmNvdW50KHsgd2hlcmU6IHsgb3JnOiB7IGlkOiB7IGVxdWFsczogcHJvamVjdC5vcmcuaWQgfSB9IH0gfSksXG4gICAgICAgIHN1ZG9Db250ZXh0LmRiLlVzZXIuY291bnQoeyB3aGVyZTogeyBwcm9qZWN0OiB7IGlkOiB7IGVxdWFsczogcHJvamVjdElkIH0gfSB9IH0pXG4gICAgICBdKTtcblxuICAgICAgaWYgKHVzZXJDb3VudCA+IDApIHtcbiAgICAgICAgYWRkVmFsaWRhdGlvbkVycm9yKCdZb3UgY2Fubm90IGRlbGV0ZSBhIHByb2plY3QgdGhhdCBzdGlsbCBoYXMgdXNlcnMuJyk7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgaWYgKG9yZ1Byb2plY3RDb3VudCA8PSAxKSB7XG4gICAgICAgIGFkZFZhbGlkYXRpb25FcnJvcignRWFjaCBvcmdhbml6YXRpb24gbXVzdCBoYXZlIGF0IGxlYXN0IG9uZSBwcm9qZWN0LicpO1xuICAgICAgfVxuICAgIH1cbiAgfVxufSkgc2F0aXNmaWVzIExpc3RzWydQcm9qZWN0J107XG4iXSwibmFtZXMiOlsibGlzdCIsInJlbGF0aW9uc2hpcCIsInRleHQiLCJjYW5FZGl0T3JnRGF0YSIsImNhbkVkaXRQcm9qZWN0RGF0YSIsImZpbHRlckJ5VXNlck9yZyIsImlzQXV0aGVudGljYXRlZCIsImlzR29kIiwiaXNPcmdBZG1pbiIsImlzUHJvamVjdEFkbWluIiwiZmllbGRzIiwibmFtZSIsInZhbGlkYXRpb24iLCJpc1JlcXVpcmVkIiwiZGVzY3JpcHRpb24iLCJ1aSIsImRpc3BsYXlNb2RlIiwib3JnIiwicmVmIiwibWFueSIsInVzZXJzIiwidHJhbnNjcmlwdHMiLCJjaGF0cyIsImxhYmVsRmllbGQiLCJhY2Nlc3MiLCJvcGVyYXRpb24iLCJxdWVyeSIsInNlc3Npb24iLCJjcmVhdGUiLCJ1cGRhdGUiLCJkZWxldGUiLCJpdGVtIiwiY29udGV4dCIsImlkIiwidGFyZ2V0UHJvamVjdElkIiwiU3RyaW5nIiwic3Vkb0NvbnRleHQiLCJzdWRvIiwicHJvamVjdCIsIlByb2plY3QiLCJmaW5kT25lIiwid2hlcmUiLCJvcmdJZCIsInByb2plY3RJZCIsImZpbHRlciIsImVxdWFscyIsImhvb2tzIiwicmVzb2x2ZUlucHV0IiwicmVzb2x2ZWREYXRhIiwiY29ubmVjdCIsInZhbGlkYXRlRGVsZXRlIiwiYWRkVmFsaWRhdGlvbkVycm9yIiwib3JnUHJvamVjdENvdW50IiwidXNlckNvdW50IiwiUHJvbWlzZSIsImFsbCIsImRiIiwiY291bnQiLCJVc2VyIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(api)/../../schemas/Project.ts\n");

/***/ }),

/***/ "(api)/../../schemas/Transcript.ts":
/*!***********************************!*\
  !*** ../../schemas/Transcript.ts ***!
  \***********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var _keystone_6_core__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @keystone-6/core */ \"@keystone-6/core\");\n/* harmony import */ var _keystone_6_core__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_keystone_6_core__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _keystone_6_core_fields__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @keystone-6/core/fields */ \"@keystone-6/core/fields\");\n/* harmony import */ var _keystone_6_core_fields__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(_keystone_6_core_fields__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var _domains_auth_userRole__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../domains/auth/userRole */ \"(api)/../../domains/auth/userRole.ts\");\n\n\n\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_keystone_6_core__WEBPACK_IMPORTED_MODULE_0__.list)({\n    fields: {\n        title: (0,_keystone_6_core_fields__WEBPACK_IMPORTED_MODULE_1__.text)({\n            validation: {\n                isRequired: true\n            }\n        }),\n        intervieweeName: (0,_keystone_6_core_fields__WEBPACK_IMPORTED_MODULE_1__.text)(),\n        sourceUrl: (0,_keystone_6_core_fields__WEBPACK_IMPORTED_MODULE_1__.text)({\n            ui: {\n                description: \"Optional source or recording URL\"\n            }\n        }),\n        language: (0,_keystone_6_core_fields__WEBPACK_IMPORTED_MODULE_1__.text)(),\n        notes: (0,_keystone_6_core_fields__WEBPACK_IMPORTED_MODULE_1__.text)({\n            ui: {\n                displayMode: \"textarea\"\n            }\n        }),\n        project: (0,_keystone_6_core_fields__WEBPACK_IMPORTED_MODULE_1__.relationship)({\n            ref: \"Project.transcripts\",\n            many: false\n        }),\n        org: (0,_keystone_6_core_fields__WEBPACK_IMPORTED_MODULE_1__.relationship)({\n            ref: \"Organization.transcripts\",\n            many: false\n        }),\n        segments: (0,_keystone_6_core_fields__WEBPACK_IMPORTED_MODULE_1__.relationship)({\n            ref: \"TranscriptSegment.transcript\",\n            many: true\n        }),\n        chats: (0,_keystone_6_core_fields__WEBPACK_IMPORTED_MODULE_1__.relationship)({\n            ref: \"Chat.transcript\",\n            many: true\n        }),\n        createdAt: (0,_keystone_6_core_fields__WEBPACK_IMPORTED_MODULE_1__.timestamp)({\n            defaultValue: {\n                kind: \"now\"\n            },\n            ui: {\n                createView: {\n                    fieldMode: \"hidden\"\n                }\n            }\n        }),\n        updatedAt: (0,_keystone_6_core_fields__WEBPACK_IMPORTED_MODULE_1__.timestamp)({\n            db: {\n                updatedAt: true\n            },\n            ui: {\n                createView: {\n                    fieldMode: \"hidden\"\n                }\n            }\n        })\n    },\n    ui: {\n        labelField: \"title\"\n    },\n    access: {\n        operation: {\n            query: ({ session })=>(0,_domains_auth_userRole__WEBPACK_IMPORTED_MODULE_2__.isAuthenticated)({\n                    session\n                }),\n            create: _domains_auth_userRole__WEBPACK_IMPORTED_MODULE_2__.canEditProjectData,\n            update: _domains_auth_userRole__WEBPACK_IMPORTED_MODULE_2__.canEditProjectData,\n            delete: _domains_auth_userRole__WEBPACK_IMPORTED_MODULE_2__.canEditOrgData\n        },\n        filter: {\n            query: async ({ session })=>{\n                if (!(0,_domains_auth_userRole__WEBPACK_IMPORTED_MODULE_2__.isAuthenticated)({\n                    session\n                })) return false;\n                if ((0,_domains_auth_userRole__WEBPACK_IMPORTED_MODULE_2__.isGod)({\n                    session\n                })) return true;\n                return (0,_domains_auth_userRole__WEBPACK_IMPORTED_MODULE_2__.filterByUserOrg)({\n                    session\n                });\n            }\n        },\n        item: {\n            update: async ({ session, item, context })=>{\n                if ((0,_domains_auth_userRole__WEBPACK_IMPORTED_MODULE_2__.isGod)({\n                    session\n                })) return true;\n                if (!item?.id) return false;\n                const sudoContext = context.sudo();\n                const stored = await sudoContext.query.Transcript.findOne({\n                    where: {\n                        id: String(item.id)\n                    },\n                    query: \"id project { id org { id } }\"\n                });\n                if (!stored?.project?.id || !stored.project.org?.id) return false;\n                if ((0,_domains_auth_userRole__WEBPACK_IMPORTED_MODULE_2__.isOrgAdmin)({\n                    session\n                })) {\n                    return stored.project.org.id === session.orgId;\n                }\n                if ((0,_domains_auth_userRole__WEBPACK_IMPORTED_MODULE_2__.isProjectAdmin)({\n                    session\n                })) {\n                    return stored.project.id === session.projectId && stored.project.org.id === session.orgId;\n                }\n                return false;\n            },\n            delete: async ({ session, item, context })=>{\n                if ((0,_domains_auth_userRole__WEBPACK_IMPORTED_MODULE_2__.isGod)({\n                    session\n                })) return true;\n                if (!(0,_domains_auth_userRole__WEBPACK_IMPORTED_MODULE_2__.isOrgAdmin)({\n                    session\n                })) return false;\n                if (!session?.orgId || !item?.id) return false;\n                const sudoContext = context.sudo();\n                const stored = await sudoContext.query.Transcript.findOne({\n                    where: {\n                        id: String(item.id)\n                    },\n                    query: \"project { org { id } }\"\n                });\n                return stored?.project?.org?.id === session.orgId;\n            }\n        }\n    },\n    hooks: {\n        resolveInput: {\n            create: async ({ resolvedData, context })=>{\n                if (resolvedData.org) return resolvedData;\n                const orgId = context.session?.orgId;\n                if (!orgId) return resolvedData;\n                return {\n                    ...resolvedData,\n                    org: {\n                        connect: {\n                            id: orgId\n                        }\n                    }\n                };\n            }\n        }\n    }\n}));\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi4vLi4vc2NoZW1hcy9UcmFuc2NyaXB0LnRzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7OztBQUN3QztBQUNnQztBQVN0QztBQUVsQyxpRUFBZUEsc0RBQUlBLENBQUM7SUFDbEJXLFFBQVE7UUFDTkMsT0FBT1YsNkRBQUlBLENBQUM7WUFBRVcsWUFBWTtnQkFBRUMsWUFBWTtZQUFLO1FBQUU7UUFDL0NDLGlCQUFpQmIsNkRBQUlBO1FBQ3JCYyxXQUFXZCw2REFBSUEsQ0FBQztZQUFFZSxJQUFJO2dCQUFFQyxhQUFhO1lBQW1DO1FBQUU7UUFDMUVDLFVBQVVqQiw2REFBSUE7UUFDZGtCLE9BQU9sQiw2REFBSUEsQ0FBQztZQUFFZSxJQUFJO2dCQUFFSSxhQUFhO1lBQVc7UUFBRTtRQUM5Q0MsU0FBU3JCLHFFQUFZQSxDQUFDO1lBQUVzQixLQUFLO1lBQXVCQyxNQUFNO1FBQU07UUFDaEVDLEtBQUt4QixxRUFBWUEsQ0FBQztZQUFFc0IsS0FBSztZQUE0QkMsTUFBTTtRQUFNO1FBQ2pFRSxVQUFVekIscUVBQVlBLENBQUM7WUFBRXNCLEtBQUs7WUFBZ0NDLE1BQU07UUFBSztRQUN6RUcsT0FBTzFCLHFFQUFZQSxDQUFDO1lBQUVzQixLQUFLO1lBQW1CQyxNQUFNO1FBQUs7UUFDekRJLFdBQVd6QixrRUFBU0EsQ0FBQztZQUFFMEIsY0FBYztnQkFBRUMsTUFBTTtZQUFNO1lBQUdiLElBQUk7Z0JBQUVjLFlBQVk7b0JBQUVDLFdBQVc7Z0JBQVM7WUFBRTtRQUFFO1FBQ2xHQyxXQUFXOUIsa0VBQVNBLENBQUM7WUFBRStCLElBQUk7Z0JBQUVELFdBQVc7WUFBSztZQUFHaEIsSUFBSTtnQkFBRWMsWUFBWTtvQkFBRUMsV0FBVztnQkFBUztZQUFFO1FBQUU7SUFDOUY7SUFDQWYsSUFBSTtRQUNGa0IsWUFBWTtJQUNkO0lBQ0FDLFFBQVE7UUFDTkMsV0FBVztZQUNUQyxPQUFPLENBQUMsRUFBRUMsT0FBTyxFQUFFLEdBQUtoQyx1RUFBZUEsQ0FBQztvQkFBRWdDO2dCQUFRO1lBQ2xEQyxRQUFRbkMsc0VBQWtCQTtZQUMxQm9DLFFBQVFwQyxzRUFBa0JBO1lBQzFCcUMsUUFBUXRDLGtFQUFjQTtRQUN4QjtRQUNBdUMsUUFBUTtZQUNOTCxPQUFPLE9BQU8sRUFBRUMsT0FBTyxFQUFFO2dCQUN2QixJQUFJLENBQUNoQyx1RUFBZUEsQ0FBQztvQkFBRWdDO2dCQUFRLElBQUksT0FBTztnQkFDMUMsSUFBSS9CLDZEQUFLQSxDQUFDO29CQUFFK0I7Z0JBQVEsSUFBSSxPQUFPO2dCQUMvQixPQUFPakMsdUVBQWVBLENBQUM7b0JBQUVpQztnQkFBUTtZQUNuQztRQUNGO1FBQ0FLLE1BQU07WUFDSkgsUUFBUSxPQUFPLEVBQUVGLE9BQU8sRUFBRUssSUFBSSxFQUFFQyxPQUFPLEVBQUU7Z0JBQ3ZDLElBQUlyQyw2REFBS0EsQ0FBQztvQkFBRStCO2dCQUFRLElBQUksT0FBTztnQkFDL0IsSUFBSSxDQUFDSyxNQUFNRSxJQUFJLE9BQU87Z0JBRXRCLE1BQU1DLGNBQWNGLFFBQVFHLElBQUk7Z0JBQ2hDLE1BQU1DLFNBQVUsTUFBTUYsWUFBWVQsS0FBSyxDQUFDWSxVQUFVLENBQUNDLE9BQU8sQ0FBQztvQkFDekRDLE9BQU87d0JBQUVOLElBQUlPLE9BQU9ULEtBQUtFLEVBQUU7b0JBQUU7b0JBQzdCUixPQUFPO2dCQUNUO2dCQUNBLElBQUksQ0FBQ1csUUFBUTNCLFNBQVN3QixNQUFNLENBQUNHLE9BQU8zQixPQUFPLENBQUNHLEdBQUcsRUFBRXFCLElBQUksT0FBTztnQkFFNUQsSUFBSXJDLGtFQUFVQSxDQUFDO29CQUFFOEI7Z0JBQVEsSUFBSTtvQkFDM0IsT0FBT1UsT0FBTzNCLE9BQU8sQ0FBQ0csR0FBRyxDQUFDcUIsRUFBRSxLQUFLUCxRQUFRZSxLQUFLO2dCQUNoRDtnQkFFQSxJQUFJNUMsc0VBQWNBLENBQUM7b0JBQUU2QjtnQkFBUSxJQUFJO29CQUMvQixPQUFPVSxPQUFPM0IsT0FBTyxDQUFDd0IsRUFBRSxLQUFLUCxRQUFRZ0IsU0FBUyxJQUFJTixPQUFPM0IsT0FBTyxDQUFDRyxHQUFHLENBQUNxQixFQUFFLEtBQUtQLFFBQVFlLEtBQUs7Z0JBQzNGO2dCQUVBLE9BQU87WUFDVDtZQUNBWixRQUFRLE9BQU8sRUFBRUgsT0FBTyxFQUFFSyxJQUFJLEVBQUVDLE9BQU8sRUFBRTtnQkFDdkMsSUFBSXJDLDZEQUFLQSxDQUFDO29CQUFFK0I7Z0JBQVEsSUFBSSxPQUFPO2dCQUMvQixJQUFJLENBQUM5QixrRUFBVUEsQ0FBQztvQkFBRThCO2dCQUFRLElBQUksT0FBTztnQkFDckMsSUFBSSxDQUFDQSxTQUFTZSxTQUFTLENBQUNWLE1BQU1FLElBQUksT0FBTztnQkFFekMsTUFBTUMsY0FBY0YsUUFBUUcsSUFBSTtnQkFDaEMsTUFBTUMsU0FBVSxNQUFNRixZQUFZVCxLQUFLLENBQUNZLFVBQVUsQ0FBQ0MsT0FBTyxDQUFDO29CQUN6REMsT0FBTzt3QkFBRU4sSUFBSU8sT0FBT1QsS0FBS0UsRUFBRTtvQkFBRTtvQkFDN0JSLE9BQU87Z0JBQ1Q7Z0JBQ0EsT0FBT1csUUFBUTNCLFNBQVNHLEtBQUtxQixPQUFPUCxRQUFRZSxLQUFLO1lBQ25EO1FBQ0Y7SUFDRjtJQUNBRSxPQUFPO1FBQ0xDLGNBQWM7WUFDWmpCLFFBQVEsT0FBTyxFQUFFa0IsWUFBWSxFQUFFYixPQUFPLEVBQUU7Z0JBQ3RDLElBQUlhLGFBQWFqQyxHQUFHLEVBQUUsT0FBT2lDO2dCQUM3QixNQUFNSixRQUFRVCxRQUFRTixPQUFPLEVBQUVlO2dCQUMvQixJQUFJLENBQUNBLE9BQU8sT0FBT0k7Z0JBQ25CLE9BQU87b0JBQ0wsR0FBR0EsWUFBWTtvQkFDZmpDLEtBQUs7d0JBQUVrQyxTQUFTOzRCQUFFYixJQUFJUTt3QkFBTTtvQkFBRTtnQkFDaEM7WUFDRjtRQUNGO0lBQ0Y7QUFDRixFQUFFLEVBQStCIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLy4uLy4uL3NjaGVtYXMvVHJhbnNjcmlwdC50cz9lYWY5Il0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IHR5cGUgTGlzdHMgfSBmcm9tICcua2V5c3RvbmUvdHlwZXMnO1xuaW1wb3J0IHsgbGlzdCB9IGZyb20gJ0BrZXlzdG9uZS02L2NvcmUnO1xuaW1wb3J0IHsgcmVsYXRpb25zaGlwLCB0ZXh0LCB0aW1lc3RhbXAgfSBmcm9tICdAa2V5c3RvbmUtNi9jb3JlL2ZpZWxkcyc7XG5pbXBvcnQge1xuICBjYW5FZGl0T3JnRGF0YSxcbiAgY2FuRWRpdFByb2plY3REYXRhLFxuICBmaWx0ZXJCeVVzZXJPcmcsXG4gIGlzQXV0aGVudGljYXRlZCxcbiAgaXNHb2QsXG4gIGlzT3JnQWRtaW4sXG4gIGlzUHJvamVjdEFkbWluXG59IGZyb20gJy4uL2RvbWFpbnMvYXV0aC91c2VyUm9sZSc7XG5cbmV4cG9ydCBkZWZhdWx0IGxpc3Qoe1xuICBmaWVsZHM6IHtcbiAgICB0aXRsZTogdGV4dCh7IHZhbGlkYXRpb246IHsgaXNSZXF1aXJlZDogdHJ1ZSB9IH0pLFxuICAgIGludGVydmlld2VlTmFtZTogdGV4dCgpLFxuICAgIHNvdXJjZVVybDogdGV4dCh7IHVpOiB7IGRlc2NyaXB0aW9uOiAnT3B0aW9uYWwgc291cmNlIG9yIHJlY29yZGluZyBVUkwnIH0gfSksXG4gICAgbGFuZ3VhZ2U6IHRleHQoKSxcbiAgICBub3RlczogdGV4dCh7IHVpOiB7IGRpc3BsYXlNb2RlOiAndGV4dGFyZWEnIH0gfSksXG4gICAgcHJvamVjdDogcmVsYXRpb25zaGlwKHsgcmVmOiAnUHJvamVjdC50cmFuc2NyaXB0cycsIG1hbnk6IGZhbHNlIH0pLFxuICAgIG9yZzogcmVsYXRpb25zaGlwKHsgcmVmOiAnT3JnYW5pemF0aW9uLnRyYW5zY3JpcHRzJywgbWFueTogZmFsc2UgfSksXG4gICAgc2VnbWVudHM6IHJlbGF0aW9uc2hpcCh7IHJlZjogJ1RyYW5zY3JpcHRTZWdtZW50LnRyYW5zY3JpcHQnLCBtYW55OiB0cnVlIH0pLFxuICAgIGNoYXRzOiByZWxhdGlvbnNoaXAoeyByZWY6ICdDaGF0LnRyYW5zY3JpcHQnLCBtYW55OiB0cnVlIH0pLFxuICAgIGNyZWF0ZWRBdDogdGltZXN0YW1wKHsgZGVmYXVsdFZhbHVlOiB7IGtpbmQ6ICdub3cnIH0sIHVpOiB7IGNyZWF0ZVZpZXc6IHsgZmllbGRNb2RlOiAnaGlkZGVuJyB9IH0gfSksXG4gICAgdXBkYXRlZEF0OiB0aW1lc3RhbXAoeyBkYjogeyB1cGRhdGVkQXQ6IHRydWUgfSwgdWk6IHsgY3JlYXRlVmlldzogeyBmaWVsZE1vZGU6ICdoaWRkZW4nIH0gfSB9KVxuICB9LFxuICB1aToge1xuICAgIGxhYmVsRmllbGQ6ICd0aXRsZSdcbiAgfSxcbiAgYWNjZXNzOiB7XG4gICAgb3BlcmF0aW9uOiB7XG4gICAgICBxdWVyeTogKHsgc2Vzc2lvbiB9KSA9PiBpc0F1dGhlbnRpY2F0ZWQoeyBzZXNzaW9uIH0pLFxuICAgICAgY3JlYXRlOiBjYW5FZGl0UHJvamVjdERhdGEsXG4gICAgICB1cGRhdGU6IGNhbkVkaXRQcm9qZWN0RGF0YSxcbiAgICAgIGRlbGV0ZTogY2FuRWRpdE9yZ0RhdGFcbiAgICB9LFxuICAgIGZpbHRlcjoge1xuICAgICAgcXVlcnk6IGFzeW5jICh7IHNlc3Npb24gfSkgPT4ge1xuICAgICAgICBpZiAoIWlzQXV0aGVudGljYXRlZCh7IHNlc3Npb24gfSkpIHJldHVybiBmYWxzZTtcbiAgICAgICAgaWYgKGlzR29kKHsgc2Vzc2lvbiB9KSkgcmV0dXJuIHRydWU7XG4gICAgICAgIHJldHVybiBmaWx0ZXJCeVVzZXJPcmcoeyBzZXNzaW9uIH0pO1xuICAgICAgfVxuICAgIH0sXG4gICAgaXRlbToge1xuICAgICAgdXBkYXRlOiBhc3luYyAoeyBzZXNzaW9uLCBpdGVtLCBjb250ZXh0IH0pID0+IHtcbiAgICAgICAgaWYgKGlzR29kKHsgc2Vzc2lvbiB9KSkgcmV0dXJuIHRydWU7XG4gICAgICAgIGlmICghaXRlbT8uaWQpIHJldHVybiBmYWxzZTtcblxuICAgICAgICBjb25zdCBzdWRvQ29udGV4dCA9IGNvbnRleHQuc3VkbygpO1xuICAgICAgICBjb25zdCBzdG9yZWQgPSAoYXdhaXQgc3Vkb0NvbnRleHQucXVlcnkuVHJhbnNjcmlwdC5maW5kT25lKHtcbiAgICAgICAgICB3aGVyZTogeyBpZDogU3RyaW5nKGl0ZW0uaWQpIH0sXG4gICAgICAgICAgcXVlcnk6ICdpZCBwcm9qZWN0IHsgaWQgb3JnIHsgaWQgfSB9J1xuICAgICAgICB9KSkgYXMgeyBwcm9qZWN0PzogeyBpZDogc3RyaW5nOyBvcmc/OiB7IGlkOiBzdHJpbmcgfSB8IG51bGwgfSB8IG51bGwgfSB8IG51bGw7XG4gICAgICAgIGlmICghc3RvcmVkPy5wcm9qZWN0Py5pZCB8fCAhc3RvcmVkLnByb2plY3Qub3JnPy5pZCkgcmV0dXJuIGZhbHNlO1xuXG4gICAgICAgIGlmIChpc09yZ0FkbWluKHsgc2Vzc2lvbiB9KSkge1xuICAgICAgICAgIHJldHVybiBzdG9yZWQucHJvamVjdC5vcmcuaWQgPT09IHNlc3Npb24ub3JnSWQ7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoaXNQcm9qZWN0QWRtaW4oeyBzZXNzaW9uIH0pKSB7XG4gICAgICAgICAgcmV0dXJuIHN0b3JlZC5wcm9qZWN0LmlkID09PSBzZXNzaW9uLnByb2plY3RJZCAmJiBzdG9yZWQucHJvamVjdC5vcmcuaWQgPT09IHNlc3Npb24ub3JnSWQ7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICB9LFxuICAgICAgZGVsZXRlOiBhc3luYyAoeyBzZXNzaW9uLCBpdGVtLCBjb250ZXh0IH0pID0+IHtcbiAgICAgICAgaWYgKGlzR29kKHsgc2Vzc2lvbiB9KSkgcmV0dXJuIHRydWU7XG4gICAgICAgIGlmICghaXNPcmdBZG1pbih7IHNlc3Npb24gfSkpIHJldHVybiBmYWxzZTtcbiAgICAgICAgaWYgKCFzZXNzaW9uPy5vcmdJZCB8fCAhaXRlbT8uaWQpIHJldHVybiBmYWxzZTtcblxuICAgICAgICBjb25zdCBzdWRvQ29udGV4dCA9IGNvbnRleHQuc3VkbygpO1xuICAgICAgICBjb25zdCBzdG9yZWQgPSAoYXdhaXQgc3Vkb0NvbnRleHQucXVlcnkuVHJhbnNjcmlwdC5maW5kT25lKHtcbiAgICAgICAgICB3aGVyZTogeyBpZDogU3RyaW5nKGl0ZW0uaWQpIH0sXG4gICAgICAgICAgcXVlcnk6ICdwcm9qZWN0IHsgb3JnIHsgaWQgfSB9J1xuICAgICAgICB9KSkgYXMgeyBwcm9qZWN0PzogeyBvcmc/OiB7IGlkOiBzdHJpbmcgfSB8IG51bGwgfSB8IG51bGwgfSB8IG51bGw7XG4gICAgICAgIHJldHVybiBzdG9yZWQ/LnByb2plY3Q/Lm9yZz8uaWQgPT09IHNlc3Npb24ub3JnSWQ7XG4gICAgICB9XG4gICAgfVxuICB9LFxuICBob29rczoge1xuICAgIHJlc29sdmVJbnB1dDoge1xuICAgICAgY3JlYXRlOiBhc3luYyAoeyByZXNvbHZlZERhdGEsIGNvbnRleHQgfSkgPT4ge1xuICAgICAgICBpZiAocmVzb2x2ZWREYXRhLm9yZykgcmV0dXJuIHJlc29sdmVkRGF0YTtcbiAgICAgICAgY29uc3Qgb3JnSWQgPSBjb250ZXh0LnNlc3Npb24/Lm9yZ0lkIGFzIHN0cmluZyB8IHVuZGVmaW5lZDtcbiAgICAgICAgaWYgKCFvcmdJZCkgcmV0dXJuIHJlc29sdmVkRGF0YTtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAuLi5yZXNvbHZlZERhdGEsXG4gICAgICAgICAgb3JnOiB7IGNvbm5lY3Q6IHsgaWQ6IG9yZ0lkIH0gfVxuICAgICAgICB9O1xuICAgICAgfVxuICAgIH1cbiAgfVxufSkgc2F0aXNmaWVzIExpc3RzWydUcmFuc2NyaXB0J107XG5cbiJdLCJuYW1lcyI6WyJsaXN0IiwicmVsYXRpb25zaGlwIiwidGV4dCIsInRpbWVzdGFtcCIsImNhbkVkaXRPcmdEYXRhIiwiY2FuRWRpdFByb2plY3REYXRhIiwiZmlsdGVyQnlVc2VyT3JnIiwiaXNBdXRoZW50aWNhdGVkIiwiaXNHb2QiLCJpc09yZ0FkbWluIiwiaXNQcm9qZWN0QWRtaW4iLCJmaWVsZHMiLCJ0aXRsZSIsInZhbGlkYXRpb24iLCJpc1JlcXVpcmVkIiwiaW50ZXJ2aWV3ZWVOYW1lIiwic291cmNlVXJsIiwidWkiLCJkZXNjcmlwdGlvbiIsImxhbmd1YWdlIiwibm90ZXMiLCJkaXNwbGF5TW9kZSIsInByb2plY3QiLCJyZWYiLCJtYW55Iiwib3JnIiwic2VnbWVudHMiLCJjaGF0cyIsImNyZWF0ZWRBdCIsImRlZmF1bHRWYWx1ZSIsImtpbmQiLCJjcmVhdGVWaWV3IiwiZmllbGRNb2RlIiwidXBkYXRlZEF0IiwiZGIiLCJsYWJlbEZpZWxkIiwiYWNjZXNzIiwib3BlcmF0aW9uIiwicXVlcnkiLCJzZXNzaW9uIiwiY3JlYXRlIiwidXBkYXRlIiwiZGVsZXRlIiwiZmlsdGVyIiwiaXRlbSIsImNvbnRleHQiLCJpZCIsInN1ZG9Db250ZXh0Iiwic3VkbyIsInN0b3JlZCIsIlRyYW5zY3JpcHQiLCJmaW5kT25lIiwid2hlcmUiLCJTdHJpbmciLCJvcmdJZCIsInByb2plY3RJZCIsImhvb2tzIiwicmVzb2x2ZUlucHV0IiwicmVzb2x2ZWREYXRhIiwiY29ubmVjdCJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(api)/../../schemas/Transcript.ts\n");

/***/ }),

/***/ "(api)/../../schemas/TranscriptSegment.ts":
/*!******************************************!*\
  !*** ../../schemas/TranscriptSegment.ts ***!
  \******************************************/
/***/ ((module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.a(module, async (__webpack_handle_async_dependencies__, __webpack_async_result__) => { try {\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var _keystone_6_core__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @keystone-6/core */ \"@keystone-6/core\");\n/* harmony import */ var _keystone_6_core__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_keystone_6_core__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _keystone_6_core_fields__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @keystone-6/core/fields */ \"@keystone-6/core/fields\");\n/* harmony import */ var _keystone_6_core_fields__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(_keystone_6_core_fields__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var _prisma_client__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @prisma/client */ \"@prisma/client\");\n/* harmony import */ var _prisma_client__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(_prisma_client__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var _domains_auth_userRole__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../domains/auth/userRole */ \"(api)/../../domains/auth/userRole.ts\");\n/* harmony import */ var _lib_openai__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../lib/openai */ \"(api)/../../lib/openai.ts\");\n/* harmony import */ var _lib_pgvector__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../lib/pgvector */ \"(api)/../../lib/pgvector.ts\");\nvar __webpack_async_dependencies__ = __webpack_handle_async_dependencies__([_lib_openai__WEBPACK_IMPORTED_MODULE_4__]);\n_lib_openai__WEBPACK_IMPORTED_MODULE_4__ = (__webpack_async_dependencies__.then ? (await __webpack_async_dependencies__)() : __webpack_async_dependencies__)[0];\n\n\n\n\n\n\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_keystone_6_core__WEBPACK_IMPORTED_MODULE_0__.list)({\n    fields: {\n        transcript: (0,_keystone_6_core_fields__WEBPACK_IMPORTED_MODULE_1__.relationship)({\n            ref: \"Transcript.segments\",\n            many: false\n        }),\n        index: (0,_keystone_6_core_fields__WEBPACK_IMPORTED_MODULE_1__.integer)(),\n        startMs: (0,_keystone_6_core_fields__WEBPACK_IMPORTED_MODULE_1__.integer)(),\n        endMs: (0,_keystone_6_core_fields__WEBPACK_IMPORTED_MODULE_1__.integer)(),\n        durationMs: (0,_keystone_6_core_fields__WEBPACK_IMPORTED_MODULE_1__.integer)(),\n        text: (0,_keystone_6_core_fields__WEBPACK_IMPORTED_MODULE_1__.text)({\n            ui: {\n                displayMode: \"textarea\"\n            }\n        }),\n        speaker: (0,_keystone_6_core_fields__WEBPACK_IMPORTED_MODULE_1__.text)(),\n        isMetadata: (0,_keystone_6_core_fields__WEBPACK_IMPORTED_MODULE_1__.checkbox)({\n            defaultValue: false\n        }),\n        chatMessages: (0,_keystone_6_core_fields__WEBPACK_IMPORTED_MODULE_1__.relationship)({\n            ref: \"ChatMessage.segments\",\n            many: true\n        })\n    },\n    db: {\n        extendPrismaSchema: (schema)=>{\n            const schemaArray = schema.split(\"\\n\");\n            const additions = [\n                '  embedding Unsupported(\"vector(1536)\")?',\n                '  @@index([embedding], map: \"TranscriptSegment_embedding_idx\")'\n            ];\n            return [\n                ...schemaArray.slice(0, -1),\n                ...additions,\n                schemaArray.pop()\n            ].join(\"\\n\");\n        }\n    },\n    access: {\n        operation: {\n            query: ({ session })=>(0,_domains_auth_userRole__WEBPACK_IMPORTED_MODULE_3__.isAuthenticated)({\n                    session\n                }),\n            create: _domains_auth_userRole__WEBPACK_IMPORTED_MODULE_3__.canEditProjectData,\n            update: _domains_auth_userRole__WEBPACK_IMPORTED_MODULE_3__.canEditProjectData,\n            delete: _domains_auth_userRole__WEBPACK_IMPORTED_MODULE_3__.canEditProjectData\n        },\n        filter: {\n            query: async ({ session })=>{\n                if (!(0,_domains_auth_userRole__WEBPACK_IMPORTED_MODULE_3__.isAuthenticated)({\n                    session\n                })) return false;\n                if ((0,_domains_auth_userRole__WEBPACK_IMPORTED_MODULE_3__.isGod)({\n                    session\n                })) return true;\n                if (!session?.orgId) return false;\n                // Org-level visibility\n                const orgFilter = {\n                    transcript: {\n                        project: {\n                            org: {\n                                id: {\n                                    equals: session.orgId\n                                }\n                            }\n                        }\n                    }\n                };\n                // Project-scoped visibility (for project admins with a projectId)\n                if (session.projectId) {\n                    return {\n                        OR: [\n                            orgFilter,\n                            {\n                                transcript: {\n                                    project: {\n                                        id: {\n                                            equals: session.projectId\n                                        }\n                                    }\n                                }\n                            }\n                        ]\n                    };\n                }\n                return orgFilter;\n            }\n        },\n        item: {\n            update: async ({ session, item, context })=>{\n                if ((0,_domains_auth_userRole__WEBPACK_IMPORTED_MODULE_3__.isGod)({\n                    session\n                })) return true;\n                if (!item?.id) return false;\n                const sudoContext = context.sudo();\n                const record = await sudoContext.query.TranscriptSegment.findOne({\n                    where: {\n                        id: String(item.id)\n                    },\n                    query: \"transcript { project { org { id } } }\"\n                });\n                if (!record?.transcript?.project?.org?.id) return false;\n                return record.transcript.project.org.id === session.orgId;\n            },\n            delete: async ({ session, item, context })=>{\n                if ((0,_domains_auth_userRole__WEBPACK_IMPORTED_MODULE_3__.isGod)({\n                    session\n                })) return true;\n                if (!(0,_domains_auth_userRole__WEBPACK_IMPORTED_MODULE_3__.isOrgAdmin)({\n                    session\n                })) return false;\n                if (!item?.id) return false;\n                const sudoContext = context.sudo();\n                const record = await sudoContext.query.TranscriptSegment.findOne({\n                    where: {\n                        id: String(item.id)\n                    },\n                    query: \"transcript { project { org { id } } }\"\n                });\n                return record?.transcript?.project?.org?.id === session.orgId;\n            }\n        }\n    },\n    hooks: {\n        afterOperation: async ({ operation, item, resolvedData, context })=>{\n            const shouldEmbed = operation === \"create\" || operation === \"update\" && resolvedData?.text !== undefined;\n            if (!shouldEmbed) return;\n            if (!item?.id || !item?.text) return;\n            try {\n                const embedding = (0,_lib_pgvector__WEBPACK_IMPORTED_MODULE_5__.formatVectorLiteral)((await (0,_lib_openai__WEBPACK_IMPORTED_MODULE_4__.createEmbeddings)([\n                    item.text\n                ]))[0]);\n                if (!embedding) return;\n                await context.sudo().prisma.$executeRaw`\n          UPDATE \"TranscriptSegment\" SET \"embedding\" = ${_prisma_client__WEBPACK_IMPORTED_MODULE_2__.Prisma.raw(embedding)} WHERE id = ${item.id}\n        `;\n            } catch (error) {\n                console.error(\"Failed to generate embedding for TranscriptSegment\", error);\n            }\n        }\n    }\n}));\n\n__webpack_async_result__();\n} catch(e) { __webpack_async_result__(e); } });//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi4vLi4vc2NoZW1hcy9UcmFuc2NyaXB0U2VnbWVudC50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7O0FBQ3dDO0FBQ3dDO0FBQ3hDO0FBQzBEO0FBQ2pEO0FBQ0s7QUFFdEQsaUVBQWVBLHNEQUFJQSxDQUFDO0lBQ2xCWSxRQUFRO1FBQ05DLFlBQVlWLHFFQUFZQSxDQUFDO1lBQUVXLEtBQUs7WUFBdUJDLE1BQU07UUFBTTtRQUNuRUMsT0FBT2QsZ0VBQU9BO1FBQ2RlLFNBQVNmLGdFQUFPQTtRQUNoQmdCLE9BQU9oQixnRUFBT0E7UUFDZGlCLFlBQVlqQixnRUFBT0E7UUFDbkJFLE1BQU1BLDZEQUFJQSxDQUFDO1lBQUVnQixJQUFJO2dCQUFFQyxhQUFhO1lBQVc7UUFBRTtRQUM3Q0MsU0FBU2xCLDZEQUFJQTtRQUNibUIsWUFBWXRCLGlFQUFRQSxDQUFDO1lBQUV1QixjQUFjO1FBQU07UUFDM0NDLGNBQWN0QixxRUFBWUEsQ0FBQztZQUFFVyxLQUFLO1lBQXdCQyxNQUFNO1FBQUs7SUFDdkU7SUFDQVcsSUFBSTtRQUNGQyxvQkFBb0JDLENBQUFBO1lBQ2xCLE1BQU1DLGNBQWNELE9BQU9FLEtBQUssQ0FBQztZQUNqQyxNQUFNQyxZQUFZO2dCQUNoQjtnQkFDQTthQUNEO1lBQ0QsT0FBTzttQkFBSUYsWUFBWUcsS0FBSyxDQUFDLEdBQUcsQ0FBQzttQkFBT0Q7Z0JBQVdGLFlBQVlJLEdBQUc7YUFBRyxDQUFDQyxJQUFJLENBQUM7UUFDN0U7SUFDRjtJQUNBQyxRQUFRO1FBQ05DLFdBQVc7WUFDVEMsT0FBTyxDQUFDLEVBQUVDLE9BQU8sRUFBRSxHQUFLL0IsdUVBQWVBLENBQUM7b0JBQUUrQjtnQkFBUTtZQUNsREMsUUFBUWpDLHNFQUFrQkE7WUFDMUJrQyxRQUFRbEMsc0VBQWtCQTtZQUMxQm1DLFFBQVFuQyxzRUFBa0JBO1FBQzVCO1FBQ0FvQyxRQUFRO1lBQ05MLE9BQU8sT0FBTyxFQUFFQyxPQUFPLEVBQUU7Z0JBQ3ZCLElBQUksQ0FB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QUFDO1FBQzdGLENBQUM7WUFDSCxFQUFFLE9BQU9zQixPQUFPO2dCQUNkQyxRQUFRRCxLQUFLLENBQUMsc0RBQXNEQTtZQUN0RTtRQUNGO0lBQ0Y7QUFDRixFQUFFLEVBQXNDIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLy4uLy4uL3NjaGVtYXMvVHJhbnNjcmlwdFNlZ21lbnQudHM/ZjY1OSJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyB0eXBlIExpc3RzIH0gZnJvbSAnLmtleXN0b25lL3R5cGVzJztcbmltcG9ydCB7IGxpc3QgfSBmcm9tICdAa2V5c3RvbmUtNi9jb3JlJztcbmltcG9ydCB7IGNoZWNrYm94LCBpbnRlZ2VyLCByZWxhdGlvbnNoaXAsIHRleHQgfSBmcm9tICdAa2V5c3RvbmUtNi9jb3JlL2ZpZWxkcyc7XG5pbXBvcnQgeyBQcmlzbWEgfSBmcm9tICdAcHJpc21hL2NsaWVudCc7XG5pbXBvcnQgeyBjYW5FZGl0UHJvamVjdERhdGEsIGlzQXV0aGVudGljYXRlZCwgaXNHb2QsIGlzT3JnQWRtaW4gfSBmcm9tICcuLi9kb21haW5zL2F1dGgvdXNlclJvbGUnO1xuaW1wb3J0IHsgY3JlYXRlRW1iZWRkaW5ncyB9IGZyb20gJy4uL2xpYi9vcGVuYWknO1xuaW1wb3J0IHsgZm9ybWF0VmVjdG9yTGl0ZXJhbCB9IGZyb20gJy4uL2xpYi9wZ3ZlY3Rvcic7XG5cbmV4cG9ydCBkZWZhdWx0IGxpc3Qoe1xuICBmaWVsZHM6IHtcbiAgICB0cmFuc2NyaXB0OiByZWxhdGlvbnNoaXAoeyByZWY6ICdUcmFuc2NyaXB0LnNlZ21lbnRzJywgbWFueTogZmFsc2UgfSksXG4gICAgaW5kZXg6IGludGVnZXIoKSxcbiAgICBzdGFydE1zOiBpbnRlZ2VyKCksXG4gICAgZW5kTXM6IGludGVnZXIoKSxcbiAgICBkdXJhdGlvbk1zOiBpbnRlZ2VyKCksXG4gICAgdGV4dDogdGV4dCh7IHVpOiB7IGRpc3BsYXlNb2RlOiAndGV4dGFyZWEnIH0gfSksXG4gICAgc3BlYWtlcjogdGV4dCgpLFxuICAgIGlzTWV0YWRhdGE6IGNoZWNrYm94KHsgZGVmYXVsdFZhbHVlOiBmYWxzZSB9KSxcbiAgICBjaGF0TWVzc2FnZXM6IHJlbGF0aW9uc2hpcCh7IHJlZjogJ0NoYXRNZXNzYWdlLnNlZ21lbnRzJywgbWFueTogdHJ1ZSB9KVxuICB9LFxuICBkYjoge1xuICAgIGV4dGVuZFByaXNtYVNjaGVtYTogc2NoZW1hID0+IHtcbiAgICAgIGNvbnN0IHNjaGVtYUFycmF5ID0gc2NoZW1hLnNwbGl0KCdcXG4nKTtcbiAgICAgIGNvbnN0IGFkZGl0aW9ucyA9IFtcbiAgICAgICAgJyAgZW1iZWRkaW5nIFVuc3VwcG9ydGVkKFwidmVjdG9yKDE1MzYpXCIpPycsXG4gICAgICAgICcgIEBAaW5kZXgoW2VtYmVkZGluZ10sIG1hcDogXCJUcmFuc2NyaXB0U2VnbWVudF9lbWJlZGRpbmdfaWR4XCIpJ1xuICAgICAgXTtcbiAgICAgIHJldHVybiBbLi4uc2NoZW1hQXJyYXkuc2xpY2UoMCwgLTEpLCAuLi5hZGRpdGlvbnMsIHNjaGVtYUFycmF5LnBvcCgpXS5qb2luKCdcXG4nKTtcbiAgICB9XG4gIH0sXG4gIGFjY2Vzczoge1xuICAgIG9wZXJhdGlvbjoge1xuICAgICAgcXVlcnk6ICh7IHNlc3Npb24gfSkgPT4gaXNBdXRoZW50aWNhdGVkKHsgc2Vzc2lvbiB9KSxcbiAgICAgIGNyZWF0ZTogY2FuRWRpdFByb2plY3REYXRhLFxuICAgICAgdXBkYXRlOiBjYW5FZGl0UHJvamVjdERhdGEsXG4gICAgICBkZWxldGU6IGNhbkVkaXRQcm9qZWN0RGF0YVxuICAgIH0sXG4gICAgZmlsdGVyOiB7XG4gICAgICBxdWVyeTogYXN5bmMgKHsgc2Vzc2lvbiB9KSA9PiB7XG4gICAgICAgIGlmICghaXNBdXRoZW50aWNhdGVkKHsgc2Vzc2lvbiB9KSkgcmV0dXJuIGZhbHNlO1xuICAgICAgICBpZiAoaXNHb2QoeyBzZXNzaW9uIH0pKSByZXR1cm4gdHJ1ZTtcbiAgICAgICAgaWYgKCFzZXNzaW9uPy5vcmdJZCkgcmV0dXJuIGZhbHNlO1xuXG4gICAgICAgIC8vIE9yZy1sZXZlbCB2aXNpYmlsaXR5XG4gICAgICAgIGNvbnN0IG9yZ0ZpbHRlciA9IHtcbiAgICAgICAgICB0cmFuc2NyaXB0OiB7IHByb2plY3Q6IHsgb3JnOiB7IGlkOiB7IGVxdWFsczogc2Vzc2lvbi5vcmdJZCB9IH0gfSB9XG4gICAgICAgIH07XG5cbiAgICAgICAgLy8gUHJvamVjdC1zY29wZWQgdmlzaWJpbGl0eSAoZm9yIHByb2plY3QgYWRtaW5zIHdpdGggYSBwcm9qZWN0SWQpXG4gICAgICAgIGlmIChzZXNzaW9uLnByb2plY3RJZCkge1xuICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBPUjogW29yZ0ZpbHRlciwgeyB0cmFuc2NyaXB0OiB7IHByb2plY3Q6IHsgaWQ6IHsgZXF1YWxzOiBzZXNzaW9uLnByb2plY3RJZCB9IH0gfSB9XVxuICAgICAgICAgIH07XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gb3JnRmlsdGVyO1xuICAgICAgfVxuICAgIH0sXG4gICAgaXRlbToge1xuICAgICAgdXBkYXRlOiBhc3luYyAoeyBzZXNzaW9uLCBpdGVtLCBjb250ZXh0IH0pID0+IHtcbiAgICAgICAgaWYgKGlzR29kKHsgc2Vzc2lvbiB9KSkgcmV0dXJuIHRydWU7XG4gICAgICAgIGlmICghaXRlbT8uaWQpIHJldHVybiBmYWxzZTtcblxuICAgICAgICBjb25zdCBzdWRvQ29udGV4dCA9IGNvbnRleHQuc3VkbygpO1xuICAgICAgICBjb25zdCByZWNvcmQgPSAoYXdhaXQgc3Vkb0NvbnRleHQucXVlcnkuVHJhbnNjcmlwdFNlZ21lbnQuZmluZE9uZSh7XG4gICAgICAgICAgd2hlcmU6IHsgaWQ6IFN0cmluZyhpdGVtLmlkKSB9LFxuICAgICAgICAgIHF1ZXJ5OiAndHJhbnNjcmlwdCB7IHByb2plY3QgeyBvcmcgeyBpZCB9IH0gfSdcbiAgICAgICAgfSkpIGFzIHsgdHJhbnNjcmlwdD86IHsgcHJvamVjdD86IHsgb3JnPzogeyBpZDogc3RyaW5nIH0gfCBudWxsIH0gfCBudWxsIH0gfCBudWxsIH0gfCBudWxsO1xuICAgICAgICBpZiAoIXJlY29yZD8udHJhbnNjcmlwdD8ucHJvamVjdD8ub3JnPy5pZCkgcmV0dXJuIGZhbHNlO1xuICAgICAgICByZXR1cm4gcmVjb3JkLnRyYW5zY3JpcHQucHJvamVjdC5vcmcuaWQgPT09IHNlc3Npb24ub3JnSWQ7XG4gICAgICB9LFxuICAgICAgZGVsZXRlOiBhc3luYyAoeyBzZXNzaW9uLCBpdGVtLCBjb250ZXh0IH0pID0+IHtcbiAgICAgICAgaWYgKGlzR29kKHsgc2Vzc2lvbiB9KSkgcmV0dXJuIHRydWU7XG4gICAgICAgIGlmICghaXNPcmdBZG1pbih7IHNlc3Npb24gfSkpIHJldHVybiBmYWxzZTtcbiAgICAgICAgaWYgKCFpdGVtPy5pZCkgcmV0dXJuIGZhbHNlO1xuICAgICAgICBjb25zdCBzdWRvQ29udGV4dCA9IGNvbnRleHQuc3VkbygpO1xuICAgICAgICBjb25zdCByZWNvcmQgPSAoYXdhaXQgc3Vkb0NvbnRleHQucXVlcnkuVHJhbnNjcmlwdFNlZ21lbnQuZmluZE9uZSh7XG4gICAgICAgICAgd2hlcmU6IHsgaWQ6IFN0cmluZyhpdGVtLmlkKSB9LFxuICAgICAgICAgIHF1ZXJ5OiAndHJhbnNjcmlwdCB7IHByb2plY3QgeyBvcmcgeyBpZCB9IH0gfSdcbiAgICAgICAgfSkpIGFzIHsgdHJhbnNjcmlwdD86IHsgcHJvamVjdD86IHsgb3JnPzogeyBpZDogc3RyaW5nIH0gfCBudWxsIH0gfCBudWxsIH0gfCBudWxsIH0gfCBudWxsO1xuICAgICAgICByZXR1cm4gcmVjb3JkPy50cmFuc2NyaXB0Py5wcm9qZWN0Py5vcmc/LmlkID09PSBzZXNzaW9uLm9yZ0lkO1xuICAgICAgfVxuICAgIH1cbiAgfSxcbiAgaG9va3M6IHtcbiAgICBhZnRlck9wZXJhdGlvbjogYXN5bmMgKHsgb3BlcmF0aW9uLCBpdGVtLCByZXNvbHZlZERhdGEsIGNvbnRleHQgfSkgPT4ge1xuICAgICAgY29uc3Qgc2hvdWxkRW1iZWQgPSBvcGVyYXRpb24gPT09ICdjcmVhdGUnIHx8IChvcGVyYXRpb24gPT09ICd1cGRhdGUnICYmIHJlc29sdmVkRGF0YT8udGV4dCAhPT0gdW5kZWZpbmVkKTtcbiAgICAgIGlmICghc2hvdWxkRW1iZWQpIHJldHVybjtcbiAgICAgIGlmICghaXRlbT8uaWQgfHwgIWl0ZW0/LnRleHQpIHJldHVybjtcblxuICAgICAgdHJ5IHtcbiAgICAgICAgY29uc3QgZW1iZWRkaW5nID0gZm9ybWF0VmVjdG9yTGl0ZXJhbCgoYXdhaXQgY3JlYXRlRW1iZWRkaW5ncyhbaXRlbS50ZXh0XSkpWzBdKTtcbiAgICAgICAgaWYgKCFlbWJlZGRpbmcpIHJldHVybjtcblxuICAgICAgICBhd2FpdCBjb250ZXh0LnN1ZG8oKS5wcmlzbWEuJGV4ZWN1dGVSYXdgXG4gICAgICAgICAgVVBEQVRFIFwiVHJhbnNjcmlwdFNlZ21lbnRcIiBTRVQgXCJlbWJlZGRpbmdcIiA9ICR7UHJpc21hLnJhdyhlbWJlZGRpbmcpfSBXSEVSRSBpZCA9ICR7aXRlbS5pZH1cbiAgICAgICAgYDtcbiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0ZhaWxlZCB0byBnZW5lcmF0ZSBlbWJlZGRpbmcgZm9yIFRyYW5zY3JpcHRTZWdtZW50JywgZXJyb3IpO1xuICAgICAgfVxuICAgIH1cbiAgfVxufSkgc2F0aXNmaWVzIExpc3RzWydUcmFuc2NyaXB0U2VnbWVudCddO1xuIl0sIm5hbWVzIjpbImxpc3QiLCJjaGVja2JveCIsImludGVnZXIiLCJyZWxhdGlvbnNoaXAiLCJ0ZXh0IiwiUHJpc21hIiwiY2FuRWRpdFByb2plY3REYXRhIiwiaXNBdXRoZW50aWNhdGVkIiwiaXNHb2QiLCJpc09yZ0FkbWluIiwiY3JlYXRlRW1iZWRkaW5ncyIsImZvcm1hdFZlY3RvckxpdGVyYWwiLCJmaWVsZHMiLCJ0cmFuc2NyaXB0IiwicmVmIiwibWFueSIsImluZGV4Iiwic3RhcnRNcyIsImVuZE1zIiwiZHVyYXRpb25NcyIsInVpIiwiZGlzcGxheU1vZGUiLCJzcGVha2VyIiwiaXNNZXRhZGF0YSIsImRlZmF1bHRWYWx1ZSIsImNoYXRNZXNzYWdlcyIsImRiIiwiZXh0ZW5kUHJpc21hU2NoZW1hIiwic2NoZW1hIiwic2NoZW1hQXJyYXkiLCJzcGxpdCIsImFkZGl0aW9ucyIsInNsaWNlIiwicG9wIiwiam9pbiIsImFjY2VzcyIsIm9wZXJhdGlvbiIsInF1ZXJ5Iiwic2Vzc2lvbiIsImNyZWF0ZSIsInVwZGF0ZSIsImRlbGV0ZSIsImZpbHRlciIsIm9yZ0lkIiwib3JnRmlsdGVyIiwicHJvamVjdCIsIm9yZyIsImlkIiwiZXF1YWxzIiwicHJvamVjdElkIiwiT1IiLCJpdGVtIiwiY29udGV4dCIsInN1ZG9Db250ZXh0Iiwic3VkbyIsInJlY29yZCIsIlRyYW5zY3JpcHRTZWdtZW50IiwiZmluZE9uZSIsIndoZXJlIiwiU3RyaW5nIiwiaG9va3MiLCJhZnRlck9wZXJhdGlvbiIsInJlc29sdmVkRGF0YSIsInNob3VsZEVtYmVkIiwidW5kZWZpbmVkIiwiZW1iZWRkaW5nIiwicHJpc21hIiwiJGV4ZWN1dGVSYXciLCJyYXciLCJlcnJvciIsImNvbnNvbGUiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(api)/../../schemas/TranscriptSegment.ts\n");

/***/ }),

/***/ "(api)/../../schemas/User.ts":
/*!*****************************!*\
  !*** ../../schemas/User.ts ***!
  \*****************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var _keystone_6_cloudinary__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @keystone-6/cloudinary */ \"@keystone-6/cloudinary\");\n/* harmony import */ var _keystone_6_cloudinary__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_keystone_6_cloudinary__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _keystone_6_core__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @keystone-6/core */ \"@keystone-6/core\");\n/* harmony import */ var _keystone_6_core__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(_keystone_6_core__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var _keystone_6_core_access__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @keystone-6/core/access */ \"@keystone-6/core/access\");\n/* harmony import */ var _keystone_6_core_access__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(_keystone_6_core_access__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var _keystone_6_core_fields__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @keystone-6/core/fields */ \"@keystone-6/core/fields\");\n/* harmony import */ var _keystone_6_core_fields__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(_keystone_6_core_fields__WEBPACK_IMPORTED_MODULE_3__);\n/* harmony import */ var crypto__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! crypto */ \"crypto\");\n/* harmony import */ var crypto__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(crypto__WEBPACK_IMPORTED_MODULE_4__);\n/* harmony import */ var _config_env__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../config/env */ \"(api)/../../config/env.ts\");\n/* harmony import */ var _domains_auth_userRole__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../domains/auth/userRole */ \"(api)/../../domains/auth/userRole.ts\");\n\n\n\n\n\n\n\nconst validation = {\n    isRequired: true\n};\nconst socialLoginOpts = [\n    {\n        label: \"Google\",\n        value: \"google\"\n    }\n];\nconst userRoleOptions = [\n    {\n        label: \"User\",\n        value: _domains_auth_userRole__WEBPACK_IMPORTED_MODULE_6__.UserRole.USER\n    },\n    {\n        label: \"Project Admin\",\n        value: _domains_auth_userRole__WEBPACK_IMPORTED_MODULE_6__.UserRole.PROJECT_ADMIN\n    },\n    {\n        label: \"Organization Admin\",\n        value: _domains_auth_userRole__WEBPACK_IMPORTED_MODULE_6__.UserRole.ORG_ADMIN\n    },\n    {\n        label: \"Organization Owner\",\n        value: _domains_auth_userRole__WEBPACK_IMPORTED_MODULE_6__.UserRole.ORG_OWNER\n    },\n    {\n        label: \"System Admin\",\n        value: _domains_auth_userRole__WEBPACK_IMPORTED_MODULE_6__.UserRole.GOD\n    }\n];\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_keystone_6_core__WEBPACK_IMPORTED_MODULE_1__.list)({\n    fields: {\n        avatarSocialUrl: (0,_keystone_6_core_fields__WEBPACK_IMPORTED_MODULE_3__.text)({\n            ui: {\n                createView: {\n                    fieldMode: \"hidden\"\n                },\n                itemView: {\n                    fieldMode: \"hidden\"\n                }\n            }\n        }),\n        avatarUploaded: (0,_keystone_6_cloudinary__WEBPACK_IMPORTED_MODULE_0__.cloudinaryImage)({\n            cloudinary: {\n                cloudName: _config_env__WEBPACK_IMPORTED_MODULE_5__[\"default\"].CLOUDINARY_CLOUD_NAME,\n                apiKey: _config_env__WEBPACK_IMPORTED_MODULE_5__[\"default\"].CLOUDINARY_API_KEY,\n                apiSecret: _config_env__WEBPACK_IMPORTED_MODULE_5__[\"default\"].CLOUDINARY_API_SECRET,\n                folder: _config_env__WEBPACK_IMPORTED_MODULE_5__[\"default\"].CLOUDINARY_API_FOLDER\n            }\n        }),\n        avatarUrl: (0,_keystone_6_core_fields__WEBPACK_IMPORTED_MODULE_3__.virtual)({\n            field: _keystone_6_core__WEBPACK_IMPORTED_MODULE_1__.graphql.field({\n                type: _keystone_6_core__WEBPACK_IMPORTED_MODULE_1__.graphql.String,\n                resolve: (item)=>item.avatarUploaded?.publicUrl || item.avatarSocialUrl || \"\"\n            })\n        }),\n        email: (0,_keystone_6_core_fields__WEBPACK_IMPORTED_MODULE_3__.text)({\n            validation,\n            isIndexed: true,\n            isFilterable: true\n        }),\n        firstName: (0,_keystone_6_core_fields__WEBPACK_IMPORTED_MODULE_3__.text)(),\n        lastName: (0,_keystone_6_core_fields__WEBPACK_IMPORTED_MODULE_3__.text)(),\n        displayName: (0,_keystone_6_core_fields__WEBPACK_IMPORTED_MODULE_3__.virtual)({\n            field: _keystone_6_core__WEBPACK_IMPORTED_MODULE_1__.graphql.field({\n                type: _keystone_6_core__WEBPACK_IMPORTED_MODULE_1__.graphql.String,\n                resolve: (item)=>{\n                    const name = [\n                        item.firstName,\n                        item.lastName\n                    ].filter(Boolean).join(\" \");\n                    return name || item.email || \"\";\n                }\n            })\n        }),\n        role: (0,_keystone_6_core_fields__WEBPACK_IMPORTED_MODULE_3__.select)({\n            type: \"enum\",\n            options: userRoleOptions,\n            defaultValue: _domains_auth_userRole__WEBPACK_IMPORTED_MODULE_6__.UserRole.USER,\n            access: {\n                ...(0,_keystone_6_core_access__WEBPACK_IMPORTED_MODULE_2__.allOperations)(_keystone_6_core_access__WEBPACK_IMPORTED_MODULE_2__.denyAll),\n                read: _domains_auth_userRole__WEBPACK_IMPORTED_MODULE_6__.isAuthenticated,\n                create: _domains_auth_userRole__WEBPACK_IMPORTED_MODULE_6__.isAnyAdmin,\n                update: _domains_auth_userRole__WEBPACK_IMPORTED_MODULE_6__.isAnyAdmin\n            }\n        }),\n        providerAccountId: (0,_keystone_6_core_fields__WEBPACK_IMPORTED_MODULE_3__.text)({\n            isIndexed: \"unique\",\n            access: {\n                ...(0,_keystone_6_core_access__WEBPACK_IMPORTED_MODULE_2__.allOperations)(_keystone_6_core_access__WEBPACK_IMPORTED_MODULE_2__.denyAll),\n                read: _domains_auth_userRole__WEBPACK_IMPORTED_MODULE_6__.isGod,\n                create: _domains_auth_userRole__WEBPACK_IMPORTED_MODULE_6__.isGod,\n                update: _domains_auth_userRole__WEBPACK_IMPORTED_MODULE_6__.isGod\n            },\n            ui: {\n                createView: {\n                    fieldMode: \"hidden\"\n                }\n            }\n        }),\n        provider: (0,_keystone_6_core_fields__WEBPACK_IMPORTED_MODULE_3__.select)({\n            type: \"enum\",\n            validation,\n            options: socialLoginOpts,\n            access: {\n                ...(0,_keystone_6_core_access__WEBPACK_IMPORTED_MODULE_2__.allOperations)(_keystone_6_core_access__WEBPACK_IMPORTED_MODULE_2__.denyAll),\n                read: _domains_auth_userRole__WEBPACK_IMPORTED_MODULE_6__.isGod,\n                create: _domains_auth_userRole__WEBPACK_IMPORTED_MODULE_6__.isGod\n            },\n            defaultValue: socialLoginOpts[0].value\n        }),\n        rawAuth: (0,_keystone_6_core_fields__WEBPACK_IMPORTED_MODULE_3__.json)({\n            access: {\n                ...(0,_keystone_6_core_access__WEBPACK_IMPORTED_MODULE_2__.allOperations)(_keystone_6_core_access__WEBPACK_IMPORTED_MODULE_2__.denyAll),\n                read: _domains_auth_userRole__WEBPACK_IMPORTED_MODULE_6__.isGod,\n                create: _domains_auth_userRole__WEBPACK_IMPORTED_MODULE_6__.isGod\n            },\n            ui: {\n                createView: {\n                    fieldMode: \"hidden\"\n                },\n                itemView: {\n                    fieldMode: \"hidden\"\n                }\n            }\n        }),\n        org: (0,_keystone_6_core_fields__WEBPACK_IMPORTED_MODULE_3__.relationship)({\n            ref: \"Organization.users\",\n            many: false,\n            access: {\n                ...(0,_keystone_6_core_access__WEBPACK_IMPORTED_MODULE_2__.allOperations)(_keystone_6_core_access__WEBPACK_IMPORTED_MODULE_2__.denyAll),\n                read: _domains_auth_userRole__WEBPACK_IMPORTED_MODULE_6__.isAuthenticated,\n                create: _domains_auth_userRole__WEBPACK_IMPORTED_MODULE_6__.isAnyAdmin,\n                update: _domains_auth_userRole__WEBPACK_IMPORTED_MODULE_6__.isOrgAdminOrAbove\n            }\n        }),\n        project: (0,_keystone_6_core_fields__WEBPACK_IMPORTED_MODULE_3__.relationship)({\n            ref: \"Project.users\",\n            many: false,\n            access: {\n                ...(0,_keystone_6_core_access__WEBPACK_IMPORTED_MODULE_2__.allOperations)(_keystone_6_core_access__WEBPACK_IMPORTED_MODULE_2__.denyAll),\n                read: _domains_auth_userRole__WEBPACK_IMPORTED_MODULE_6__.isAuthenticated,\n                create: _domains_auth_userRole__WEBPACK_IMPORTED_MODULE_6__.isAnyAdmin,\n                update: _domains_auth_userRole__WEBPACK_IMPORTED_MODULE_6__.isAnyAdmin\n            }\n        }),\n        isActive: (0,_keystone_6_core_fields__WEBPACK_IMPORTED_MODULE_3__.checkbox)({\n            defaultValue: true,\n            access: {\n                ...(0,_keystone_6_core_access__WEBPACK_IMPORTED_MODULE_2__.allOperations)(_keystone_6_core_access__WEBPACK_IMPORTED_MODULE_2__.denyAll),\n                read: _domains_auth_userRole__WEBPACK_IMPORTED_MODULE_6__.isAuthenticated,\n                create: _domains_auth_userRole__WEBPACK_IMPORTED_MODULE_6__.isAnyAdmin,\n                update: _domains_auth_userRole__WEBPACK_IMPORTED_MODULE_6__.isOrgAdminOrAbove\n            }\n        }),\n        createdAt: (0,_keystone_6_core_fields__WEBPACK_IMPORTED_MODULE_3__.timestamp)({\n            defaultValue: {\n                kind: \"now\"\n            },\n            ui: {\n                createView: {\n                    fieldMode: \"hidden\"\n                },\n                itemView: {\n                    fieldMode: \"read\"\n                }\n            }\n        }),\n        provisionedAt: (0,_keystone_6_core_fields__WEBPACK_IMPORTED_MODULE_3__.timestamp)({\n            ui: {\n                createView: {\n                    fieldMode: \"hidden\"\n                },\n                itemView: {\n                    fieldMode: \"read\"\n                }\n            }\n        }),\n        updatedAt: (0,_keystone_6_core_fields__WEBPACK_IMPORTED_MODULE_3__.timestamp)({\n            db: {\n                updatedAt: true\n            },\n            ui: {\n                createView: {\n                    fieldMode: \"hidden\"\n                },\n                itemView: {\n                    fieldMode: \"read\"\n                }\n            }\n        }),\n        seenAt: (0,_keystone_6_core_fields__WEBPACK_IMPORTED_MODULE_3__.timestamp)({\n            ui: {\n                createView: {\n                    fieldMode: \"hidden\"\n                },\n                itemView: {\n                    fieldMode: \"read\"\n                }\n            }\n        })\n    },\n    ui: {\n        labelField: \"email\"\n    },\n    access: {\n        operation: {\n            query: ({ session })=>(0,_domains_auth_userRole__WEBPACK_IMPORTED_MODULE_6__.isAuthenticated)({\n                    session\n                }),\n            create: ({ session })=>(0,_domains_auth_userRole__WEBPACK_IMPORTED_MODULE_6__.isAnyAdmin)({\n                    session\n                }),\n            update: ({ session })=>(0,_domains_auth_userRole__WEBPACK_IMPORTED_MODULE_6__.isAuthenticated)({\n                    session\n                }),\n            delete: async (args)=>{\n                const typedArgs = args;\n                const { session, itemId, context } = typedArgs;\n                if ((0,_domains_auth_userRole__WEBPACK_IMPORTED_MODULE_6__.isGod)({\n                    session\n                })) return true;\n                if (!(0,_domains_auth_userRole__WEBPACK_IMPORTED_MODULE_6__.isOrgAdmin)({\n                    session\n                })) return false;\n                if (!session?.orgId || !itemId) return false;\n                const user = await context.sudo().query.User.findOne({\n                    where: {\n                        id: itemId\n                    },\n                    query: \"org { id }\"\n                });\n                if (!user) return false;\n                return user.org?.id === session.orgId;\n            }\n        },\n        item: {\n            update: async ({ session, item, context })=>{\n                if ((0,_domains_auth_userRole__WEBPACK_IMPORTED_MODULE_6__.isGod)({\n                    session\n                })) return true;\n                if (!session?.id || !item?.id) return false;\n                const targetUserId = String(item.id);\n                const sessionId = String(session.id);\n                // Users can update themselves\n                if (sessionId === targetUserId) return true;\n                // Query the item with relationships and role we need\n                const sudoContext = context.sudo();\n                const userWithRelations = await sudoContext.query.User.findOne({\n                    where: {\n                        id: targetUserId\n                    },\n                    query: \"id org { id } project { id } role\"\n                });\n                if (!userWithRelations) return false;\n                // Role hierarchy check: admins cannot edit users with higher roles\n                if (!(0,_domains_auth_userRole__WEBPACK_IMPORTED_MODULE_6__.canEditUserByRole)(session?.role, userWithRelations.role)) return false;\n                // Org admins (ORG_ADMIN and ORG_OWNER) can update users in their org\n                if ((0,_domains_auth_userRole__WEBPACK_IMPORTED_MODULE_6__.isOrgAdmin)({\n                    session\n                })) {\n                    if (!session?.orgId) return false;\n                    if (!userWithRelations.org?.id) return false;\n                    // Compare org IDs as strings to ensure proper comparison\n                    return String(userWithRelations.org.id) === String(session.orgId);\n                }\n                // Project admins can update users in their project\n                if ((0,_domains_auth_userRole__WEBPACK_IMPORTED_MODULE_6__.isProjectAdmin)({\n                    session\n                })) {\n                    if (!session?.projectId || !session?.orgId) return false;\n                    if (!userWithRelations.project?.id || !userWithRelations.org?.id) return false;\n                    // Must be in same project and same org\n                    return String(userWithRelations.project.id) === String(session.projectId) && String(userWithRelations.org.id) === String(session.orgId);\n                }\n                return false;\n            }\n        },\n        filter: {\n            query: async ({ session })=>{\n                if (!(0,_domains_auth_userRole__WEBPACK_IMPORTED_MODULE_6__.isAuthenticated)({\n                    session\n                })) return false;\n                if ((0,_domains_auth_userRole__WEBPACK_IMPORTED_MODULE_6__.isGod)({\n                    session\n                })) return true;\n                if ((0,_domains_auth_userRole__WEBPACK_IMPORTED_MODULE_6__.isOrgAdmin)({\n                    session\n                })) return (0,_domains_auth_userRole__WEBPACK_IMPORTED_MODULE_6__.filterByUserOrg)({\n                    session\n                });\n                if ((0,_domains_auth_userRole__WEBPACK_IMPORTED_MODULE_6__.isProjectAdmin)({\n                    session\n                })) return (0,_domains_auth_userRole__WEBPACK_IMPORTED_MODULE_6__.filterByUserProject)({\n                    session\n                });\n                return (0,_domains_auth_userRole__WEBPACK_IMPORTED_MODULE_6__.isSelf)({\n                    session\n                });\n            }\n        }\n    },\n    hooks: {\n        resolveInput: {\n            create: async ({ resolvedData })=>({\n                    ...resolvedData,\n                    email: resolvedData.email?.toLowerCase(),\n                    providerAccountId: resolvedData.providerAccountId || (0,crypto__WEBPACK_IMPORTED_MODULE_4__.randomUUID)()\n                }),\n            update: async ({ resolvedData })=>({\n                    ...resolvedData,\n                    email: typeof resolvedData.email === \"string\" ? resolvedData.email.toLowerCase() : resolvedData.email,\n                    providerAccountId: resolvedData.providerAccountId || (0,crypto__WEBPACK_IMPORTED_MODULE_4__.randomUUID)()\n                })\n        },\n        validateInput: async ({ operation, resolvedData, item, context, addValidationError })=>{\n            const existingUser = item?.id ? await context.query.User.findOne({\n                where: {\n                    id: item.id\n                },\n                query: \"id org { id } project { id } role\"\n            }) : null;\n            // Check if user is trying to edit themselves\n            const session = context.session;\n            const isEditingSelf = operation === \"update\" && existingUser && session?.id && String(existingUser.id) === String(session.id);\n            // Prevent self-editing of role (always)\n            isEditingSelf && resolvedData.role && addValidationError(\"You cannot edit your own role.\");\n            // Prevent self-editing of isActive (always)\n            isEditingSelf && resolvedData.isActive !== undefined && addValidationError(\"You cannot edit your own active status.\");\n            // Prevent self-editing of project unless ORG_OWNER/ORG_ADMIN\n            isEditingSelf && resolvedData.project && session?.role !== _domains_auth_userRole__WEBPACK_IMPORTED_MODULE_6__.UserRole.ORG_ADMIN && session?.role !== _domains_auth_userRole__WEBPACK_IMPORTED_MODULE_6__.UserRole.ORG_OWNER && addValidationError(\"You cannot edit your own project.\");\n            const resolveRelationshipId = (input, existingId)=>{\n                const typedInput = input;\n                if (!typedInput) return existingId ?? null;\n                const getDisconnectedId = ()=>{\n                    if (!(\"disconnect\" in typedInput) || !typedInput.disconnect) return null;\n                    if (typedInput.disconnect === true) return null;\n                    if (Array.isArray(typedInput.disconnect) && typedInput.disconnect.length > 0) return null;\n                    return existingId ?? null;\n                };\n                const getConnectedId = ()=>{\n                    if (!(\"connect\" in typedInput) || !typedInput.connect) return null;\n                    if (Array.isArray(typedInput.connect)) return typedInput.connect[0]?.id;\n                    return typedInput.connect.id;\n                };\n                const getSetId = ()=>{\n                    if (!(\"set\" in typedInput) || typedInput.set === undefined) return null;\n                    if (typedInput.set === null) return null;\n                    if (Array.isArray(typedInput.set)) return typedInput.set[0]?.id;\n                    return typedInput.set?.id;\n                };\n                return getDisconnectedId() ?? getConnectedId() ?? getSetId() ?? existingId ?? null;\n            };\n            const getAllowedRolesForAdmin = (adminRole)=>{\n                const baseRoles = [\n                    _domains_auth_userRole__WEBPACK_IMPORTED_MODULE_6__.UserRole.USER\n                ];\n                const roleMap = {\n                    [_domains_auth_userRole__WEBPACK_IMPORTED_MODULE_6__.UserRole.USER]: baseRoles,\n                    [_domains_auth_userRole__WEBPACK_IMPORTED_MODULE_6__.UserRole.PROJECT_ADMIN]: [\n                        ...baseRoles,\n                        _domains_auth_userRole__WEBPACK_IMPORTED_MODULE_6__.UserRole.PROJECT_ADMIN\n                    ],\n                    [_domains_auth_userRole__WEBPACK_IMPORTED_MODULE_6__.UserRole.ORG_ADMIN]: [\n                        ...baseRoles,\n                        _domains_auth_userRole__WEBPACK_IMPORTED_MODULE_6__.UserRole.PROJECT_ADMIN,\n                        _domains_auth_userRole__WEBPACK_IMPORTED_MODULE_6__.UserRole.ORG_ADMIN\n                    ],\n                    [_domains_auth_userRole__WEBPACK_IMPORTED_MODULE_6__.UserRole.ORG_OWNER]: [\n                        ...baseRoles,\n                        _domains_auth_userRole__WEBPACK_IMPORTED_MODULE_6__.UserRole.PROJECT_ADMIN,\n                        _domains_auth_userRole__WEBPACK_IMPORTED_MODULE_6__.UserRole.ORG_ADMIN,\n                        _domains_auth_userRole__WEBPACK_IMPORTED_MODULE_6__.UserRole.ORG_OWNER\n                    ],\n                    [_domains_auth_userRole__WEBPACK_IMPORTED_MODULE_6__.UserRole.GOD]: [\n                        ...baseRoles,\n                        _domains_auth_userRole__WEBPACK_IMPORTED_MODULE_6__.UserRole.PROJECT_ADMIN,\n                        _domains_auth_userRole__WEBPACK_IMPORTED_MODULE_6__.UserRole.ORG_ADMIN,\n                        _domains_auth_userRole__WEBPACK_IMPORTED_MODULE_6__.UserRole.ORG_OWNER\n                    ]\n                };\n                return roleMap[adminRole] ?? baseRoles;\n            };\n            const validateRoleAssignment = (assignedRole, adminRole)=>{\n                if (!adminRole) return;\n                if (assignedRole === _domains_auth_userRole__WEBPACK_IMPORTED_MODULE_6__.UserRole.GOD) {\n                    addValidationError(\"GOD role cannot be assigned via API. It can only be set directly in the database.\");\n                    return;\n                }\n                const allowedRoles = getAllowedRolesForAdmin(adminRole);\n                if (!allowedRoles.includes(assignedRole)) {\n                    addValidationError(\"You cannot assign this role. You can only assign roles up to your own permission level.\");\n                }\n            };\n            const validateProjectRestriction = (operation, nextProjectId, adminRole, adminProjectId)=>{\n                const isProjectAdminCreating = operation === \"create\" && adminRole === _domains_auth_userRole__WEBPACK_IMPORTED_MODULE_6__.UserRole.PROJECT_ADMIN && adminProjectId;\n                if (isProjectAdminCreating && nextProjectId && String(nextProjectId) !== String(adminProjectId)) {\n                    addValidationError(\"Project Admins can only create users in their own project.\");\n                }\n            };\n            const validateProvisioning = (operation, nextOrgId, nextProjectId, existingOrgId, existingProjectId)=>{\n                const isUnprovisioned = !nextOrgId && !nextProjectId;\n                const isInitialProvision = operation === \"create\" && isUnprovisioned;\n                const isExistingUnprovisioned = operation === \"update\" && isUnprovisioned && !existingOrgId && !existingProjectId;\n                if (!isInitialProvision && !isExistingUnprovisioned && (!nextOrgId || !nextProjectId)) {\n                    addValidationError(\"Users must belong to both an organization and a project once provisioned.\");\n                }\n            };\n            const validateProjectOrgMatch = async (nextOrgId, nextProjectId, context)=>{\n                if (!nextOrgId || !nextProjectId) return;\n                const project = await context.query.Project.findOne({\n                    where: {\n                        id: nextProjectId\n                    },\n                    query: \"id org { id }\"\n                });\n                const projectOrgId = project?.org?.id ?? null;\n                if (projectOrgId && projectOrgId !== nextOrgId) {\n                    addValidationError(\"Selected project does not belong to the user's organization.\");\n                }\n            };\n            const nextOrgId = resolveRelationshipId(resolvedData.org, existingUser?.org?.id ?? null);\n            const nextProjectId = resolveRelationshipId(resolvedData.project, existingUser?.project?.id ?? null);\n            resolvedData.role && validateRoleAssignment(resolvedData.role, session?.role);\n            validateProjectRestriction(operation, nextProjectId, session?.role, session?.projectId);\n            validateProvisioning(operation, nextOrgId, nextProjectId, existingUser?.org?.id ?? null, existingUser?.project?.id ?? null);\n            await validateProjectOrgMatch(nextOrgId, nextProjectId, context);\n        }\n    }\n}));\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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NUMsSUFBSSxJQUFJb0UsdUJBQXVCeEIsYUFBYTVDLElBQUksRUFBY3dCLFNBQVN4QjtZQUVwRndFLDJCQUEyQmxELFdBQVdtRCxlQUFlakQsU0FBU3hCLE1BQU13QixTQUFTaUI7WUFFN0VtQyxxQkFDRXRELFdBQ0F1RCxXQUNBSixlQUNBekIsY0FBY3RDLEtBQUswQixNQUFNLE1BQ3pCWSxjQUFjbkMsU0FBU3VCLE1BQU07WUFHL0IsTUFBTStDLHdCQUF3Qk4sV0FBV0osZUFBZTVDO1FBQzFEO0lBQ0Y7QUFDRixFQUFFLEVBQXlCIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLy4uLy4uL3NjaGVtYXMvVXNlci50cz9mYzIzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IHR5cGUgQ29udGV4dCwgdHlwZSBMaXN0cywgdHlwZSBUeXBlSW5mbyB9IGZyb20gJy5rZXlzdG9uZS90eXBlcyc7XG5pbXBvcnQgeyBjbG91ZGluYXJ5SW1hZ2UgfSBmcm9tICdAa2V5c3RvbmUtNi9jbG91ZGluYXJ5JztcbmltcG9ydCB7IGdyYXBocWwgYXMgZywgbGlzdCB9IGZyb20gJ0BrZXlzdG9uZS02L2NvcmUnO1xuaW1wb3J0IHsgYWxsT3BlcmF0aW9ucywgZGVueUFsbCB9IGZyb20gJ0BrZXlzdG9uZS02L2NvcmUvYWNjZXNzJztcbmltcG9ydCB7IGNoZWNrYm94LCBqc29uLCByZWxhdGlvbnNoaXAsIHNlbGVjdCwgdGV4dCwgdGltZXN0YW1wLCB2aXJ0dWFsIH0gZnJvbSAnQGtleXN0b25lLTYvY29yZS9maWVsZHMnO1xuaW1wb3J0IHsgcmFuZG9tVVVJRCB9IGZyb20gJ2NyeXB0byc7XG5pbXBvcnQgdHlwZSB7IFNlc3Npb24gfSBmcm9tICcuLi9hdXRoJztcbmltcG9ydCBlbnYgZnJvbSAnLi4vY29uZmlnL2Vudic7XG5pbXBvcnQge1xuICBjYW5FZGl0VXNlckJ5Um9sZSxcbiAgZmlsdGVyQnlVc2VyT3JnLFxuICBmaWx0ZXJCeVVzZXJQcm9qZWN0LFxuICBpc0FueUFkbWluLFxuICBpc0F1dGhlbnRpY2F0ZWQsXG4gIGlzR29kLFxuICBpc09yZ0FkbWluLFxuICBpc09yZ0FkbWluT3JBYm92ZSxcbiAgaXNQcm9qZWN0QWRtaW4sXG4gIGlzU2VsZixcbiAgVXNlclJvbGVcbn0gZnJvbSAnLi4vZG9tYWlucy9hdXRoL3VzZXJSb2xlJztcblxudHlwZSBVc2VySXRlbSA9IFR5cGVJbmZvWydsaXN0cyddWydVc2VyJ11bJ2l0ZW0nXTtcbnR5cGUgT3JnYW5pemF0aW9uSXRlbSA9IFR5cGVJbmZvWydsaXN0cyddWydPcmdhbml6YXRpb24nXVsnaXRlbSddO1xudHlwZSBQcm9qZWN0SXRlbSA9IFR5cGVJbmZvWydsaXN0cyddWydQcm9qZWN0J11bJ2l0ZW0nXTtcbnR5cGUgUmVsYXRpb25zaGlwSW5wdXQgPVxuICB8IHsgZGlzY29ubmVjdD86IGJvb2xlYW4gfCBBcnJheTx7IGlkOiBzdHJpbmcgfT4gfVxuICB8IHsgY29ubmVjdD86IHsgaWQ6IHN0cmluZyB9IHwgQXJyYXk8eyBpZDogc3RyaW5nIH0+IH1cbiAgfCB7IHNldD86IHsgaWQ6IHN0cmluZyB9IHwgQXJyYXk8eyBpZDogc3RyaW5nIH0+IHwgbnVsbCB9XG4gIHwgbnVsbFxuICB8IHVuZGVmaW5lZDtcblxuY29uc3QgdmFsaWRhdGlvbiA9IHsgaXNSZXF1aXJlZDogdHJ1ZSB9O1xuY29uc3Qgc29jaWFsTG9naW5PcHRzID0gW3sgbGFiZWw6ICdHb29nbGUnLCB2YWx1ZTogJ2dvb2dsZScgfV07XG5cbmNvbnN0IHVzZXJSb2xlT3B0aW9ucyA9IFtcbiAgeyBsYWJlbDogJ1VzZXInLCB2YWx1ZTogVXNlclJvbGUuVVNFUiB9LFxuICB7IGxhYmVsOiAnUHJvamVjdCBBZG1pbicsIHZhbHVlOiBVc2VyUm9sZS5QUk9KRUNUX0FETUlOIH0sXG4gIHsgbGFiZWw6ICdPcmdhbml6YXRpb24gQWRtaW4nLCB2YWx1ZTogVXNlclJvbGUuT1JHX0FETUlOIH0sXG4gIHsgbGFiZWw6ICdPcmdhbml6YXRpb24gT3duZXInLCB2YWx1ZTogVXNlclJvbGUuT1JHX09XTkVSIH0sXG4gIHsgbGFiZWw6ICdTeXN0ZW0gQWRtaW4nLCB2YWx1ZTogVXNlclJvbGUuR09EIH1cbl07XG5cbmV4cG9ydCBkZWZhdWx0IGxpc3Qoe1xuICBmaWVsZHM6IHtcbiAgICBhdmF0YXJTb2NpYWxVcmw6IHRleHQoe1xuICAgICAgdWk6IHtcbiAgICAgICAgY3JlYXRlVmlldzoge1xuICAgICAgICAgIGZpZWxkTW9kZTogJ2hpZGRlbidcbiAgICAgICAgfSxcbiAgICAgICAgaXRlbVZpZXc6IHtcbiAgICAgICAgICBmaWVsZE1vZGU6ICdoaWRkZW4nXG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9KSxcbiAgICBhdmF0YXJVcGxvYWRlZDogY2xvdWRpbmFyeUltYWdlKHtcbiAgICAgIGNsb3VkaW5hcnk6IHtcbiAgICAgICAgY2xvdWROYW1lOiBlbnYuQ0xPVURJTkFSWV9DTE9VRF9OQU1FLFxuICAgICAgICBhcGlLZXk6IGVudi5DTE9VRElOQVJZX0FQSV9LRVkhLFxuICAgICAgICBhcGlTZWNyZXQ6IGVudi5DTE9VRElOQVJZX0FQSV9TRUNSRVQhLFxuICAgICAgICBmb2xkZXI6IGVudi5DTE9VRElOQVJZX0FQSV9GT0xERVIhXG4gICAgICB9XG4gICAgfSksXG4gICAgYXZhdGFyVXJsOiB2aXJ0dWFsKHtcbiAgICAgIGZpZWxkOiBnLmZpZWxkKHtcbiAgICAgICAgdHlwZTogZy5TdHJpbmcsXG4gICAgICAgIHJlc29sdmU6IChpdGVtOiBVc2VySXRlbSk6IHN0cmluZyB8IG51bGwgPT5cbiAgICAgICAgICAoaXRlbS5hdmF0YXJVcGxvYWRlZCBhcyB7IHB1YmxpY1VybD86IHN0cmluZyB9KT8ucHVibGljVXJsIHx8IGl0ZW0uYXZhdGFyU29jaWFsVXJsIHx8ICcnXG4gICAgICB9KVxuICAgIH0pLFxuICAgIGVtYWlsOiB0ZXh0KHtcbiAgICAgIHZhbGlkYXRpb24sXG4gICAgICBpc0luZGV4ZWQ6IHRydWUsXG4gICAgICBpc0ZpbHRlcmFibGU6IHRydWVcbiAgICB9KSxcbiAgICBmaXJzdE5hbWU6IHRleHQoKSxcbiAgICBsYXN0TmFtZTogdGV4dCgpLFxuICAgIGRpc3BsYXlOYW1lOiB2aXJ0dWFsKHtcbiAgICAgIGZpZWxkOiBnLmZpZWxkKHtcbiAgICAgICAgdHlwZTogZy5TdHJpbmcsXG4gICAgICAgIHJlc29sdmU6IChpdGVtOiBVc2VySXRlbSk6IHN0cmluZyA9PiB7XG4gICAgICAgICAgY29uc3QgbmFtZSA9IFtpdGVtLmZpcnN0TmFtZSwgaXRlbS5sYXN0TmFtZV0uZmlsdGVyKEJvb2xlYW4pLmpvaW4oJyAnKTtcbiAgICAgICAgICByZXR1cm4gbmFtZSB8fCBpdGVtLmVtYWlsIHx8ICcnO1xuICAgICAgICB9XG4gICAgICB9KVxuICAgIH0pLFxuICAgIHJvbGU6IHNlbGVjdCh7XG4gICAgICB0eXBlOiAnZW51bScsXG4gICAgICBvcHRpb25zOiB1c2VyUm9sZU9wdGlvbnMsXG4gICAgICBkZWZhdWx0VmFsdWU6IFVzZXJSb2xlLlVTRVIsXG4gICAgICBhY2Nlc3M6IHtcbiAgICAgICAgLi4uYWxsT3BlcmF0aW9ucyhkZW55QWxsKSxcbiAgICAgICAgcmVhZDogaXNBdXRoZW50aWNhdGVkLFxuICAgICAgICBjcmVhdGU6IGlzQW55QWRtaW4sXG4gICAgICAgIHVwZGF0ZTogaXNBbnlBZG1pblxuICAgICAgfVxuICAgIH0pLFxuICAgIHByb3ZpZGVyQWNjb3VudElkOiB0ZXh0KHtcbiAgICAgIGlzSW5kZXhlZDogJ3VuaXF1ZScsXG4gICAgICBhY2Nlc3M6IHtcbiAgICAgICAgLi4uYWxsT3BlcmF0aW9ucyhkZW55QWxsKSxcbiAgICAgICAgcmVhZDogaXNHb2QsXG4gICAgICAgIGNyZWF0ZTogaXNHb2QsXG4gICAgICAgIHVwZGF0ZTogaXNHb2RcbiAgICAgIH0sXG4gICAgICB1aToge1xuICAgICAgICBjcmVhdGVWaWV3OiB7IGZpZWxkTW9kZTogJ2hpZGRlbicgfVxuICAgICAgfVxuICAgIH0pLFxuICAgIHByb3ZpZGVyOiBzZWxlY3Qoe1xuICAgICAgdHlwZTogJ2VudW0nLFxuICAgICAgdmFsaWRhdGlvbixcbiAgICAgIG9wdGlvbnM6IHNvY2lhbExvZ2luT3B0cyxcbiAgICAgIGFjY2VzczogeyAuLi5hbGxPcGVyYXRpb25zKGRlbnlBbGwpLCByZWFkOiBpc0dvZCwgY3JlYXRlOiBpc0dvZCB9LFxuICAgICAgZGVmYXVsdFZhbHVlOiBzb2NpYWxMb2dpbk9wdHNbMF0udmFsdWVcbiAgICB9KSxcbiAgICByYXdBdXRoOiBqc29uKHtcbiAgICAgIGFjY2VzczogeyAuLi5hbGxPcGVyYXRpb25zKGRlbnlBbGwpLCByZWFkOiBpc0dvZCwgY3JlYXRlOiBpc0dvZCB9LFxuICAgICAgdWk6IHtcbiAgICAgICAgY3JlYXRlVmlldzogeyBmaWVsZE1vZGU6ICdoaWRkZW4nIH0sXG4gICAgICAgIGl0ZW1WaWV3OiB7IGZpZWxkTW9kZTogJ2hpZGRlbicgfVxuICAgICAgfVxuICAgIH0pLFxuICAgIG9yZzogcmVsYXRpb25zaGlwKHtcbiAgICAgIHJlZjogJ09yZ2FuaXphdGlvbi51c2VycycsXG4gICAgICBtYW55OiBmYWxzZSxcbiAgICAgIGFjY2Vzczoge1xuICAgICAgICAuLi5hbGxPcGVyYXRpb25zKGRlbnlBbGwpLFxuICAgICAgICByZWFkOiBpc0F1dGhlbnRpY2F0ZWQsXG4gICAgICAgIGNyZWF0ZTogaXNBbnlBZG1pbixcbiAgICAgICAgdXBkYXRlOiBpc09yZ0FkbWluT3JBYm92ZVxuICAgICAgfVxuICAgIH0pLFxuICAgIHByb2plY3Q6IHJlbGF0aW9uc2hpcCh7XG4gICAgICByZWY6ICdQcm9qZWN0LnVzZXJzJyxcbiAgICAgIG1hbnk6IGZhbHNlLFxuICAgICAgYWNjZXNzOiB7XG4gICAgICAgIC4uLmFsbE9wZXJhdGlvbnMoZGVueUFsbCksXG4gICAgICAgIHJlYWQ6IGlzQXV0aGVudGljYXRlZCxcbiAgICAgICAgY3JlYXRlOiBpc0FueUFkbWluLFxuICAgICAgICB1cGRhdGU6IGlzQW55QWRtaW5cbiAgICAgIH1cbiAgICB9KSxcbiAgICBpc0FjdGl2ZTogY2hlY2tib3goe1xuICAgICAgZGVmYXVsdFZhbHVlOiB0cnVlLFxuICAgICAgYWNjZXNzOiB7XG4gICAgICAgIC4uLmFsbE9wZXJhdGlvbnMoZGVueUFsbCksXG4gICAgICAgIHJlYWQ6IGlzQXV0aGVudGljYXRlZCxcbiAgICAgICAgY3JlYXRlOiBpc0FueUFkbWluLFxuICAgICAgICB1cGRhdGU6IGlzT3JnQWRtaW5PckFib3ZlXG4gICAgICB9XG4gICAgfSksXG4gICAgY3JlYXRlZEF0OiB0aW1lc3RhbXAoe1xuICAgICAgZGVmYXVsdFZhbHVlOiB7IGtpbmQ6ICdub3cnIH0sXG4gICAgICB1aToge1xuICAgICAgICBjcmVhdGVWaWV3OiB7IGZpZWxkTW9kZTogJ2hpZGRlbicgfSxcbiAgICAgICAgaXRlbVZpZXc6IHsgZmllbGRNb2RlOiAncmVhZCcgfVxuICAgICAgfVxuICAgIH0pLFxuICAgIHByb3Zpc2lvbmVkQXQ6IHRpbWVzdGFtcCh7XG4gICAgICB1aToge1xuICAgICAgICBjcmVhdGVWaWV3OiB7IGZpZWxkTW9kZTogJ2hpZGRlbicgfSxcbiAgICAgICAgaXRlbVZpZXc6IHsgZmllbGRNb2RlOiAncmVhZCcgfVxuICAgICAgfVxuICAgIH0pLFxuICAgIHVwZGF0ZWRBdDogdGltZXN0YW1wKHtcbiAgICAgIGRiOiB7IHVwZGF0ZWRBdDogdHJ1ZSB9LFxuICAgICAgdWk6IHtcbiAgICAgICAgY3JlYXRlVmlldzogeyBmaWVsZE1vZGU6ICdoaWRkZW4nIH0sXG4gICAgICAgIGl0ZW1WaWV3OiB7IGZpZWxkTW9kZTogJ3JlYWQnIH1cbiAgICAgIH1cbiAgICB9KSxcbiAgICBzZWVuQXQ6IHRpbWVzdGFtcCh7XG4gICAgICB1aToge1xuICAgICAgICBjcmVhdGVWaWV3OiB7IGZpZWxkTW9kZTogJ2hpZGRlbicgfSxcbiAgICAgICAgaXRlbVZpZXc6IHsgZmllbGRNb2RlOiAncmVhZCcgfVxuICAgICAgfVxuICAgIH0pXG4gIH0sXG4gIHVpOiB7XG4gICAgbGFiZWxGaWVsZDogJ2VtYWlsJ1xuICB9LFxuICBhY2Nlc3M6IHtcbiAgICBvcGVyYXRpb246IHtcbiAgICAgIHF1ZXJ5OiAoeyBzZXNzaW9uIH0pID0+IGlzQXV0aGVudGljYXRlZCh7IHNlc3Npb24gfSksXG5cbiAgICAgIGNyZWF0ZTogKHsgc2Vzc2lvbiB9KSA9PiBpc0FueUFkbWluKHsgc2Vzc2lvbiB9KSxcbiAgICAgIHVwZGF0ZTogKHsgc2Vzc2lvbiB9KSA9PiBpc0F1dGhlbnRpY2F0ZWQoeyBzZXNzaW9uIH0pLFxuICAgICAgZGVsZXRlOiBhc3luYyBhcmdzID0+IHtcbiAgICAgICAgY29uc3QgdHlwZWRBcmdzID0gYXJncyBhcyB1bmtub3duIGFzIHtcbiAgICAgICAgICBzZXNzaW9uOiBTZXNzaW9uIHwgbnVsbDtcbiAgICAgICAgICBpdGVtSWQ6IHN0cmluZztcbiAgICAgICAgICBjb250ZXh0OiBDb250ZXh0O1xuICAgICAgICB9O1xuICAgICAgICBjb25zdCB7IHNlc3Npb24sIGl0ZW1JZCwgY29udGV4dCB9ID0gdHlwZWRBcmdzO1xuICAgICAgICBpZiAoaXNHb2QoeyBzZXNzaW9uIH0pKSByZXR1cm4gdHJ1ZTtcbiAgICAgICAgaWYgKCFpc09yZ0FkbWluKHsgc2Vzc2lvbiB9KSkgcmV0dXJuIGZhbHNlO1xuICAgICAgICBpZiAoIXNlc3Npb24/Lm9yZ0lkIHx8ICFpdGVtSWQpIHJldHVybiBmYWxzZTtcblxuICAgICAgICBjb25zdCB1c2VyID0gKGF3YWl0IGNvbnRleHQuc3VkbygpLnF1ZXJ5LlVzZXIuZmluZE9uZSh7XG4gICAgICAgICAgd2hlcmU6IHsgaWQ6IGl0ZW1JZCB9LFxuICAgICAgICAgIHF1ZXJ5OiAnb3JnIHsgaWQgfSdcbiAgICAgICAgfSkpIGFzIChQaWNrPFVzZXJJdGVtLCAnaWQnPiAmIHsgb3JnOiBQaWNrPE9yZ2FuaXphdGlvbkl0ZW0sICdpZCc+IHwgbnVsbCB9KSB8IG51bGw7XG4gICAgICAgIGlmICghdXNlcikgcmV0dXJuIGZhbHNlO1xuICAgICAgICByZXR1cm4gdXNlci5vcmc/LmlkID09PSBzZXNzaW9uLm9yZ0lkO1xuICAgICAgfVxuICAgIH0sXG4gICAgaXRlbToge1xuICAgICAgdXBkYXRlOiBhc3luYyAoeyBzZXNzaW9uLCBpdGVtLCBjb250ZXh0IH0pID0+IHtcbiAgICAgICAgaWYgKGlzR29kKHsgc2Vzc2lvbiB9KSkgcmV0dXJuIHRydWU7XG4gICAgICAgIGlmICghc2Vzc2lvbj8uaWQgfHwgIWl0ZW0/LmlkKSByZXR1cm4gZmFsc2U7XG5cbiAgICAgICAgY29uc3QgdGFyZ2V0VXNlcklkID0gU3RyaW5nKGl0ZW0uaWQpO1xuICAgICAgICBjb25zdCBzZXNzaW9uSWQgPSBTdHJpbmcoc2Vzc2lvbi5pZCk7XG5cbiAgICAgICAgLy8gVXNlcnMgY2FuIHVwZGF0ZSB0aGVtc2VsdmVzXG4gICAgICAgIGlmIChzZXNzaW9uSWQgPT09IHRhcmdldFVzZXJJZCkgcmV0dXJuIHRydWU7XG5cbiAgICAgICAgLy8gUXVlcnkgdGhlIGl0ZW0gd2l0aCByZWxhdGlvbnNoaXBzIGFuZCByb2xlIHdlIG5lZWRcbiAgICAgICAgY29uc3Qgc3Vkb0NvbnRleHQgPSBjb250ZXh0LnN1ZG8oKTtcbiAgICAgICAgY29uc3QgdXNlcldpdGhSZWxhdGlvbnMgPSAoYXdhaXQgc3Vkb0NvbnRleHQucXVlcnkuVXNlci5maW5kT25lKHtcbiAgICAgICAgICB3aGVyZTogeyBpZDogdGFyZ2V0VXNlcklkIH0sXG4gICAgICAgICAgcXVlcnk6ICdpZCBvcmcgeyBpZCB9IHByb2plY3QgeyBpZCB9IHJvbGUnXG4gICAgICAgIH0pKSBhc1xuICAgICAgICAgIHwgKFBpY2s8VXNlckl0ZW0sICdpZCcgfCAncm9sZSc+ICYge1xuICAgICAgICAgICAgICBvcmc6IFBpY2s8T3JnYW5pemF0aW9uSXRlbSwgJ2lkJz4gfCBudWxsO1xuICAgICAgICAgICAgICBwcm9qZWN0OiBQaWNrPFByb2plY3RJdGVtLCAnaWQnPiB8IG51bGw7XG4gICAgICAgICAgICB9KVxuICAgICAgICAgIHwgbnVsbDtcblxuICAgICAgICBpZiAoIXVzZXJXaXRoUmVsYXRpb25zKSByZXR1cm4gZmFsc2U7XG5cbiAgICAgICAgLy8gUm9sZSBoaWVyYXJjaHkgY2hlY2s6IGFkbWlucyBjYW5ub3QgZWRpdCB1c2VycyB3aXRoIGhpZ2hlciByb2xlc1xuICAgICAgICBpZiAoIWNhbkVkaXRVc2VyQnlSb2xlKHNlc3Npb24/LnJvbGUgYXMgVXNlclJvbGUgfCBudWxsLCB1c2VyV2l0aFJlbGF0aW9ucy5yb2xlIGFzIFVzZXJSb2xlIHwgbnVsbCkpXG4gICAgICAgICAgcmV0dXJuIGZhbHNlO1xuXG4gICAgICAgIC8vIE9yZyBhZG1pbnMgKE9SR19BRE1JTiBhbmQgT1JHX09XTkVSKSBjYW4gdXBkYXRlIHVzZXJzIGluIHRoZWlyIG9yZ1xuICAgICAgICBpZiAoaXNPcmdBZG1pbih7IHNlc3Npb24gfSkpIHtcbiAgICAgICAgICBpZiAoIXNlc3Npb24/Lm9yZ0lkKSByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgaWYgKCF1c2VyV2l0aFJlbGF0aW9ucy5vcmc/LmlkKSByZXR1cm4gZmFsc2U7XG5cbiAgICAgICAgICAvLyBDb21wYXJlIG9yZyBJRHMgYXMgc3RyaW5ncyB0byBlbnN1cmUgcHJvcGVyIGNvbXBhcmlzb25cbiAgICAgICAgICByZXR1cm4gU3RyaW5nKHVzZXJXaXRoUmVsYXRpb25zLm9yZy5pZCkgPT09IFN0cmluZyhzZXNzaW9uLm9yZ0lkKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIFByb2plY3QgYWRtaW5zIGNhbiB1cGRhdGUgdXNlcnMgaW4gdGhlaXIgcHJvamVjdFxuICAgICAgICBpZiAoaXNQcm9qZWN0QWRtaW4oeyBzZXNzaW9uIH0pKSB7XG4gICAgICAgICAgaWYgKCFzZXNzaW9uPy5wcm9qZWN0SWQgfHwgIXNlc3Npb24/Lm9yZ0lkKSByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgaWYgKCF1c2VyV2l0aFJlbGF0aW9ucy5wcm9qZWN0Py5pZCB8fCAhdXNlcldpdGhSZWxhdGlvbnMub3JnPy5pZCkgcmV0dXJuIGZhbHNlO1xuXG4gICAgICAgICAgLy8gTXVzdCBiZSBpbiBzYW1lIHByb2plY3QgYW5kIHNhbWUgb3JnXG4gICAgICAgICAgcmV0dXJuIChcbiAgICAgICAgICAgIFN0cmluZyh1c2VyV2l0aFJlbGF0aW9ucy5wcm9qZWN0LmlkKSA9PT0gU3RyaW5nKHNlc3Npb24ucHJvamVjdElkKSAmJlxuICAgICAgICAgICAgU3RyaW5nKHVzZXJXaXRoUmVsYXRpb25zLm9yZy5pZCkgPT09IFN0cmluZyhzZXNzaW9uLm9yZ0lkKVxuICAgICAgICAgICk7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICB9XG4gICAgfSxcbiAgICBmaWx0ZXI6IHtcbiAgICAgIHF1ZXJ5OiBhc3luYyAoeyBzZXNzaW9uIH0pID0+IHtcbiAgICAgICAgaWYgKCFpc0F1dGhlbnRpY2F0ZWQoeyBzZXNzaW9uIH0pKSByZXR1cm4gZmFsc2U7XG4gICAgICAgIGlmIChpc0dvZCh7IHNlc3Npb24gfSkpIHJldHVybiB0cnVlO1xuICAgICAgICBpZiAoaXNPcmdBZG1pbih7IHNlc3Npb24gfSkpIHJldHVybiBmaWx0ZXJCeVVzZXJPcmcoeyBzZXNzaW9uIH0pO1xuICAgICAgICBpZiAoaXNQcm9qZWN0QWRtaW4oeyBzZXNzaW9uIH0pKSByZXR1cm4gZmlsdGVyQnlVc2VyUHJvamVjdCh7IHNlc3Npb24gfSk7XG4gICAgICAgIHJldHVybiBpc1NlbGYoeyBzZXNzaW9uIH0pO1xuICAgICAgfVxuICAgIH1cbiAgfSxcbiAgaG9va3M6IHtcbiAgICByZXNvbHZlSW5wdXQ6IHtcbiAgICAgIGNyZWF0ZTogYXN5bmMgKHsgcmVzb2x2ZWREYXRhIH0pID0+ICh7XG4gICAgICAgIC4uLnJlc29sdmVkRGF0YSxcbiAgICAgICAgZW1haWw6IHJlc29sdmVkRGF0YS5lbWFpbD8udG9Mb3dlckNhc2UoKSxcbiAgICAgICAgcHJvdmlkZXJBY2NvdW50SWQ6IHJlc29sdmVkRGF0YS5wcm92aWRlckFjY291bnRJZCB8fCByYW5kb21VVUlEKClcbiAgICAgIH0pLFxuICAgICAgdXBkYXRlOiBhc3luYyAoeyByZXNvbHZlZERhdGEgfSkgPT4gKHtcbiAgICAgICAgLi4ucmVzb2x2ZWREYXRhLFxuICAgICAgICBlbWFpbDogdHlwZW9mIHJlc29sdmVkRGF0YS5lbWFpbCA9PT0gJ3N0cmluZycgPyByZXNvbHZlZERhdGEuZW1haWwudG9Mb3dlckNhc2UoKSA6IHJlc29sdmVkRGF0YS5lbWFpbCxcbiAgICAgICAgcHJvdmlkZXJBY2NvdW50SWQ6IHJlc29sdmVkRGF0YS5wcm92aWRlckFjY291bnRJZCB8fCByYW5kb21VVUlEKClcbiAgICAgIH0pXG4gICAgfSxcbiAgICB2YWxpZGF0ZUlucHV0OiBhc3luYyAoeyBvcGVyYXRpb24sIHJlc29sdmVkRGF0YSwgaXRlbSwgY29udGV4dCwgYWRkVmFsaWRhdGlvbkVycm9yIH0pID0+IHtcbiAgICAgIGNvbnN0IGV4aXN0aW5nVXNlciA9IGl0ZW0/LmlkXG4gICAgICAgID8gKChhd2FpdCBjb250ZXh0LnF1ZXJ5LlVzZXIuZmluZE9uZSh7XG4gICAgICAgICAgICB3aGVyZTogeyBpZDogaXRlbS5pZCBhcyBzdHJpbmcgfSxcbiAgICAgICAgICAgIHF1ZXJ5OiAnaWQgb3JnIHsgaWQgfSBwcm9qZWN0IHsgaWQgfSByb2xlJ1xuICAgICAgICAgIH0pKSBhc1xuICAgICAgICAgICAgfCAoUGljazxVc2VySXRlbSwgJ2lkJyB8ICdyb2xlJz4gJiB7XG4gICAgICAgICAgICAgICAgb3JnOiBQaWNrPE9yZ2FuaXphdGlvbkl0ZW0sICdpZCc+IHwgbnVsbDtcbiAgICAgICAgICAgICAgICBwcm9qZWN0OiBQaWNrPFByb2plY3RJdGVtLCAnaWQnPiB8IG51bGw7XG4gICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICB8IG51bGwpXG4gICAgICAgIDogbnVsbDtcblxuICAgICAgLy8gQ2hlY2sgaWYgdXNlciBpcyB0cnlpbmcgdG8gZWRpdCB0aGVtc2VsdmVzXG4gICAgICBjb25zdCBzZXNzaW9uID0gY29udGV4dC5zZXNzaW9uIGFzIFNlc3Npb24gfCBudWxsO1xuICAgICAgY29uc3QgaXNFZGl0aW5nU2VsZiA9XG4gICAgICAgIG9wZXJhdGlvbiA9PT0gJ3VwZGF0ZScgJiYgZXhpc3RpbmdVc2VyICYmIHNlc3Npb24/LmlkICYmIFN0cmluZyhleGlzdGluZ1VzZXIuaWQpID09PSBTdHJpbmcoc2Vzc2lvbi5pZCk7XG5cbiAgICAgIC8vIFByZXZlbnQgc2VsZi1lZGl0aW5nIG9mIHJvbGUgKGFsd2F5cylcbiAgICAgIGlzRWRpdGluZ1NlbGYgJiYgcmVzb2x2ZWREYXRhLnJvbGUgJiYgYWRkVmFsaWRhdGlvbkVycm9yKCdZb3UgY2Fubm90IGVkaXQgeW91ciBvd24gcm9sZS4nKTtcblxuICAgICAgLy8gUHJldmVudCBzZWxmLWVkaXRpbmcgb2YgaXNBY3RpdmUgKGFsd2F5cylcbiAgICAgIGlzRWRpdGluZ1NlbGYgJiZcbiAgICAgICAgcmVzb2x2ZWREYXRhLmlzQWN0aXZlICE9PSB1bmRlZmluZWQgJiZcbiAgICAgICAgYWRkVmFsaWRhdGlvbkVycm9yKCdZb3UgY2Fubm90IGVkaXQgeW91ciBvd24gYWN0aXZlIHN0YXR1cy4nKTtcblxuICAgICAgLy8gUHJldmVudCBzZWxmLWVkaXRpbmcgb2YgcHJvamVjdCB1bmxlc3MgT1JHX09XTkVSL09SR19BRE1JTlxuICAgICAgaXNFZGl0aW5nU2VsZiAmJlxuICAgICAgICByZXNvbHZlZERhdGEucHJvamVjdCAmJlxuICAgICAgICBzZXNzaW9uPy5yb2xlICE9PSBVc2VyUm9sZS5PUkdfQURNSU4gJiZcbiAgICAgICAgc2Vzc2lvbj8ucm9sZSAhPT0gVXNlclJvbGUuT1JHX09XTkVSICYmXG4gICAgICAgIGFkZFZhbGlkYXRpb25FcnJvcignWW91IGNhbm5vdCBlZGl0IHlvdXIgb3duIHByb2plY3QuJyk7XG5cbiAgICAgIGNvbnN0IHJlc29sdmVSZWxhdGlvbnNoaXBJZCA9IChpbnB1dDogUmVsYXRpb25zaGlwSW5wdXQgfCB1bmtub3duLCBleGlzdGluZ0lkOiBzdHJpbmcgfCBudWxsKTogc3RyaW5nIHwgbnVsbCA9PiB7XG4gICAgICAgIGNvbnN0IHR5cGVkSW5wdXQgPSBpbnB1dCBhcyBSZWxhdGlvbnNoaXBJbnB1dDtcbiAgICAgICAgaWYgKCF0eXBlZElucHV0KSByZXR1cm4gZXhpc3RpbmdJZCA/PyBudWxsO1xuXG4gICAgICAgIGNvbnN0IGdldERpc2Nvbm5lY3RlZElkID0gKCk6IHN0cmluZyB8IG51bGwgPT4ge1xuICAgICAgICAgIGlmICghKCdkaXNjb25uZWN0JyBpbiB0eXBlZElucHV0KSB8fCAhdHlwZWRJbnB1dC5kaXNjb25uZWN0KSByZXR1cm4gbnVsbDtcbiAgICAgICAgICBpZiAodHlwZWRJbnB1dC5kaXNjb25uZWN0ID09PSB0cnVlKSByZXR1cm4gbnVsbDtcbiAgICAgICAgICBpZiAoQXJyYXkuaXNBcnJheSh0eXBlZElucHV0LmRpc2Nvbm5lY3QpICYmIHR5cGVkSW5wdXQuZGlzY29ubmVjdC5sZW5ndGggPiAwKSByZXR1cm4gbnVsbDtcbiAgICAgICAgICByZXR1cm4gZXhpc3RpbmdJZCA/PyBudWxsO1xuICAgICAgICB9O1xuXG4gICAgICAgIGNvbnN0IGdldENvbm5lY3RlZElkID0gKCk6IHN0cmluZyB8IG51bGwgPT4ge1xuICAgICAgICAgIGlmICghKCdjb25uZWN0JyBpbiB0eXBlZElucHV0KSB8fCAhdHlwZWRJbnB1dC5jb25uZWN0KSByZXR1cm4gbnVsbDtcbiAgICAgICAgICBpZiAoQXJyYXkuaXNBcnJheSh0eXBlZElucHV0LmNvbm5lY3QpKSByZXR1cm4gdHlwZWRJbnB1dC5jb25uZWN0WzBdPy5pZCBhcyBzdHJpbmcgfCBudWxsO1xuICAgICAgICAgIHJldHVybiB0eXBlZElucHV0LmNvbm5lY3QuaWQgYXMgc3RyaW5nIHwgbnVsbDtcbiAgICAgICAgfTtcblxuICAgICAgICBjb25zdCBnZXRTZXRJZCA9ICgpOiBzdHJpbmcgfCBudWxsID0+IHtcbiAgICAgICAgICBpZiAoISgnc2V0JyBpbiB0eXBlZElucHV0KSB8fCB0eXBlZElucHV0LnNldCA9PT0gdW5kZWZpbmVkKSByZXR1cm4gbnVsbDtcbiAgICAgICAgICBpZiAodHlwZWRJbnB1dC5zZXQgPT09IG51bGwpIHJldHVybiBudWxsO1xuICAgICAgICAgIGlmIChBcnJheS5pc0FycmF5KHR5cGVkSW5wdXQuc2V0KSkgcmV0dXJuIHR5cGVkSW5wdXQuc2V0WzBdPy5pZCBhcyBzdHJpbmcgfCBudWxsO1xuICAgICAgICAgIHJldHVybiB0eXBlZElucHV0LnNldD8uaWQgYXMgc3RyaW5nIHwgbnVsbDtcbiAgICAgICAgfTtcblxuICAgICAgICByZXR1cm4gZ2V0RGlzY29ubmVjdGVkSWQoKSA/PyBnZXRDb25uZWN0ZWRJZCgpID8/IGdldFNldElkKCkgPz8gZXhpc3RpbmdJZCA/PyBudWxsO1xuICAgICAgfTtcblxuICAgICAgY29uc3QgZ2V0QWxsb3dlZFJvbGVzRm9yQWRtaW4gPSAoYWRtaW5Sb2xlOiBVc2VyUm9sZSk6IFVzZXJSb2xlW10gPT4ge1xuICAgICAgICBjb25zdCBiYXNlUm9sZXM6IFVzZXJSb2xlW10gPSBbVXNlclJvbGUuVVNFUl07XG4gICAgICAgIGNvbnN0IHJvbGVNYXA6IFJlY29yZDxVc2VyUm9sZSwgVXNlclJvbGVbXT4gPSB7XG4gICAgICAgICAgW1VzZXJSb2xlLlVTRVJdOiBiYXNlUm9sZXMsXG4gICAgICAgICAgW1VzZXJSb2xlLlBST0pFQ1RfQURNSU5dOiBbLi4uYmFzZVJvbGVzLCBVc2VyUm9sZS5QUk9KRUNUX0FETUlOXSxcbiAgICAgICAgICBbVXNlclJvbGUuT1JHX0FETUlOXTogWy4uLmJhc2VSb2xlcywgVXNlclJvbGUuUFJPSkVDVF9BRE1JTiwgVXNlclJvbGUuT1JHX0FETUlOXSxcbiAgICAgICAgICBbVXNlclJvbGUuT1JHX09XTkVSXTogWy4uLmJhc2VSb2xlcywgVXNlclJvbGUuUFJPSkVDVF9BRE1JTiwgVXNlclJvbGUuT1JHX0FETUlOLCBVc2VyUm9sZS5PUkdfT1dORVJdLFxuICAgICAgICAgIFtVc2VyUm9sZS5HT0RdOiBbLi4uYmFzZVJvbGVzLCBVc2VyUm9sZS5QUk9KRUNUX0FETUlOLCBVc2VyUm9sZS5PUkdfQURNSU4sIFVzZXJSb2xlLk9SR19PV05FUl1cbiAgICAgICAgfTtcbiAgICAgICAgcmV0dXJuIHJvbGVNYXBbYWRtaW5Sb2xlXSA/PyBiYXNlUm9sZXM7XG4gICAgICB9O1xuXG4gICAgICBjb25zdCB2YWxpZGF0ZVJvbGVBc3NpZ25tZW50ID0gKGFzc2lnbmVkUm9sZTogVXNlclJvbGUsIGFkbWluUm9sZTogVXNlclJvbGUgfCBudWxsIHwgdW5kZWZpbmVkKTogdm9pZCA9PiB7XG4gICAgICAgIGlmICghYWRtaW5Sb2xlKSByZXR1cm47XG5cbiAgICAgICAgaWYgKGFzc2lnbmVkUm9sZSA9PT0gVXNlclJvbGUuR09EKSB7XG4gICAgICAgICAgYWRkVmFsaWRhdGlvbkVycm9yKCdHT0Qgcm9sZSBjYW5ub3QgYmUgYXNzaWduZWQgdmlhIEFQSS4gSXQgY2FuIG9ubHkgYmUgc2V0IGRpcmVjdGx5IGluIHRoZSBkYXRhYmFzZS4nKTtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCBhbGxvd2VkUm9sZXMgPSBnZXRBbGxvd2VkUm9sZXNGb3JBZG1pbihhZG1pblJvbGUpO1xuICAgICAgICBpZiAoIWFsbG93ZWRSb2xlcy5pbmNsdWRlcyhhc3NpZ25lZFJvbGUpKSB7XG4gICAgICAgICAgYWRkVmFsaWRhdGlvbkVycm9yKCdZb3UgY2Fubm90IGFzc2lnbiB0aGlzIHJvbGUuIFlvdSBjYW4gb25seSBhc3NpZ24gcm9sZXMgdXAgdG8geW91ciBvd24gcGVybWlzc2lvbiBsZXZlbC4nKTtcbiAgICAgICAgfVxuICAgICAgfTtcblxuICAgICAgY29uc3QgdmFsaWRhdGVQcm9qZWN0UmVzdHJpY3Rpb24gPSAoXG4gICAgICAgIG9wZXJhdGlvbjogc3RyaW5nLFxuICAgICAgICBuZXh0UHJvamVjdElkOiBzdHJpbmcgfCBudWxsLFxuICAgICAgICBhZG1pblJvbGU6IFVzZXJSb2xlIHwgbnVsbCB8IHVuZGVmaW5lZCxcbiAgICAgICAgYWRtaW5Qcm9qZWN0SWQ6IHN0cmluZyB8IG51bGwgfCB1bmRlZmluZWRcbiAgICAgICk6IHZvaWQgPT4ge1xuICAgICAgICBjb25zdCBpc1Byb2plY3RBZG1pbkNyZWF0aW5nID0gb3BlcmF0aW9uID09PSAnY3JlYXRlJyAmJiBhZG1pblJvbGUgPT09IFVzZXJSb2xlLlBST0pFQ1RfQURNSU4gJiYgYWRtaW5Qcm9qZWN0SWQ7XG4gICAgICAgIGlmIChpc1Byb2plY3RBZG1pbkNyZWF0aW5nICYmIG5leHRQcm9qZWN0SWQgJiYgU3RyaW5nKG5leHRQcm9qZWN0SWQpICE9PSBTdHJpbmcoYWRtaW5Qcm9qZWN0SWQpKSB7XG4gICAgICAgICAgYWRkVmFsaWRhdGlvbkVycm9yKCdQcm9qZWN0IEFkbWlucyBjYW4gb25seSBjcmVhdGUgdXNlcnMgaW4gdGhlaXIgb3duIHByb2plY3QuJyk7XG4gICAgICAgIH1cbiAgICAgIH07XG5cbiAgICAgIGNvbnN0IHZhbGlkYXRlUHJvdmlzaW9uaW5nID0gKFxuICAgICAgICBvcGVyYXRpb246IHN0cmluZyxcbiAgICAgICAgbmV4dE9yZ0lkOiBzdHJpbmcgfCBudWxsLFxuICAgICAgICBuZXh0UHJvamVjdElkOiBzdHJpbmcgfCBudWxsLFxuICAgICAgICBleGlzdGluZ09yZ0lkOiBzdHJpbmcgfCBudWxsLFxuICAgICAgICBleGlzdGluZ1Byb2plY3RJZDogc3RyaW5nIHwgbnVsbFxuICAgICAgKTogdm9pZCA9PiB7XG4gICAgICAgIGNvbnN0IGlzVW5wcm92aXNpb25lZCA9ICFuZXh0T3JnSWQgJiYgIW5leHRQcm9qZWN0SWQ7XG4gICAgICAgIGNvbnN0IGlzSW5pdGlhbFByb3Zpc2lvbiA9IG9wZXJhdGlvbiA9PT0gJ2NyZWF0ZScgJiYgaXNVbnByb3Zpc2lvbmVkO1xuICAgICAgICBjb25zdCBpc0V4aXN0aW5nVW5wcm92aXNpb25lZCA9XG4gICAgICAgICAgb3BlcmF0aW9uID09PSAndXBkYXRlJyAmJiBpc1VucHJvdmlzaW9uZWQgJiYgIWV4aXN0aW5nT3JnSWQgJiYgIWV4aXN0aW5nUHJvamVjdElkO1xuXG4gICAgICAgIGlmICghaXNJbml0aWFsUHJvdmlzaW9uICYmICFpc0V4aXN0aW5nVW5wcm92aXNpb25lZCAmJiAoIW5leHRPcmdJZCB8fCAhbmV4dFByb2plY3RJZCkpIHtcbiAgICAgICAgICBhZGRWYWxpZGF0aW9uRXJyb3IoJ1VzZXJzIG11c3QgYmVsb25nIHRvIGJvdGggYW4gb3JnYW5pemF0aW9uIGFuZCBhIHByb2plY3Qgb25jZSBwcm92aXNpb25lZC4nKTtcbiAgICAgICAgfVxuICAgICAgfTtcblxuICAgICAgY29uc3QgdmFsaWRhdGVQcm9qZWN0T3JnTWF0Y2ggPSBhc3luYyAoXG4gICAgICAgIG5leHRPcmdJZDogc3RyaW5nIHwgbnVsbCxcbiAgICAgICAgbmV4dFByb2plY3RJZDogc3RyaW5nIHwgbnVsbCxcbiAgICAgICAgY29udGV4dDogQ29udGV4dFxuICAgICAgKTogUHJvbWlzZTx2b2lkPiA9PiB7XG4gICAgICAgIGlmICghbmV4dE9yZ0lkIHx8ICFuZXh0UHJvamVjdElkKSByZXR1cm47XG5cbiAgICAgICAgY29uc3QgcHJvamVjdCA9IChhd2FpdCBjb250ZXh0LnF1ZXJ5LlByb2plY3QuZmluZE9uZSh7XG4gICAgICAgICAgd2hlcmU6IHsgaWQ6IG5leHRQcm9qZWN0SWQgfSxcbiAgICAgICAgICBxdWVyeTogJ2lkIG9yZyB7IGlkIH0nXG4gICAgICAgIH0pKSBhcyAoUGljazxQcm9qZWN0SXRlbSwgJ2lkJz4gJiB7IG9yZzogUGljazxPcmdhbml6YXRpb25JdGVtLCAnaWQnPiB8IG51bGwgfSkgfCBudWxsO1xuXG4gICAgICAgIGNvbnN0IHByb2plY3RPcmdJZCA9IHByb2plY3Q/Lm9yZz8uaWQgPz8gbnVsbDtcbiAgICAgICAgaWYgKHByb2plY3RPcmdJZCAmJiBwcm9qZWN0T3JnSWQgIT09IG5leHRPcmdJZCkge1xuICAgICAgICAgIGFkZFZhbGlkYXRpb25FcnJvcihcIlNlbGVjdGVkIHByb2plY3QgZG9lcyBub3QgYmVsb25nIHRvIHRoZSB1c2VyJ3Mgb3JnYW5pemF0aW9uLlwiKTtcbiAgICAgICAgfVxuICAgICAgfTtcblxuICAgICAgY29uc3QgbmV4dE9yZ0lkID0gcmVzb2x2ZVJlbGF0aW9uc2hpcElkKHJlc29sdmVkRGF0YS5vcmcsIGV4aXN0aW5nVXNlcj8ub3JnPy5pZCA/PyBudWxsKTtcbiAgICAgIGNvbnN0IG5leHRQcm9qZWN0SWQgPSByZXNvbHZlUmVsYXRpb25zaGlwSWQocmVzb2x2ZWREYXRhLnByb2plY3QsIGV4aXN0aW5nVXNlcj8ucHJvamVjdD8uaWQgPz8gbnVsbCk7XG5cbiAgICAgIHJlc29sdmVkRGF0YS5yb2xlICYmIHZhbGlkYXRlUm9sZUFzc2lnbm1lbnQocmVzb2x2ZWREYXRhLnJvbGUgYXMgVXNlclJvbGUsIHNlc3Npb24/LnJvbGUpO1xuXG4gICAgICB2YWxpZGF0ZVByb2plY3RSZXN0cmljdGlvbihvcGVyYXRpb24sIG5leHRQcm9qZWN0SWQsIHNlc3Npb24/LnJvbGUsIHNlc3Npb24/LnByb2plY3RJZCk7XG5cbiAgICAgIHZhbGlkYXRlUHJvdmlzaW9uaW5nKFxuICAgICAgICBvcGVyYXRpb24sXG4gICAgICAgIG5leHRPcmdJZCxcbiAgICAgICAgbmV4dFByb2plY3RJZCxcbiAgICAgICAgZXhpc3RpbmdVc2VyPy5vcmc/LmlkID8/IG51bGwsXG4gICAgICAgIGV4aXN0aW5nVXNlcj8ucHJvamVjdD8uaWQgPz8gbnVsbFxuICAgICAgKTtcblxuICAgICAgYXdhaXQgdmFsaWRhdGVQcm9qZWN0T3JnTWF0Y2gobmV4dE9yZ0lkLCBuZXh0UHJvamVjdElkLCBjb250ZXh0KTtcbiAgICB9XG4gIH1cbn0pIHNhdGlzZmllcyBMaXN0c1snVXNlciddO1xuIl0sIm5hbWVzIjpbImNsb3VkaW5hcnlJbWFnZSIsImdyYXBocWwiLCJnIiwibGlzdCIsImFsbE9wZXJhdGlvbnMiLCJkZW55QWxsIiwiY2hlY2tib3giLCJqc29uIiwicmVsYXRpb25zaGlwIiwic2VsZWN0IiwidGV4dCIsInRpbWVzdGFtcCIsInZpcnR1YWwiLCJyYW5kb21VVUlEIiwiZW52IiwiY2FuRWRpdFVzZXJCeVJvbGUiLCJmaWx0ZXJCeVVzZXJPcmciLCJmaWx0ZXJCeVVzZXJQcm9qZWN0IiwiaXNBbnlBZG1pbiIsImlzQXV0aGVudGljYXRlZCIsImlzR29kIiwiaXNPcmdBZG1pbiIsImlzT3JnQWRtaW5PckFib3ZlIiwiaXNQcm9qZWN0QWRtaW4iLCJpc1NlbGYiLCJVc2VyUm9sZSIsInZhbGlkYXRpb24iLCJpc1JlcXVpcmVkIiwic29jaWFsTG9naW5PcHRzIiwibGFiZWwiLCJ2YWx1ZSIsInVzZXJSb2xlT3B0aW9ucyIsIlVTRVIiLCJQUk9KRUNUX0FETUlOIiwiT1JHX0FETUlOIiwiT1JHX09XTkVSIiwiR09EIiwiZmllbGRzIiwiYXZhdGFyU29jaWFsVXJsIiwidWkiLCJjcmVhdGVWaWV3IiwiZmllbGRNb2RlIiwiaXRlbVZpZXciLCJhdmF0YXJVcGxvYWRlZCIsImNsb3VkaW5hcnkiLCJjbG91ZE5hbWUiLCJDTE9VRElOQVJZX0NMT1VEX05BTUUiLCJhcGlLZXkiLCJDTE9VRElOQVJZX0FQSV9LRVkiLCJhcGlTZWNyZXQiLCJDTE9VRElOQVJZX0FQSV9TRUNSRVQiLCJmb2xkZXIiLCJDTE9VRElOQVJZX0FQSV9GT0xERVIiLCJhdmF0YXJVcmwiLCJmaWVsZCIsInR5cGUiLCJTdHJpbmciLCJyZXNvbHZlIiwiaXRlbSIsInB1YmxpY1VybCIsImVtYWlsIiwiaXNJbmRleGVkIiwiaXNGaWx0ZXJhYmxlIiwiZmlyc3ROYW1lIiwibGFzdE5hbWUiLCJkaXNwbGF5TmFtZSIsIm5hbWUiLCJmaWx0ZXIiLCJCb29sZWFuIiwiam9pbiIsInJvbGUiLCJvcHRpb25zIiwiZGVmYXVsdFZhbHVlIiwiYWNjZXNzIiwicmVhZCIsImNyZWF0ZSIsInVwZGF0ZSIsInByb3ZpZGVyQWNjb3VudElkIiwicHJvdmlkZXIiLCJyYXdBdXRoIiwib3JnIiwicmVmIiwibWFueSIsInByb2plY3QiLCJpc0FjdGl2ZSIsImNyZWF0ZWRBdCIsImtpbmQiLCJwcm92aXNpb25lZEF0IiwidXBkYXRlZEF0IiwiZGIiLCJzZWVuQXQiLCJsYWJlbEZpZWxkIiwib3BlcmF0aW9uIiwicXVlcnkiLCJzZXNzaW9uIiwiZGVsZXRlIiwiYXJncyIsInR5cGVkQXJncyIsIml0ZW1JZCIsImNvbnRleHQiLCJvcmdJZCIsInVzZXIiLCJzdWRvIiwiVXNlciIsImZpbmRPbmUiLCJ3aGVyZSIsImlkIiwidGFyZ2V0VXNlcklkIiwic2Vzc2lvbklkIiwic3Vkb0NvbnRleHQiLCJ1c2VyV2l0aFJlbGF0aW9ucyIsInByb2plY3RJZCIsImhvb2tzIiwicmVzb2x2ZUlucHV0IiwicmVzb2x2ZWREYXRhIiwidG9Mb3dlckNhc2UiLCJ2YWxpZGF0ZUlucHV0IiwiYWRkVmFsaWRhdGlvbkVycm9yIiwiZXhpc3RpbmdVc2VyIiwiaXNFZGl0aW5nU2VsZiIsInVuZGVmaW5lZCIsInJlc29sdmVSZWxhdGlvbnNoaXBJZCIsImlucHV0IiwiZXhpc3RpbmdJZCIsInR5cGVkSW5wdXQiLCJnZXREaXNjb25uZWN0ZWRJZCIsImRpc2Nvbm5lY3QiLCJBcnJheSIsImlzQXJyYXkiLCJsZW5ndGgiLCJnZXRDb25uZWN0ZWRJZCIsImNvbm5lY3QiLCJnZXRTZXRJZCIsInNldCIsImdldEFsbG93ZWRSb2xlc0ZvckFkbWluIiwiYWRtaW5Sb2xlIiwiYmFzZVJvbGVzIiwicm9sZU1hcCIsInZhbGlkYXRlUm9sZUFzc2lnbm1lbnQiLCJhc3NpZ25lZFJvbGUiLCJhbGxvd2VkUm9sZXMiLCJpbmNsdWRlcyIsInZhbGlkYXRlUHJvamVjdFJlc3RyaWN0aW9uIiwibmV4dFByb2plY3RJZCIsImFkbWluUHJvamVjdElkIiwiaXNQcm9qZWN0QWRtaW5DcmVhdGluZyIsInZhbGlkYXRlUHJvdmlzaW9uaW5nIiwibmV4dE9yZ0lkIiwiZXhpc3RpbmdPcmdJZCIsImV4aXN0aW5nUHJvamVjdElkIiwiaXNVbnByb3Zpc2lvbmVkIiwiaXNJbml0aWFsUHJvdmlzaW9uIiwiaXNFeGlzdGluZ1VucHJvdmlzaW9uZWQiLCJ2YWxpZGF0ZVByb2plY3RPcmdNYXRjaCIsIlByb2plY3QiLCJwcm9qZWN0T3JnSWQiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(api)/../../schemas/User.ts\n");

/***/ }),

/***/ "(api)/../../schemas/extensions/Chat.ts":
/*!****************************************!*\
  !*** ../../schemas/extensions/Chat.ts ***!
  \****************************************/
/***/ ((module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.a(module, async (__webpack_handle_async_dependencies__, __webpack_async_result__) => { try {\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   ChatExtension: () => (/* binding */ ChatExtension)\n/* harmony export */ });\n/* harmony import */ var _keystone_6_core__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @keystone-6/core */ \"@keystone-6/core\");\n/* harmony import */ var _keystone_6_core__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_keystone_6_core__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _services_chat__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../services/chat */ \"(api)/../../services/chat.ts\");\nvar __webpack_async_dependencies__ = __webpack_handle_async_dependencies__([_services_chat__WEBPACK_IMPORTED_MODULE_1__]);\n_services_chat__WEBPACK_IMPORTED_MODULE_1__ = (__webpack_async_dependencies__.then ? (await __webpack_async_dependencies__)() : __webpack_async_dependencies__)[0];\n\n\nconst ChatSegmentReference = _keystone_6_core__WEBPACK_IMPORTED_MODULE_0__.graphql.object()({\n    name: \"ChatSegmentReference\",\n    fields: {\n        id: _keystone_6_core__WEBPACK_IMPORTED_MODULE_0__.graphql.field({\n            type: _keystone_6_core__WEBPACK_IMPORTED_MODULE_0__.graphql.nonNull(_keystone_6_core__WEBPACK_IMPORTED_MODULE_0__.graphql.ID)\n        }),\n        text: _keystone_6_core__WEBPACK_IMPORTED_MODULE_0__.graphql.field({\n            type: _keystone_6_core__WEBPACK_IMPORTED_MODULE_0__.graphql.nonNull(_keystone_6_core__WEBPACK_IMPORTED_MODULE_0__.graphql.String)\n        }),\n        startMs: _keystone_6_core__WEBPACK_IMPORTED_MODULE_0__.graphql.field({\n            type: _keystone_6_core__WEBPACK_IMPORTED_MODULE_0__.graphql.Int\n        }),\n        endMs: _keystone_6_core__WEBPACK_IMPORTED_MODULE_0__.graphql.field({\n            type: _keystone_6_core__WEBPACK_IMPORTED_MODULE_0__.graphql.Int\n        }),\n        speaker: _keystone_6_core__WEBPACK_IMPORTED_MODULE_0__.graphql.field({\n            type: _keystone_6_core__WEBPACK_IMPORTED_MODULE_0__.graphql.String\n        }),\n        transcriptTitle: _keystone_6_core__WEBPACK_IMPORTED_MODULE_0__.graphql.field({\n            type: _keystone_6_core__WEBPACK_IMPORTED_MODULE_0__.graphql.String\n        })\n    }\n});\nconst ChatMessageResult = _keystone_6_core__WEBPACK_IMPORTED_MODULE_0__.graphql.object()({\n    name: \"ChatMessageResult\",\n    fields: {\n        id: _keystone_6_core__WEBPACK_IMPORTED_MODULE_0__.graphql.field({\n            type: _keystone_6_core__WEBPACK_IMPORTED_MODULE_0__.graphql.nonNull(_keystone_6_core__WEBPACK_IMPORTED_MODULE_0__.graphql.ID)\n        }),\n        role: _keystone_6_core__WEBPACK_IMPORTED_MODULE_0__.graphql.field({\n            type: _keystone_6_core__WEBPACK_IMPORTED_MODULE_0__.graphql.nonNull(_keystone_6_core__WEBPACK_IMPORTED_MODULE_0__.graphql.String)\n        }),\n        content: _keystone_6_core__WEBPACK_IMPORTED_MODULE_0__.graphql.field({\n            type: _keystone_6_core__WEBPACK_IMPORTED_MODULE_0__.graphql.nonNull(_keystone_6_core__WEBPACK_IMPORTED_MODULE_0__.graphql.String)\n        }),\n        createdAt: _keystone_6_core__WEBPACK_IMPORTED_MODULE_0__.graphql.field({\n            type: _keystone_6_core__WEBPACK_IMPORTED_MODULE_0__.graphql.String\n        }),\n        segments: _keystone_6_core__WEBPACK_IMPORTED_MODULE_0__.graphql.field({\n            type: _keystone_6_core__WEBPACK_IMPORTED_MODULE_0__.graphql.nonNull(_keystone_6_core__WEBPACK_IMPORTED_MODULE_0__.graphql.list(_keystone_6_core__WEBPACK_IMPORTED_MODULE_0__.graphql.nonNull(ChatSegmentReference)))\n        })\n    }\n});\nconst ChatHistoryResult = _keystone_6_core__WEBPACK_IMPORTED_MODULE_0__.graphql.object()({\n    name: \"ChatHistoryResult\",\n    fields: {\n        chatId: _keystone_6_core__WEBPACK_IMPORTED_MODULE_0__.graphql.field({\n            type: _keystone_6_core__WEBPACK_IMPORTED_MODULE_0__.graphql.ID\n        }),\n        messages: _keystone_6_core__WEBPACK_IMPORTED_MODULE_0__.graphql.field({\n            type: _keystone_6_core__WEBPACK_IMPORTED_MODULE_0__.graphql.nonNull(_keystone_6_core__WEBPACK_IMPORTED_MODULE_0__.graphql.list(_keystone_6_core__WEBPACK_IMPORTED_MODULE_0__.graphql.nonNull(ChatMessageResult)))\n        })\n    }\n});\nconst ChatMutationResult = _keystone_6_core__WEBPACK_IMPORTED_MODULE_0__.graphql.object()({\n    name: \"ChatMutationResult\",\n    fields: {\n        chatId: _keystone_6_core__WEBPACK_IMPORTED_MODULE_0__.graphql.field({\n            type: _keystone_6_core__WEBPACK_IMPORTED_MODULE_0__.graphql.nonNull(_keystone_6_core__WEBPACK_IMPORTED_MODULE_0__.graphql.ID)\n        }),\n        answer: _keystone_6_core__WEBPACK_IMPORTED_MODULE_0__.graphql.field({\n            type: _keystone_6_core__WEBPACK_IMPORTED_MODULE_0__.graphql.nonNull(_keystone_6_core__WEBPACK_IMPORTED_MODULE_0__.graphql.String)\n        }),\n        messages: _keystone_6_core__WEBPACK_IMPORTED_MODULE_0__.graphql.field({\n            type: _keystone_6_core__WEBPACK_IMPORTED_MODULE_0__.graphql.nonNull(_keystone_6_core__WEBPACK_IMPORTED_MODULE_0__.graphql.list(_keystone_6_core__WEBPACK_IMPORTED_MODULE_0__.graphql.nonNull(ChatMessageResult)))\n        }),\n        references: _keystone_6_core__WEBPACK_IMPORTED_MODULE_0__.graphql.field({\n            type: _keystone_6_core__WEBPACK_IMPORTED_MODULE_0__.graphql.nonNull(_keystone_6_core__WEBPACK_IMPORTED_MODULE_0__.graphql.list(_keystone_6_core__WEBPACK_IMPORTED_MODULE_0__.graphql.nonNull(ChatSegmentReference)))\n        })\n    }\n});\nconst TranscriptChatInput = _keystone_6_core__WEBPACK_IMPORTED_MODULE_0__.graphql.inputObject({\n    name: \"ChatTranscriptInput\",\n    fields: {\n        chatId: _keystone_6_core__WEBPACK_IMPORTED_MODULE_0__.graphql.arg({\n            type: _keystone_6_core__WEBPACK_IMPORTED_MODULE_0__.graphql.ID\n        }),\n        transcriptId: _keystone_6_core__WEBPACK_IMPORTED_MODULE_0__.graphql.arg({\n            type: _keystone_6_core__WEBPACK_IMPORTED_MODULE_0__.graphql.nonNull(_keystone_6_core__WEBPACK_IMPORTED_MODULE_0__.graphql.ID)\n        }),\n        message: _keystone_6_core__WEBPACK_IMPORTED_MODULE_0__.graphql.arg({\n            type: _keystone_6_core__WEBPACK_IMPORTED_MODULE_0__.graphql.nonNull(_keystone_6_core__WEBPACK_IMPORTED_MODULE_0__.graphql.String)\n        })\n    }\n});\nconst ProjectChatInput = _keystone_6_core__WEBPACK_IMPORTED_MODULE_0__.graphql.inputObject({\n    name: \"ChatProjectInput\",\n    fields: {\n        chatId: _keystone_6_core__WEBPACK_IMPORTED_MODULE_0__.graphql.arg({\n            type: _keystone_6_core__WEBPACK_IMPORTED_MODULE_0__.graphql.ID\n        }),\n        projectId: _keystone_6_core__WEBPACK_IMPORTED_MODULE_0__.graphql.arg({\n            type: _keystone_6_core__WEBPACK_IMPORTED_MODULE_0__.graphql.nonNull(_keystone_6_core__WEBPACK_IMPORTED_MODULE_0__.graphql.ID)\n        }),\n        message: _keystone_6_core__WEBPACK_IMPORTED_MODULE_0__.graphql.arg({\n            type: _keystone_6_core__WEBPACK_IMPORTED_MODULE_0__.graphql.nonNull(_keystone_6_core__WEBPACK_IMPORTED_MODULE_0__.graphql.String)\n        })\n    }\n});\nconst getSession = (context)=>{\n    const session = context.session;\n    if (!session?.id) throw new Error(\"Unauthorized\");\n    return session;\n};\nconst findLatestChat = async ({ context, where })=>{\n    const chats = await context.sudo().query.Chat.findMany({\n        where,\n        orderBy: [\n            {\n                createdAt: \"desc\"\n            }\n        ],\n        take: 1,\n        query: \"id\"\n    });\n    const record = chats?.[0];\n    if (!record?.id) return null;\n    const history = await (0,_services_chat__WEBPACK_IMPORTED_MODULE_1__.loadChatHistory)(context, record.id);\n    return {\n        chatId: record.id,\n        messages: history\n    };\n};\nconst ChatExtension = (base)=>{\n    return {\n        query: {\n            chatTranscriptHistory: _keystone_6_core__WEBPACK_IMPORTED_MODULE_0__.graphql.field({\n                type: _keystone_6_core__WEBPACK_IMPORTED_MODULE_0__.graphql.nonNull(ChatHistoryResult),\n                args: {\n                    transcriptId: _keystone_6_core__WEBPACK_IMPORTED_MODULE_0__.graphql.arg({\n                        type: _keystone_6_core__WEBPACK_IMPORTED_MODULE_0__.graphql.nonNull(_keystone_6_core__WEBPACK_IMPORTED_MODULE_0__.graphql.ID)\n                    })\n                },\n                resolve: async (_root, { transcriptId }, context)=>{\n                    const session = getSession(context);\n                    const history = await findLatestChat({\n                        context,\n                        where: {\n                            contextType: \"TRANSCRIPT\",\n                            transcript: {\n                                id: {\n                                    equals: transcriptId\n                                }\n                            },\n                            org: {\n                                id: {\n                                    equals: session.orgId\n                                }\n                            }\n                        }\n                    });\n                    if (!history) return {\n                        chatId: null,\n                        messages: []\n                    };\n                    return history;\n                }\n            }),\n            chatProjectHistory: _keystone_6_core__WEBPACK_IMPORTED_MODULE_0__.graphql.field({\n                type: _keystone_6_core__WEBPACK_IMPORTED_MODULE_0__.graphql.nonNull(ChatHistoryResult),\n                args: {\n                    projectId: _keystone_6_core__WEBPACK_IMPORTED_MODULE_0__.graphql.arg({\n                        type: _keystone_6_core__WEBPACK_IMPORTED_MODULE_0__.graphql.nonNull(_keystone_6_core__WEBPACK_IMPORTED_MODULE_0__.graphql.ID)\n                    })\n                },\n                resolve: async (_root, { projectId }, context)=>{\n                    const session = getSession(context);\n                    const history = await findLatestChat({\n                        context,\n                        where: {\n                            contextType: \"PROJECT\",\n                            project: {\n                                id: {\n                                    equals: projectId\n                                }\n                            },\n                            org: {\n                                id: {\n                                    equals: session.orgId\n                                }\n                            }\n                        }\n                    });\n                    if (!history) return {\n                        chatId: null,\n                        messages: []\n                    };\n                    return history;\n                }\n            })\n        },\n        mutation: {\n            chatTranscript: _keystone_6_core__WEBPACK_IMPORTED_MODULE_0__.graphql.field({\n                type: _keystone_6_core__WEBPACK_IMPORTED_MODULE_0__.graphql.nonNull(ChatMutationResult),\n                args: {\n                    input: _keystone_6_core__WEBPACK_IMPORTED_MODULE_0__.graphql.arg({\n                        type: _keystone_6_core__WEBPACK_IMPORTED_MODULE_0__.graphql.nonNull(TranscriptChatInput)\n                    })\n                },\n                resolve: async (_root, { input }, context)=>{\n                    const session = getSession(context);\n                    return (0,_services_chat__WEBPACK_IMPORTED_MODULE_1__.runChatConversation)({\n                        context,\n                        session,\n                        contextType: \"TRANSCRIPT\",\n                        input: {\n                            chatId: input.chatId ?? null,\n                            transcriptId: input.transcriptId,\n                            message: input.message\n                        }\n                    });\n                }\n            }),\n            chatProject: _keystone_6_core__WEBPACK_IMPORTED_MODULE_0__.graphql.field({\n                type: _keystone_6_core__WEBPACK_IMPORTED_MODULE_0__.graphql.nonNull(ChatMutationResult),\n                args: {\n                    input: _keystone_6_core__WEBPACK_IMPORTED_MODULE_0__.graphql.arg({\n                        type: _keystone_6_core__WEBPACK_IMPORTED_MODULE_0__.graphql.nonNull(ProjectChatInput)\n                    })\n                },\n                resolve: async (_root, { input }, context)=>{\n                    const session = getSession(context);\n                    return (0,_services_chat__WEBPACK_IMPORTED_MODULE_1__.runChatConversation)({\n                        context,\n                        session,\n                        contextType: \"PROJECT\",\n                        input: {\n                            chatId: input.chatId ?? null,\n                            projectId: input.projectId,\n                            message: input.message\n                        }\n                    });\n                }\n            })\n        }\n    };\n};\n\n__webpack_async_result__();\n} catch(e) { __webpack_async_result__(e); } });//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QSxDQUFDaUMsR0FBRyxDQUFDO3dCQUFFeEIsTUFBTVQscURBQUNBLENBQUNVLE9BQU8sQ0FBQ3FCO29CQUFxQjtnQkFDdEQ7Z0JBQ0EwQixTQUFTLE9BQU9DLE9BQU8sRUFBRVUsS0FBSyxFQUFFLEVBQUU3QjtvQkFDaEMsTUFBTUMsVUFBVUYsV0FBV0M7b0JBQzNCLE9BQU9yQyxtRUFBbUJBLENBQUM7d0JBQ3pCcUM7d0JBQ0FDO3dCQUNBbUIsYUFBYTt3QkFDYlMsT0FBTzs0QkFDTDFDLFFBQVEwQyxNQUFNMUMsTUFBTSxJQUFJOzRCQUN4QlEsY0FBY2tDLE1BQU1sQyxZQUFZOzRCQUNoQ0MsU0FBU2lDLE1BQU1qQyxPQUFPO3dCQUN4QjtvQkFDRjtnQkFDRjtZQUNGO1lBQ0FrQyxhQUFhckUscURBQUNBLENBQUNRLEtBQUssQ0FBQztnQkFDbkJDLE1BQU1ULHFEQUFDQSxDQUFDVSxPQUFPLENBQUNrQjtnQkFDaEI0QixNQUFNO29CQUNKWSxPQUFPcEUscURBQUNBLENBQUNpQyxHQUFHLENBQUM7d0JBQUV4QixNQUFNVCxxREFBQ0EsQ0FBQ1UsT0FBTyxDQUFDMEI7b0JBQWtCO2dCQUNuRDtnQkFDQXFCLFNBQVMsT0FBT0MsT0FBTyxFQUFFVSxLQUFLLEVBQUUsRUFBRTdCO29CQUNoQyxNQUFNQyxVQUFVRixXQUFXQztvQkFDM0IsT0FBT3JDLG1FQUFtQkEsQ0FBQzt3QkFDekJxQzt3QkFDQUM7d0JBQ0FtQixhQUFhO3dCQUNiUyxPQUFPOzRCQUNMMUMsUUFBUTBDLE1BQU0xQyxNQUFNLElBQUk7NEJBQ3hCVyxXQUFXK0IsTUFBTS9CLFNBQVM7NEJBQzFCRixTQUFTaUMsTUFBTWpDLE9BQU87d0JBQ3hCO29CQUNGO2dCQUNGO1lBQ0Y7UUFDRjtJQUNGO0FBQ0YsRUFBRSIsInNvdXJjZXMiOlsid2VicGFjazovLy8uLi8uLi9zY2hlbWFzL2V4dGVuc2lvbnMvQ2hhdC50cz9jYmI5Il0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGdyYXBocWwgYXMgZyB9IGZyb20gJ0BrZXlzdG9uZS02L2NvcmUnO1xuaW1wb3J0IHR5cGUgeyBCYXNlU2NoZW1hTWV0YSB9IGZyb20gJ0BrZXlzdG9uZS02L2NvcmUvZGlzdC9kZWNsYXJhdGlvbnMvc3JjL3R5cGVzL3NjaGVtYS9ncmFwaHFsLXRzLXNjaGVtYSc7XG5pbXBvcnQgdHlwZSB7IFNlc3Npb24gfSBmcm9tICcuLi8uLi9hdXRoJztcbmltcG9ydCB7IENoYXRIaXN0b3J5SXRlbSwgU2VnbWVudFJlZmVyZW5jZSwgbG9hZENoYXRIaXN0b3J5LCBydW5DaGF0Q29udmVyc2F0aW9uIH0gZnJvbSAnLi4vLi4vc2VydmljZXMvY2hhdCc7XG5cbmNvbnN0IENoYXRTZWdtZW50UmVmZXJlbmNlID0gZy5vYmplY3Q8U2VnbWVudFJlZmVyZW5jZT4oKSh7XG4gIG5hbWU6ICdDaGF0U2VnbWVudFJlZmVyZW5jZScsXG4gIGZpZWxkczoge1xuICAgIGlkOiBnLmZpZWxkKHsgdHlwZTogZy5ub25OdWxsKGcuSUQpIH0pLFxuICAgIHRleHQ6IGcuZmllbGQoeyB0eXBlOiBnLm5vbk51bGwoZy5TdHJpbmcpIH0pLFxuICAgIHN0YXJ0TXM6IGcuZmllbGQoeyB0eXBlOiBnLkludCB9KSxcbiAgICBlbmRNczogZy5maWVsZCh7IHR5cGU6IGcuSW50IH0pLFxuICAgIHNwZWFrZXI6IGcuZmllbGQoeyB0eXBlOiBnLlN0cmluZyB9KSxcbiAgICB0cmFuc2NyaXB0VGl0bGU6IGcuZmllbGQoeyB0eXBlOiBnLlN0cmluZyB9KVxuICB9XG59KTtcblxuY29uc3QgQ2hhdE1lc3NhZ2VSZXN1bHQgPSBnLm9iamVjdDxDaGF0SGlzdG9yeUl0ZW0+KCkoe1xuICBuYW1lOiAnQ2hhdE1lc3NhZ2VSZXN1bHQnLFxuICBmaWVsZHM6IHtcbiAgICBpZDogZy5maWVsZCh7IHR5cGU6IGcubm9uTnVsbChnLklEKSB9KSxcbiAgICByb2xlOiBnLmZpZWxkKHsgdHlwZTogZy5ub25OdWxsKGcuU3RyaW5nKSB9KSxcbiAgICBjb250ZW50OiBnLmZpZWxkKHsgdHlwZTogZy5ub25OdWxsKGcuU3RyaW5nKSB9KSxcbiAgICBjcmVhdGVkQXQ6IGcuZmllbGQoeyB0eXBlOiBnLlN0cmluZyB9KSxcbiAgICBzZWdtZW50czogZy5maWVsZCh7IHR5cGU6IGcubm9uTnVsbChnLmxpc3QoZy5ub25OdWxsKENoYXRTZWdtZW50UmVmZXJlbmNlKSkpIH0pXG4gIH1cbn0pO1xuXG5jb25zdCBDaGF0SGlzdG9yeVJlc3VsdCA9IGcub2JqZWN0PHsgY2hhdElkOiBzdHJpbmcgfCBudWxsOyBtZXNzYWdlczogQ2hhdEhpc3RvcnlJdGVtW10gfT4oKSh7XG4gIG5hbWU6ICdDaGF0SGlzdG9yeVJlc3VsdCcsXG4gIGZpZWxkczoge1xuICAgIGNoYXRJZDogZy5maWVsZCh7IHR5cGU6IGcuSUQgfSksXG4gICAgbWVzc2FnZXM6IGcuZmllbGQoeyB0eXBlOiBnLm5vbk51bGwoZy5saXN0KGcubm9uTnVsbChDaGF0TWVzc2FnZVJlc3VsdCkpKSB9KVxuICB9XG59KTtcblxuY29uc3QgQ2hhdE11dGF0aW9uUmVzdWx0ID0gZy5vYmplY3Q8e1xuICBjaGF0SWQ6IHN0cmluZztcbiAgYW5zd2VyOiBzdHJpbmc7XG4gIG1lc3NhZ2VzOiBDaGF0SGlzdG9yeUl0ZW1bXTtcbiAgcmVmZXJlbmNlczogU2VnbWVudFJlZmVyZW5jZVtdO1xufT4oKSh7XG4gIG5hbWU6ICdDaGF0TXV0YXRpb25SZXN1bHQnLFxuICBmaWVsZHM6IHtcbiAgICBjaGF0SWQ6IGcuZmllbGQoeyB0eXBlOiBnLm5vbk51bGwoZy5JRCkgfSksXG4gICAgYW5zd2VyOiBnLmZpZWxkKHsgdHlwZTogZy5ub25OdWxsKGcuU3RyaW5nKSB9KSxcbiAgICBtZXNzYWdlczogZy5maWVsZCh7IHR5cGU6IGcubm9uTnVsbChnLmxpc3QoZy5ub25OdWxsKENoYXRNZXNzYWdlUmVzdWx0KSkpIH0pLFxuICAgIHJlZmVyZW5jZXM6IGcuZmllbGQoeyB0eXBlOiBnLm5vbk51bGwoZy5saXN0KGcubm9uTnVsbChDaGF0U2VnbWVudFJlZmVyZW5jZSkpKSB9KVxuICB9XG59KTtcblxuY29uc3QgVHJhbnNjcmlwdENoYXRJbnB1dCA9IGcuaW5wdXRPYmplY3Qoe1xuICBuYW1lOiAnQ2hhdFRyYW5zY3JpcHRJbnB1dCcsXG4gIGZpZWxkczoge1xuICAgIGNoYXRJZDogZy5hcmcoeyB0eXBlOiBnLklEIH0pLFxuICAgIHRyYW5zY3JpcHRJZDogZy5hcmcoeyB0eXBlOiBnLm5vbk51bGwoZy5JRCkgfSksXG4gICAgbWVzc2FnZTogZy5hcmcoeyB0eXBlOiBnLm5vbk51bGwoZy5TdHJpbmcpIH0pXG4gIH1cbn0pO1xuXG5jb25zdCBQcm9qZWN0Q2hhdElucHV0ID0gZy5pbnB1dE9iamVjdCh7XG4gIG5hbWU6ICdDaGF0UHJvamVjdElucHV0JyxcbiAgZmllbGRzOiB7XG4gICAgY2hhdElkOiBnLmFyZyh7IHR5cGU6IGcuSUQgfSksXG4gICAgcHJvamVjdElkOiBnLmFyZyh7IHR5cGU6IGcubm9uTnVsbChnLklEKSB9KSxcbiAgICBtZXNzYWdlOiBnLmFyZyh7IHR5cGU6IGcubm9uTnVsbChnLlN0cmluZykgfSlcbiAgfVxufSk7XG5cbmNvbnN0IGdldFNlc3Npb24gPSAoY29udGV4dDogQmFzZVNjaGVtYU1ldGFbJ2NvbnRleHQnXSkgPT4ge1xuICBjb25zdCBzZXNzaW9uID0gY29udGV4dC5zZXNzaW9uIGFzIFNlc3Npb24gfCB1bmRlZmluZWQ7XG4gIGlmICghc2Vzc2lvbj8uaWQpIHRocm93IG5ldyBFcnJvcignVW5hdXRob3JpemVkJyk7XG4gIHJldHVybiBzZXNzaW9uO1xufTtcblxuY29uc3QgZmluZExhdGVzdENoYXQgPSBhc3luYyAoe1xuICBjb250ZXh0LFxuICB3aGVyZVxufToge1xuICBjb250ZXh0OiBCYXNlU2NoZW1hTWV0YVsnY29udGV4dCddO1xuICB3aGVyZTogUmVjb3JkPHN0cmluZywgdW5rbm93bj47XG59KSA9PiB7XG4gIGNvbnN0IGNoYXRzID0gYXdhaXQgY29udGV4dC5zdWRvKCkucXVlcnkuQ2hhdC5maW5kTWFueSh7XG4gICAgd2hlcmUsXG4gICAgb3JkZXJCeTogW3sgY3JlYXRlZEF0OiAnZGVzYycgfV0sXG4gICAgdGFrZTogMSxcbiAgICBxdWVyeTogJ2lkJ1xuICB9KTtcbiAgY29uc3QgcmVjb3JkID0gY2hhdHM/LlswXTtcbiAgaWYgKCFyZWNvcmQ/LmlkKSByZXR1cm4gbnVsbDtcbiAgY29uc3QgaGlzdG9yeSA9IGF3YWl0IGxvYWRDaGF0SGlzdG9yeShjb250ZXh0LCByZWNvcmQuaWQpO1xuICByZXR1cm4geyBjaGF0SWQ6IHJlY29yZC5pZCwgbWVzc2FnZXM6IGhpc3RvcnkgfTtcbn07XG5cbmV4cG9ydCBjb25zdCBDaGF0RXh0ZW5zaW9uID0gKGJhc2U6IEJhc2VTY2hlbWFNZXRhKSA9PiB7XG4gIHJldHVybiB7XG4gICAgcXVlcnk6IHtcbiAgICAgIGNoYXRUcmFuc2NyaXB0SGlzdG9yeTogZy5maWVsZCh7XG4gICAgICAgIHR5cGU6IGcubm9uTnVsbChDaGF0SGlzdG9yeVJlc3VsdCksXG4gICAgICAgIGFyZ3M6IHtcbiAgICAgICAgICB0cmFuc2NyaXB0SWQ6IGcuYXJnKHsgdHlwZTogZy5ub25OdWxsKGcuSUQpIH0pXG4gICAgICAgIH0sXG4gICAgICAgIHJlc29sdmU6IGFzeW5jIChfcm9vdCwgeyB0cmFuc2NyaXB0SWQgfSwgY29udGV4dCkgPT4ge1xuICAgICAgICAgIGNvbnN0IHNlc3Npb24gPSBnZXRTZXNzaW9uKGNvbnRleHQpO1xuICAgICAgICAgIGNvbnN0IGhpc3RvcnkgPSBhd2FpdCBmaW5kTGF0ZXN0Q2hhdCh7XG4gICAgICAgICAgICBjb250ZXh0LFxuICAgICAgICAgICAgd2hlcmU6IHtcbiAgICAgICAgICAgICAgY29udGV4dFR5cGU6ICdUUkFOU0NSSVBUJyxcbiAgICAgICAgICAgICAgdHJhbnNjcmlwdDogeyBpZDogeyBlcXVhbHM6IHRyYW5zY3JpcHRJZCB9IH0sXG4gICAgICAgICAgICAgIG9yZzogeyBpZDogeyBlcXVhbHM6IHNlc3Npb24ub3JnSWQgfSB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSk7XG4gICAgICAgICAgaWYgKCFoaXN0b3J5KSByZXR1cm4geyBjaGF0SWQ6IG51bGwsIG1lc3NhZ2VzOiBbXSB9O1xuICAgICAgICAgIHJldHVybiBoaXN0b3J5O1xuICAgICAgICB9XG4gICAgICB9KSxcbiAgICAgIGNoYXRQcm9qZWN0SGlzdG9yeTogZy5maWVsZCh7XG4gICAgICAgIHR5cGU6IGcubm9uTnVsbChDaGF0SGlzdG9yeVJlc3VsdCksXG4gICAgICAgIGFyZ3M6IHtcbiAgICAgICAgICBwcm9qZWN0SWQ6IGcuYXJnKHsgdHlwZTogZy5ub25OdWxsKGcuSUQpIH0pXG4gICAgICAgIH0sXG4gICAgICAgIHJlc29sdmU6IGFzeW5jIChfcm9vdCwgeyBwcm9qZWN0SWQgfSwgY29udGV4dCkgPT4ge1xuICAgICAgICAgIGNvbnN0IHNlc3Npb24gPSBnZXRTZXNzaW9uKGNvbnRleHQpO1xuICAgICAgICAgIGNvbnN0IGhpc3RvcnkgPSBhd2FpdCBmaW5kTGF0ZXN0Q2hhdCh7XG4gICAgICAgICAgICBjb250ZXh0LFxuICAgICAgICAgICAgd2hlcmU6IHtcbiAgICAgICAgICAgICAgY29udGV4dFR5cGU6ICdQUk9KRUNUJyxcbiAgICAgICAgICAgICAgcHJvamVjdDogeyBpZDogeyBlcXVhbHM6IHByb2plY3RJZCB9IH0sXG4gICAgICAgICAgICAgIG9yZzogeyBpZDogeyBlcXVhbHM6IHNlc3Npb24ub3JnSWQgfSB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSk7XG4gICAgICAgICAgaWYgKCFoaXN0b3J5KSByZXR1cm4geyBjaGF0SWQ6IG51bGwsIG1lc3NhZ2VzOiBbXSB9O1xuICAgICAgICAgIHJldHVybiBoaXN0b3J5O1xuICAgICAgICB9XG4gICAgICB9KVxuICAgIH0sXG4gICAgbXV0YXRpb246IHtcbiAgICAgIGNoYXRUcmFuc2NyaXB0OiBnLmZpZWxkKHtcbiAgICAgICAgdHlwZTogZy5ub25OdWxsKENoYXRNdXRhdGlvblJlc3VsdCksXG4gICAgICAgIGFyZ3M6IHtcbiAgICAgICAgICBpbnB1dDogZy5hcmcoeyB0eXBlOiBnLm5vbk51bGwoVHJhbnNjcmlwdENoYXRJbnB1dCkgfSlcbiAgICAgICAgfSxcbiAgICAgICAgcmVzb2x2ZTogYXN5bmMgKF9yb290LCB7IGlucHV0IH0sIGNvbnRleHQpID0+IHtcbiAgICAgICAgICBjb25zdCBzZXNzaW9uID0gZ2V0U2Vzc2lvbihjb250ZXh0KTtcbiAgICAgICAgICByZXR1cm4gcnVuQ2hhdENvbnZlcnNhdGlvbih7XG4gICAgICAgICAgICBjb250ZXh0LFxuICAgICAgICAgICAgc2Vzc2lvbixcbiAgICAgICAgICAgIGNvbnRleHRUeXBlOiAnVFJBTlNDUklQVCcsXG4gICAgICAgICAgICBpbnB1dDoge1xuICAgICAgICAgICAgICBjaGF0SWQ6IGlucHV0LmNoYXRJZCA/PyBudWxsLFxuICAgICAgICAgICAgICB0cmFuc2NyaXB0SWQ6IGlucHV0LnRyYW5zY3JpcHRJZCxcbiAgICAgICAgICAgICAgbWVzc2FnZTogaW5wdXQubWVzc2FnZVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICB9KSxcbiAgICAgIGNoYXRQcm9qZWN0OiBnLmZpZWxkKHtcbiAgICAgICAgdHlwZTogZy5ub25OdWxsKENoYXRNdXRhdGlvblJlc3VsdCksXG4gICAgICAgIGFyZ3M6IHtcbiAgICAgICAgICBpbnB1dDogZy5hcmcoeyB0eXBlOiBnLm5vbk51bGwoUHJvamVjdENoYXRJbnB1dCkgfSlcbiAgICAgICAgfSxcbiAgICAgICAgcmVzb2x2ZTogYXN5bmMgKF9yb290LCB7IGlucHV0IH0sIGNvbnRleHQpID0+IHtcbiAgICAgICAgICBjb25zdCBzZXNzaW9uID0gZ2V0U2Vzc2lvbihjb250ZXh0KTtcbiAgICAgICAgICByZXR1cm4gcnVuQ2hhdENvbnZlcnNhdGlvbih7XG4gICAgICAgICAgICBjb250ZXh0LFxuICAgICAgICAgICAgc2Vzc2lvbixcbiAgICAgICAgICAgIGNvbnRleHRUeXBlOiAnUFJPSkVDVCcsXG4gICAgICAgICAgICBpbnB1dDoge1xuICAgICAgICAgICAgICBjaGF0SWQ6IGlucHV0LmNoYXRJZCA/PyBudWxsLFxuICAgICAgICAgICAgICBwcm9qZWN0SWQ6IGlucHV0LnByb2plY3RJZCxcbiAgICAgICAgICAgICAgbWVzc2FnZTogaW5wdXQubWVzc2FnZVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICB9KVxuICAgIH1cbiAgfTtcbn07XG5cbiJdLCJuYW1lcyI6WyJncmFwaHFsIiwiZyIsImxvYWRDaGF0SGlzdG9yeSIsInJ1bkNoYXRDb252ZXJzYXRpb24iLCJDaGF0U2VnbWVudFJlZmVyZW5jZSIsIm9iamVjdCIsIm5hbWUiLCJmaWVsZHMiLCJpZCIsImZpZWxkIiwidHlwZSIsIm5vbk51bGwiLCJJRCIsInRleHQiLCJTdHJpbmciLCJzdGFydE1zIiwiSW50IiwiZW5kTXMiLCJzcGVha2VyIiwidHJhbnNjcmlwdFRpdGxlIiwiQ2hhdE1lc3NhZ2VSZXN1bHQiLCJyb2xlIiwiY29udGVudCIsImNyZWF0ZWRBdCIsInNlZ21lbnRzIiwibGlzdCIsIkNoYXRIaXN0b3J5UmVzdWx0IiwiY2hhdElkIiwibWVzc2FnZXMiLCJDaGF0TXV0YXRpb25SZXN1bHQiLCJhbnN3ZXIiLCJyZWZlcmVuY2VzIiwiVHJhbnNjcmlwdENoYXRJbnB1dCIsImlucHV0T2JqZWN0IiwiYXJnIiwidHJhbnNjcmlwdElkIiwibWVzc2FnZSIsIlByb2plY3RDaGF0SW5wdXQiLCJwcm9qZWN0SWQiLCJnZXRTZXNzaW9uIiwiY29udGV4dCIsInNlc3Npb24iLCJFcnJvciIsImZpbmRMYXRlc3RDaGF0Iiwid2hlcmUiLCJjaGF0cyIsInN1ZG8iLCJxdWVyeSIsIkNoYXQiLCJmaW5kTWFueSIsIm9yZGVyQnkiLCJ0YWtlIiwicmVjb3JkIiwiaGlzdG9yeSIsIkNoYXRFeHRlbnNpb24iLCJiYXNlIiwiY2hhdFRyYW5zY3JpcHRIaXN0b3J5IiwiYXJncyIsInJlc29sdmUiLCJfcm9vdCIsImNvbnRleHRUeXBlIiwidHJhbnNjcmlwdCIsImVxdWFscyIsIm9yZyIsIm9yZ0lkIiwiY2hhdFByb2plY3RIaXN0b3J5IiwicHJvamVjdCIsIm11dGF0aW9uIiwiY2hhdFRyYW5zY3JpcHQiLCJpbnB1dCIsImNoYXRQcm9qZWN0Il0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(api)/../../schemas/extensions/Chat.ts\n");

/***/ }),

/***/ "(api)/../../schemas/extensions/TranscriptIngestion.ts":
/*!*******************************************************!*\
  !*** ../../schemas/extensions/TranscriptIngestion.ts ***!
  \*******************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   TranscriptIngestion: () => (/* binding */ TranscriptIngestion)\n/* harmony export */ });\n/* harmony import */ var _keystone_6_core__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @keystone-6/core */ \"@keystone-6/core\");\n/* harmony import */ var _keystone_6_core__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_keystone_6_core__WEBPACK_IMPORTED_MODULE_0__);\n\nconst TIMESTAMP_RE = /(?<hours>\\d{2}):(?<minutes>\\d{2}):(?<seconds>\\d{2}),(?<ms>\\d{3})/;\nconst parseTimestamp = (value)=>{\n    const match = TIMESTAMP_RE.exec(value);\n    if (!match) throw new Error(`Invalid timestamp: ${value}`);\n    const { hours, minutes, seconds, ms } = match.groups;\n    return Number(hours) * 3600000 + Number(minutes) * 60000 + Number(seconds) * 1000 + Number(ms);\n};\nconst parseLines = (block)=>block.split(\"\\n\").map((line)=>line.trim()).filter(Boolean);\nconst chunkArray = (items, size)=>{\n    const result = [];\n    for(let i = 0; i < items.length; i += size){\n        result.push(items.slice(i, i + size));\n    }\n    return result;\n};\nconst parseSrt = (srt)=>{\n    const normalized = srt.replace(/\\r\\n/g, \"\\n\").trim();\n    if (!normalized) return [];\n    const groups = normalized.split(/\\n{2,}/).map((block)=>block.trim()).filter(Boolean);\n    return groups.map((block)=>{\n        const lines = parseLines(block);\n        if (lines.length < 2) return null;\n        const [indexLine, timeLine, ...textLines] = lines;\n        const timeMatch = timeLine.match(/(\\d{2}:\\d{2}:\\d{2},\\d{3})\\s*-->\\s*(\\d{2}:\\d{2}:\\d{2},\\d{3})/);\n        if (!timeMatch) throw new Error(`Invalid timecode line: ${timeLine}`);\n        const startMs = parseTimestamp(timeMatch[1]);\n        const endMs = parseTimestamp(timeMatch[2]);\n        if (endMs <= startMs) throw new Error(\"Segment end must be greater than start\");\n        const textValue = textLines.join(\" \").trim();\n        if (!textValue) return null;\n        const speakerMatch = textValue.match(/^([A-Za-z0-9 ]+):\\s*(.+)$/);\n        const speaker = speakerMatch ? speakerMatch[1] : undefined;\n        const cleanedText = speakerMatch ? speakerMatch[2] : textValue;\n        const isMetadata = /^\\[.*\\]$/.test(cleanedText);\n        return {\n            index: Number.parseInt(indexLine, 10) || 0,\n            startMs,\n            endMs,\n            durationMs: endMs - startMs,\n            text: cleanedText,\n            speaker,\n            isMetadata\n        };\n    }).reduce((acc, segment, idx)=>{\n        if (!segment) return acc;\n        const normalizedIndex = segment.index || idx + 1;\n        acc.push({\n            ...segment,\n            index: normalizedIndex\n        });\n        return acc;\n    }, []);\n};\nconst TranscriptIngestion = (base)=>{\n    const IngestInput = _keystone_6_core__WEBPACK_IMPORTED_MODULE_0__.graphql.inputObject({\n        name: \"IngestTranscriptInput\",\n        fields: {\n            projectId: _keystone_6_core__WEBPACK_IMPORTED_MODULE_0__.graphql.arg({\n                type: _keystone_6_core__WEBPACK_IMPORTED_MODULE_0__.graphql.nonNull(_keystone_6_core__WEBPACK_IMPORTED_MODULE_0__.graphql.ID)\n            }),\n            title: _keystone_6_core__WEBPACK_IMPORTED_MODULE_0__.graphql.arg({\n                type: _keystone_6_core__WEBPACK_IMPORTED_MODULE_0__.graphql.nonNull(_keystone_6_core__WEBPACK_IMPORTED_MODULE_0__.graphql.String)\n            }),\n            intervieweeName: _keystone_6_core__WEBPACK_IMPORTED_MODULE_0__.graphql.arg({\n                type: _keystone_6_core__WEBPACK_IMPORTED_MODULE_0__.graphql.String\n            }),\n            sourceUrl: _keystone_6_core__WEBPACK_IMPORTED_MODULE_0__.graphql.arg({\n                type: _keystone_6_core__WEBPACK_IMPORTED_MODULE_0__.graphql.String\n            }),\n            language: _keystone_6_core__WEBPACK_IMPORTED_MODULE_0__.graphql.arg({\n                type: _keystone_6_core__WEBPACK_IMPORTED_MODULE_0__.graphql.String\n            }),\n            notes: _keystone_6_core__WEBPACK_IMPORTED_MODULE_0__.graphql.arg({\n                type: _keystone_6_core__WEBPACK_IMPORTED_MODULE_0__.graphql.String\n            }),\n            srt: _keystone_6_core__WEBPACK_IMPORTED_MODULE_0__.graphql.arg({\n                type: _keystone_6_core__WEBPACK_IMPORTED_MODULE_0__.graphql.nonNull(_keystone_6_core__WEBPACK_IMPORTED_MODULE_0__.graphql.String)\n            })\n        }\n    });\n    const Result = _keystone_6_core__WEBPACK_IMPORTED_MODULE_0__.graphql.object()({\n        name: \"IngestTranscriptResult\",\n        fields: {\n            transcriptId: _keystone_6_core__WEBPACK_IMPORTED_MODULE_0__.graphql.field({\n                type: _keystone_6_core__WEBPACK_IMPORTED_MODULE_0__.graphql.nonNull(_keystone_6_core__WEBPACK_IMPORTED_MODULE_0__.graphql.ID)\n            }),\n            segmentsCount: _keystone_6_core__WEBPACK_IMPORTED_MODULE_0__.graphql.field({\n                type: _keystone_6_core__WEBPACK_IMPORTED_MODULE_0__.graphql.nonNull(_keystone_6_core__WEBPACK_IMPORTED_MODULE_0__.graphql.Int)\n            }),\n            projectId: _keystone_6_core__WEBPACK_IMPORTED_MODULE_0__.graphql.field({\n                type: _keystone_6_core__WEBPACK_IMPORTED_MODULE_0__.graphql.nonNull(_keystone_6_core__WEBPACK_IMPORTED_MODULE_0__.graphql.ID)\n            })\n        }\n    });\n    return {\n        mutation: {\n            ingestTranscript: _keystone_6_core__WEBPACK_IMPORTED_MODULE_0__.graphql.field({\n                type: _keystone_6_core__WEBPACK_IMPORTED_MODULE_0__.graphql.nonNull(Result),\n                args: {\n                    input: _keystone_6_core__WEBPACK_IMPORTED_MODULE_0__.graphql.arg({\n                        type: _keystone_6_core__WEBPACK_IMPORTED_MODULE_0__.graphql.nonNull(IngestInput)\n                    })\n                },\n                async resolve (_root, { input }, context) {\n                    const session = context.session;\n                    if (!session?.id) throw new Error(\"Unauthorized\");\n                    if (!session.orgId) throw new Error(\"Missing organization context\");\n                    const sudoContext = context.sudo();\n                    const project = await sudoContext.query.Project.findOne({\n                        where: {\n                            id: input.projectId\n                        },\n                        query: \"id org { id }\"\n                    });\n                    if (!project) throw new Error(\"Project not found\");\n                    if (!project.org?.id || project.org.id !== session.orgId) throw new Error(\"Project not in your organization\");\n                    const segments = parseSrt(input.srt);\n                    if (!segments.length) throw new Error(\"No valid segments detected\");\n                    const transcript = await sudoContext.db.Transcript.createOne({\n                        data: {\n                            title: input.title.trim(),\n                            intervieweeName: input.intervieweeName?.trim() || null,\n                            sourceUrl: input.sourceUrl?.trim() || null,\n                            language: input.language?.trim() || null,\n                            notes: input.notes?.trim() || null,\n                            project: {\n                                connect: {\n                                    id: project.id\n                                }\n                            },\n                            org: {\n                                connect: {\n                                    id: project.org.id\n                                }\n                            }\n                        }\n                    });\n                    await Promise.all(segments.map((segment)=>sudoContext.db.TranscriptSegment.createOne({\n                            data: {\n                                transcript: {\n                                    connect: {\n                                        id: transcript.id\n                                    }\n                                },\n                                index: segment.index,\n                                startMs: segment.startMs,\n                                endMs: segment.endMs,\n                                durationMs: segment.durationMs,\n                                text: segment.text,\n                                speaker: segment.speaker,\n                                isMetadata: segment.isMetadata\n                            }\n                        })));\n                    return {\n                        transcriptId: transcript.id,\n                        segmentsCount: segments.length,\n                        projectId: project.id\n                    };\n                }\n            })\n        }\n    };\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi4vLi4vc2NoZW1hcy9leHRlbnNpb25zL1RyYW5zY3JpcHRJbmdlc3Rpb24udHMiLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQWdEO0FBSWhELE1BQU1FLGVBQWU7QUFZckIsTUFBTUMsaUJBQWlCLENBQUNDO0lBQ3RCLE1BQU1DLFFBQVFILGFBQWFJLElBQUksQ0FBQ0Y7SUFDaEMsSUFBSSxDQUFDQyxPQUFPLE1BQU0sSUFBSUUsTUFBTSxDQUFDLG1CQUFtQixFQUFFSCxNQUFNLENBQUM7SUFDekQsTUFBTSxFQUFFSSxLQUFLLEVBQUVDLE9BQU8sRUFBRUMsT0FBTyxFQUFFQyxFQUFFLEVBQUUsR0FBR04sTUFBTU8sTUFBTTtJQUNwRCxPQUFPQyxPQUFPTCxTQUFTLFVBQVlLLE9BQU9KLFdBQVcsUUFBU0ksT0FBT0gsV0FBVyxPQUFRRyxPQUFPRjtBQUNqRztBQUVBLE1BQU1HLGFBQWEsQ0FBQ0MsUUFDbEJBLE1BQ0dDLEtBQUssQ0FBQyxNQUNOQyxHQUFHLENBQUNDLENBQUFBLE9BQVFBLEtBQUtDLElBQUksSUFDckJDLE1BQU0sQ0FBQ0M7QUFFWixNQUFNQyxhQUFhLENBQUlDLE9BQVlDO0lBQ2pDLE1BQU1DLFNBQWdCLEVBQUU7SUFDeEIsSUFBSyxJQUFJQyxJQUFJLEdBQUdBLElBQUlILE1BQU1JLE1BQU0sRUFBRUQsS0FBS0YsS0FBTTtRQUMzQ0MsT0FBT0csSUFBSSxDQUFDTCxNQUFNTSxLQUFLLENBQUNILEdBQUdBLElBQUlGO0lBQ2pDO0lBQ0EsT0FBT0M7QUFDVDtBQUVBLE1BQU1LLFdBQVcsQ0FBQ0M7SUFDaEIsTUFBTUMsYUFBYUQsSUFBSUUsT0FBTyxDQUFDLFNBQVMsTUFBTWQsSUFBSTtJQUNsRCxJQUFJLENBQUNhLFlBQVksT0FBTyxFQUFFO0lBQzFCLE1BQU1wQixTQUFTb0IsV0FDWmhCLEtBQUssQ0FBQyxVQUNOQyxHQUFHLENBQUNGLENBQUFBLFFBQVNBLE1BQU1JLElBQUksSUFDdkJDLE1BQU0sQ0FBQ0M7SUFFVixPQUFPVCxPQUNK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QUMzQlYsZUFBZW9CLFNBQVN4RSxNQUFNO3dCQUM5QnFDLFdBQVc2QixRQUFRSixFQUFFO29CQUN2QjtnQkFDRjtZQUNGO1FBQ0Y7SUFDRjtBQUNGLEVBQUUiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi4vLi4vc2NoZW1hcy9leHRlbnNpb25zL1RyYW5zY3JpcHRJbmdlc3Rpb24udHM/ZjM5NSJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBncmFwaHFsIGFzIGcgfSBmcm9tICdAa2V5c3RvbmUtNi9jb3JlJztcbmltcG9ydCB0eXBlIHsgQmFzZVNjaGVtYU1ldGEgfSBmcm9tICdAa2V5c3RvbmUtNi9jb3JlL2Rpc3QvZGVjbGFyYXRpb25zL3NyYy90eXBlcy9zY2hlbWEvZ3JhcGhxbC10cy1zY2hlbWEnO1xuaW1wb3J0IHsgU2Vzc2lvbiB9IGZyb20gJy4uLy4uL2F1dGgnO1xuXG5jb25zdCBUSU1FU1RBTVBfUkUgPSAvKD88aG91cnM+XFxkezJ9KTooPzxtaW51dGVzPlxcZHsyfSk6KD88c2Vjb25kcz5cXGR7Mn0pLCg/PG1zPlxcZHszfSkvO1xuXG50eXBlIFBhcnNlZFNlZ21lbnQgPSB7XG4gIGluZGV4OiBudW1iZXI7XG4gIHN0YXJ0TXM6IG51bWJlcjtcbiAgZW5kTXM6IG51bWJlcjtcbiAgZHVyYXRpb25NczogbnVtYmVyO1xuICB0ZXh0OiBzdHJpbmc7XG4gIHNwZWFrZXI/OiBzdHJpbmc7XG4gIGlzTWV0YWRhdGE6IGJvb2xlYW47XG59O1xuXG5jb25zdCBwYXJzZVRpbWVzdGFtcCA9ICh2YWx1ZTogc3RyaW5nKTogbnVtYmVyID0+IHtcbiAgY29uc3QgbWF0Y2ggPSBUSU1FU1RBTVBfUkUuZXhlYyh2YWx1ZSk7XG4gIGlmICghbWF0Y2gpIHRocm93IG5ldyBFcnJvcihgSW52YWxpZCB0aW1lc3RhbXA6ICR7dmFsdWV9YCk7XG4gIGNvbnN0IHsgaG91cnMsIG1pbnV0ZXMsIHNlY29uZHMsIG1zIH0gPSBtYXRjaC5ncm91cHMhO1xuICByZXR1cm4gTnVtYmVyKGhvdXJzKSAqIDNfNjAwXzAwMCArIE51bWJlcihtaW51dGVzKSAqIDYwXzAwMCArIE51bWJlcihzZWNvbmRzKSAqIDFfMDAwICsgTnVtYmVyKG1zKTtcbn07XG5cbmNvbnN0IHBhcnNlTGluZXMgPSAoYmxvY2s6IHN0cmluZykgPT5cbiAgYmxvY2tcbiAgICAuc3BsaXQoJ1xcbicpXG4gICAgLm1hcChsaW5lID0+IGxpbmUudHJpbSgpKVxuICAgIC5maWx0ZXIoQm9vbGVhbik7XG5cbmNvbnN0IGNodW5rQXJyYXkgPSA8VD4oaXRlbXM6IFRbXSwgc2l6ZTogbnVtYmVyKSA9PiB7XG4gIGNvbnN0IHJlc3VsdDogVFtdW10gPSBbXTtcbiAgZm9yIChsZXQgaSA9IDA7IGkgPCBpdGVtcy5sZW5ndGg7IGkgKz0gc2l6ZSkge1xuICAgIHJlc3VsdC5wdXNoKGl0ZW1zLnNsaWNlKGksIGkgKyBzaXplKSk7XG4gIH1cbiAgcmV0dXJuIHJlc3VsdDtcbn07XG5cbmNvbnN0IHBhcnNlU3J0ID0gKHNydDogc3RyaW5nKTogUGFyc2VkU2VnbWVudFtdID0+IHtcbiAgY29uc3Qgbm9ybWFsaXplZCA9IHNydC5yZXBsYWNlKC9cXHJcXG4vZywgJ1xcbicpLnRyaW0oKTtcbiAgaWYgKCFub3JtYWxpemVkKSByZXR1cm4gW107XG4gIGNvbnN0IGdyb3VwcyA9IG5vcm1hbGl6ZWRcbiAgICAuc3BsaXQoL1xcbnsyLH0vKVxuICAgIC5tYXAoYmxvY2sgPT4gYmxvY2sudHJpbSgpKVxuICAgIC5maWx0ZXIoQm9vbGVhbik7XG5cbiAgcmV0dXJuIGdyb3Vwc1xuICAgIC5tYXAoYmxvY2sgPT4ge1xuICAgICAgY29uc3QgbGluZXMgPSBwYXJzZUxpbmVzKGJsb2NrKTtcbiAgICAgIGlmIChsaW5lcy5sZW5ndGggPCAyKSByZXR1cm4gbnVsbDtcbiAgICAgIGNvbnN0IFtpbmRleExpbmUsIHRpbWVMaW5lLCAuLi50ZXh0TGluZXNdID0gbGluZXM7XG4gICAgICBjb25zdCB0aW1lTWF0Y2ggPSB0aW1lTGluZS5tYXRjaCgvKFxcZHsyfTpcXGR7Mn06XFxkezJ9LFxcZHszfSlcXHMqLS0+XFxzKihcXGR7Mn06XFxkezJ9OlxcZHsyfSxcXGR7M30pLyk7XG4gICAgICBpZiAoIXRpbWVNYXRjaCkgdGhyb3cgbmV3IEVycm9yKGBJbnZhbGlkIHRpbWVjb2RlIGxpbmU6ICR7dGltZUxpbmV9YCk7XG4gICAgICBjb25zdCBzdGFydE1zID0gcGFyc2VUaW1lc3RhbXAodGltZU1hdGNoWzFdKTtcbiAgICAgIGNvbnN0IGVuZE1zID0gcGFyc2VUaW1lc3RhbXAodGltZU1hdGNoWzJdKTtcbiAgICAgIGlmIChlbmRNcyA8PSBzdGFydE1zKSB0aHJvdyBuZXcgRXJyb3IoJ1NlZ21lbnQgZW5kIG11c3QgYmUgZ3JlYXRlciB0aGFuIHN0YXJ0Jyk7XG4gICAgICBjb25zdCB0ZXh0VmFsdWUgPSB0ZXh0TGluZXMuam9pbignICcpLnRyaW0oKTtcbiAgICAgIGlmICghdGV4dFZhbHVlKSByZXR1cm4gbnVsbDtcbiAgICAgIGNvbnN0IHNwZWFrZXJNYXRjaCA9IHRleHRWYWx1ZS5tYXRjaCgvXihbQS1aYS16MC05IF0rKTpcXHMqKC4rKSQvKTtcbiAgICAgIGNvbnN0IHNwZWFrZXIgPSBzcGVha2VyTWF0Y2ggPyBzcGVha2VyTWF0Y2hbMV0gOiB1bmRlZmluZWQ7XG4gICAgICBjb25zdCBjbGVhbmVkVGV4dCA9IHNwZWFrZXJNYXRjaCA/IHNwZWFrZXJNYXRjaFsyXSA6IHRleHRWYWx1ZTtcbiAgICAgIGNvbnN0IGlzTWV0YWRhdGEgPSAvXlxcWy4qXFxdJC8udGVzdChjbGVhbmVkVGV4dCk7XG4gICAgICByZXR1cm4ge1xuICAgICAgICBpbmRleDogTnVtYmVyLnBhcnNlSW50KGluZGV4TGluZSwgMTApIHx8IDAsXG4gICAgICAgIHN0YXJ0TXMsXG4gICAgICAgIGVuZE1zLFxuICAgICAgICBkdXJhdGlvbk1zOiBlbmRNcyAtIHN0YXJ0TXMsXG4gICAgICAgIHRleHQ6IGNsZWFuZWRUZXh0LFxuICAgICAgICBzcGVha2VyLFxuICAgICAgICBpc01ldGFkYXRhXG4gICAgICB9O1xuICAgIH0pXG4gICAgLnJlZHVjZTxQYXJzZWRTZWdtZW50W10+KChhY2MsIHNlZ21lbnQsIGlkeCkgPT4ge1xuICAgICAgaWYgKCFzZWdtZW50KSByZXR1cm4gYWNjO1xuICAgICAgY29uc3Qgbm9ybWFsaXplZEluZGV4ID0gc2VnbWVudC5pbmRleCB8fCBpZHggKyAxO1xuICAgICAgYWNjLnB1c2goeyAuLi5zZWdtZW50LCBpbmRleDogbm9ybWFsaXplZEluZGV4IH0pO1xuICAgICAgcmV0dXJuIGFjYztcbiAgICB9LCBbXSk7XG59O1xuXG5leHBvcnQgY29uc3QgVHJhbnNjcmlwdEluZ2VzdGlvbiA9IChiYXNlOiBCYXNlU2NoZW1hTWV0YSkgPT4ge1xuICBjb25zdCBJbmdlc3RJbnB1dCA9IGcuaW5wdXRPYmplY3Qoe1xuICAgIG5hbWU6ICdJbmdlc3RUcmFuc2NyaXB0SW5wdXQnLFxuICAgIGZpZWxkczoge1xuICAgICAgcHJvamVjdElkOiBnLmFyZyh7IHR5cGU6IGcubm9uTnVsbChnLklEKSB9KSxcbiAgICAgIHRpdGxlOiBnLmFyZyh7IHR5cGU6IGcubm9uTnVsbChnLlN0cmluZykgfSksXG4gICAgICBpbnRlcnZpZXdlZU5hbWU6IGcuYXJnKHsgdHlwZTogZy5TdHJpbmcgfSksXG4gICAgICBzb3VyY2VVcmw6IGcuYXJnKHsgdHlwZTogZy5TdHJpbmcgfSksXG4gICAgICBsYW5ndWFnZTogZy5hcmcoeyB0eXBlOiBnLlN0cmluZyB9KSxcbiAgICAgIG5vdGVzOiBnLmFyZyh7IHR5cGU6IGcuU3RyaW5nIH0pLFxuICAgICAgc3J0OiBnLmFyZyh7IHR5cGU6IGcubm9uTnVsbChnLlN0cmluZykgfSlcbiAgICB9XG4gIH0pO1xuXG4gIGNvbnN0IFJlc3VsdCA9IGcub2JqZWN0PHsgdHJhbnNjcmlwdElkOiBzdHJpbmc7IHNlZ21lbnRzQ291bnQ6IG51bWJlcjsgcHJvamVjdElkOiBzdHJpbmcgfT4oKSh7XG4gICAgbmFtZTogJ0luZ2VzdFRyYW5zY3JpcHRSZXN1bHQnLFxuICAgIGZpZWxkczoge1xuICAgICAgdHJhbnNjcmlwdElkOiBnLmZpZWxkKHsgdHlwZTogZy5ub25OdWxsKGcuSUQpIH0pLFxuICAgICAgc2VnbWVudHNDb3VudDogZy5maWVsZCh7IHR5cGU6IGcubm9uTnVsbChnLkludCkgfSksXG4gICAgICBwcm9qZWN0SWQ6IGcuZmllbGQoeyB0eXBlOiBnLm5vbk51bGwoZy5JRCkgfSlcbiAgICB9XG4gIH0pO1xuXG4gIHJldHVybiB7XG4gICAgbXV0YXRpb246IHtcbiAgICAgIGluZ2VzdFRyYW5zY3JpcHQ6IGcuZmllbGQoe1xuICAgICAgICB0eXBlOiBnLm5vbk51bGwoUmVzdWx0KSxcbiAgICAgICAgYXJnczogeyBpbnB1dDogZy5hcmcoeyB0eXBlOiBnLm5vbk51bGwoSW5nZXN0SW5wdXQpIH0pIH0sXG4gICAgICAgIGFzeW5jIHJlc29sdmUoX3Jvb3QsIHsgaW5wdXQgfSwgY29udGV4dCkge1xuICAgICAgICAgIGNvbnN0IHNlc3Npb24gPSBjb250ZXh0LnNlc3Npb24gYXMgU2Vzc2lvbiB8IHVuZGVmaW5lZDtcbiAgICAgICAgICBpZiAoIXNlc3Npb24/LmlkKSB0aHJvdyBuZXcgRXJyb3IoJ1VuYXV0aG9yaXplZCcpO1xuICAgICAgICAgIGlmICghc2Vzc2lvbi5vcmdJZCkgdGhyb3cgbmV3IEVycm9yKCdNaXNzaW5nIG9yZ2FuaXphdGlvbiBjb250ZXh0Jyk7XG5cbiAgICAgICAgICBjb25zdCBzdWRvQ29udGV4dCA9IGNvbnRleHQuc3VkbygpO1xuICAgICAgICAgIGNvbnN0IHByb2plY3QgPSBhd2FpdCBzdWRvQ29udGV4dC5xdWVyeS5Qcm9qZWN0LmZpbmRPbmUoe1xuICAgICAgICAgICAgd2hlcmU6IHsgaWQ6IGlucHV0LnByb2plY3RJZCB9LFxuICAgICAgICAgICAgcXVlcnk6ICdpZCBvcmcgeyBpZCB9J1xuICAgICAgICAgIH0pO1xuICAgICAgICAgIGlmICghcHJvamVjdCkgdGhyb3cgbmV3IEVycm9yKCdQcm9qZWN0IG5vdCBmb3VuZCcpO1xuICAgICAgICAgIGlmICghcHJvamVjdC5vcmc/LmlkIHx8IHByb2plY3Qub3JnLmlkICE9PSBzZXNzaW9uLm9yZ0lkKSB0aHJvdyBuZXcgRXJyb3IoJ1Byb2plY3Qgbm90IGluIHlvdXIgb3JnYW5pemF0aW9uJyk7XG5cbiAgICAgICAgICBjb25zdCBzZWdtZW50cyA9IHBhcnNlU3J0KGlucHV0LnNydCk7XG4gICAgICAgICAgaWYgKCFzZWdtZW50cy5sZW5ndGgpIHRocm93IG5ldyBFcnJvcignTm8gdmFsaWQgc2VnbWVudHMgZGV0ZWN0ZWQnKTtcblxuICAgICAgICAgIGNvbnN0IHRyYW5zY3JpcHQgPSBhd2FpdCBzdWRvQ29udGV4dC5kYi5UcmFuc2NyaXB0LmNyZWF0ZU9uZSh7XG4gICAgICAgICAgICBkYXRhOiB7XG4gICAgICAgICAgICAgIHRpdGxlOiBpbnB1dC50aXRsZS50cmltKCksXG4gICAgICAgICAgICAgIGludGVydmlld2VlTmFtZTogaW5wdXQuaW50ZXJ2aWV3ZWVOYW1lPy50cmltKCkgfHwgbnVsbCxcbiAgICAgICAgICAgICAgc291cmNlVXJsOiBpbnB1dC5zb3VyY2VVcmw/LnRyaW0oKSB8fCBudWxsLFxuICAgICAgICAgICAgICBsYW5ndWFnZTogaW5wdXQubGFuZ3VhZ2U/LnRyaW0oKSB8fCBudWxsLFxuICAgICAgICAgICAgICBub3RlczogaW5wdXQubm90ZXM/LnRyaW0oKSB8fCBudWxsLFxuICAgICAgICAgICAgICBwcm9qZWN0OiB7IGNvbm5lY3Q6IHsgaWQ6IHByb2plY3QuaWQgfSB9LFxuICAgICAgICAgICAgICBvcmc6IHsgY29ubmVjdDogeyBpZDogcHJvamVjdC5vcmcuaWQgfSB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSk7XG5cbiAgICAgICAgICBhd2FpdCBQcm9taXNlLmFsbChcbiAgICAgICAgICAgIHNlZ21lbnRzLm1hcChzZWdtZW50ID0+XG4gICAgICAgICAgICAgIHN1ZG9Db250ZXh0LmRiLlRyYW5zY3JpcHRTZWdtZW50LmNyZWF0ZU9uZSh7XG4gICAgICAgICAgICAgICAgZGF0YToge1xuICAgICAgICAgICAgICAgICAgdHJhbnNjcmlwdDogeyBjb25uZWN0OiB7IGlkOiB0cmFuc2NyaXB0LmlkIH0gfSxcbiAgICAgICAgICAgICAgICAgIGluZGV4OiBzZWdtZW50LmluZGV4LFxuICAgICAgICAgICAgICAgICAgc3RhcnRNczogc2VnbWVudC5zdGFydE1zLFxuICAgICAgICAgICAgICAgICAgZW5kTXM6IHNlZ21lbnQuZW5kTXMsXG4gICAgICAgICAgICAgICAgICBkdXJhdGlvbk1zOiBzZWdtZW50LmR1cmF0aW9uTXMsXG4gICAgICAgICAgICAgICAgICB0ZXh0OiBzZWdtZW50LnRleHQsXG4gICAgICAgICAgICAgICAgICBzcGVha2VyOiBzZWdtZW50LnNwZWFrZXIsXG4gICAgICAgICAgICAgICAgICBpc01ldGFkYXRhOiBzZWdtZW50LmlzTWV0YWRhdGFcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICApXG4gICAgICAgICAgKTtcblxuICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICB0cmFuc2NyaXB0SWQ6IHRyYW5zY3JpcHQuaWQsXG4gICAgICAgICAgICBzZWdtZW50c0NvdW50OiBzZWdtZW50cy5sZW5ndGgsXG4gICAgICAgICAgICBwcm9qZWN0SWQ6IHByb2plY3QuaWRcbiAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgICB9KVxuICAgIH1cbiAgfTtcbn07XG4iXSwibmFtZXMiOlsiZ3JhcGhxbCIsImciLCJUSU1FU1RBTVBfUkUiLCJwYXJzZVRpbWVzdGFtcCIsInZhbHVlIiwibWF0Y2giLCJleGVjIiwiRXJyb3IiLCJob3VycyIsIm1pbnV0ZXMiLCJzZWNvbmRzIiwibXMiLCJncm91cHMiLCJOdW1iZXIiLCJwYXJzZUxpbmVzIiwiYmxvY2siLCJzcGxpdCIsIm1hcCIsImxpbmUiLCJ0cmltIiwiZmlsdGVyIiwiQm9vbGVhbiIsImNodW5rQXJyYXkiLCJpdGVtcyIsInNpemUiLCJyZXN1bHQiLCJpIiwibGVuZ3RoIiwicHVzaCIsInNsaWNlIiwicGFyc2VTcnQiLCJzcnQiLCJub3JtYWxpemVkIiwicmVwbGFjZSIsImxpbmVzIiwiaW5kZXhMaW5lIiwidGltZUxpbmUiLCJ0ZXh0TGluZXMiLCJ0aW1lTWF0Y2giLCJzdGFydE1zIiwiZW5kTXMiLCJ0ZXh0VmFsdWUiLCJqb2luIiwic3BlYWtlck1hdGNoIiwic3BlYWtlciIsInVuZGVmaW5lZCIsImNsZWFuZWRUZXh0IiwiaXNNZXRhZGF0YSIsInRlc3QiLCJpbmRleCIsInBhcnNlSW50IiwiZHVyYXRpb25NcyIsInRleHQiLCJyZWR1Y2UiLCJhY2MiLCJzZWdtZW50IiwiaWR4Iiwibm9ybWFsaXplZEluZGV4IiwiVHJhbnNjcmlwdEluZ2VzdGlvbiIsImJhc2UiLCJJbmdlc3RJbnB1dCIsImlucHV0T2JqZWN0IiwibmFtZSIsImZpZWxkcyIsInByb2plY3RJZCIsImFyZyIsInR5cGUiLCJub25OdWxsIiwiSUQiLCJ0aXRsZSIsIlN0cmluZyIsImludGVydmlld2VlTmFtZSIsInNvdXJjZVVybCIsImxhbmd1YWdlIiwibm90ZXMiLCJSZXN1bHQiLCJvYmplY3QiLCJ0cmFuc2NyaXB0SWQiLCJmaWVsZCIsInNlZ21lbnRzQ291bnQiLCJJbnQiLCJtdXRhdGlvbiIsImluZ2VzdFRyYW5zY3JpcHQiLCJhcmdzIiwiaW5wdXQiLCJyZXNvbHZlIiwiX3Jvb3QiLCJjb250ZXh0Iiwic2Vzc2lvbiIsImlkIiwib3JnSWQiLCJzdWRvQ29udGV4dCIsInN1ZG8iLCJwcm9qZWN0IiwicXVlcnkiLCJQcm9qZWN0IiwiZmluZE9uZSIsIndoZXJlIiwib3JnIiwic2VnbWVudHMiLCJ0cmFuc2NyaXB0IiwiZGIiLCJUcmFuc2NyaXB0IiwiY3JlYXRlT25lIiwiZGF0YSIsImNvbm5lY3QiLCJQcm9taXNlIiwiYWxsIiwiVHJhbnNjcmlwdFNlZ21lbnQiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(api)/../../schemas/extensions/TranscriptIngestion.ts\n");

/***/ }),

/***/ "(api)/../../schemas/extensions/index.ts":
/*!*****************************************!*\
  !*** ../../schemas/extensions/index.ts ***!
  \*****************************************/
/***/ ((module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.a(module, async (__webpack_handle_async_dependencies__, __webpack_async_result__) => { try {\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   ChatExtension: () => (/* reexport safe */ _Chat__WEBPACK_IMPORTED_MODULE_0__.ChatExtension),\n/* harmony export */   SCHEMA_EXTENSIONS: () => (/* binding */ SCHEMA_EXTENSIONS),\n/* harmony export */   TranscriptIngestion: () => (/* reexport safe */ _TranscriptIngestion__WEBPACK_IMPORTED_MODULE_1__.TranscriptIngestion)\n/* harmony export */ });\n/* harmony import */ var _Chat__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Chat */ \"(api)/../../schemas/extensions/Chat.ts\");\n/* harmony import */ var _TranscriptIngestion__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./TranscriptIngestion */ \"(api)/../../schemas/extensions/TranscriptIngestion.ts\");\nvar __webpack_async_dependencies__ = __webpack_handle_async_dependencies__([_Chat__WEBPACK_IMPORTED_MODULE_0__]);\n_Chat__WEBPACK_IMPORTED_MODULE_0__ = (__webpack_async_dependencies__.then ? (await __webpack_async_dependencies__)() : __webpack_async_dependencies__)[0];\n\n\nconst SCHEMA_EXTENSIONS = [\n    _TranscriptIngestion__WEBPACK_IMPORTED_MODULE_1__.TranscriptIngestion,\n    _Chat__WEBPACK_IMPORTED_MODULE_0__.ChatExtension\n];\n\n\n__webpack_async_result__();\n} catch(e) { __webpack_async_result__(e); } });//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi4vLi4vc2NoZW1hcy9leHRlbnNpb25zL2luZGV4LnRzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7O0FBQXVDO0FBQ3FCO0FBRXJELE1BQU1FLG9CQUFvQjtJQUFDRCxxRUFBbUJBO0lBQUVELGdEQUFhQTtDQUFDLENBQUM7QUFFeEIiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi4vLi4vc2NoZW1hcy9leHRlbnNpb25zL2luZGV4LnRzPzkyMGUiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQ2hhdEV4dGVuc2lvbiB9IGZyb20gJy4vQ2hhdCc7XG5pbXBvcnQgeyBUcmFuc2NyaXB0SW5nZXN0aW9uIH0gZnJvbSAnLi9UcmFuc2NyaXB0SW5nZXN0aW9uJztcblxuZXhwb3J0IGNvbnN0IFNDSEVNQV9FWFRFTlNJT05TID0gW1RyYW5zY3JpcHRJbmdlc3Rpb24sIENoYXRFeHRlbnNpb25dO1xuXG5leHBvcnQgeyBDaGF0RXh0ZW5zaW9uLCBUcmFuc2NyaXB0SW5nZXN0aW9uIH07XG4iXSwibmFtZXMiOlsiQ2hhdEV4dGVuc2lvbiIsIlRyYW5zY3JpcHRJbmdlc3Rpb24iLCJTQ0hFTUFfRVhURU5TSU9OUyJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(api)/../../schemas/extensions/index.ts\n");

/***/ }),

/***/ "(api)/../../schemas/graphqlExtensions.ts":
/*!******************************************!*\
  !*** ../../schemas/graphqlExtensions.ts ***!
  \******************************************/
/***/ ((module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.a(module, async (__webpack_handle_async_dependencies__, __webpack_async_result__) => { try {\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var _keystone_6_core__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @keystone-6/core */ \"@keystone-6/core\");\n/* harmony import */ var _keystone_6_core__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_keystone_6_core__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _extensions__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./extensions */ \"(api)/../../schemas/extensions/index.ts\");\nvar __webpack_async_dependencies__ = __webpack_handle_async_dependencies__([_extensions__WEBPACK_IMPORTED_MODULE_1__]);\n_extensions__WEBPACK_IMPORTED_MODULE_1__ = (__webpack_async_dependencies__.then ? (await __webpack_async_dependencies__)() : __webpack_async_dependencies__)[0];\n\n\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (_keystone_6_core__WEBPACK_IMPORTED_MODULE_0__.graphql.extend((base)=>_extensions__WEBPACK_IMPORTED_MODULE_1__.SCHEMA_EXTENSIONS.map((item)=>item(base))));\n\n__webpack_async_result__();\n} catch(e) { __webpack_async_result__(e); } });//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi4vLi4vc2NoZW1hcy9ncmFwaHFsRXh0ZW5zaW9ucy50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7O0FBQTJDO0FBQ007QUFFakQsaUVBQWVBLHFEQUFPQSxDQUFDRSxNQUFNLENBQUNDLENBQUFBLE9BQVEsMkRBQTJCQyxHQUFHLENBQUMsQ0FBQ0MsT0FBY0EsS0FBS0YsT0FBT0EsRUFBQyIsInNvdXJjZXMiOlsid2VicGFjazovLy8uLi8uLi9zY2hlbWFzL2dyYXBocWxFeHRlbnNpb25zLnRzP2ZiNGIiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgZ3JhcGhxbCB9IGZyb20gJ0BrZXlzdG9uZS02L2NvcmUnO1xuaW1wb3J0IHsgU0NIRU1BX0VYVEVOU0lPTlMgfSBmcm9tICcuL2V4dGVuc2lvbnMnO1xuXG5leHBvcnQgZGVmYXVsdCBncmFwaHFsLmV4dGVuZChiYXNlID0+IChTQ0hFTUFfRVhURU5TSU9OUyBhcyBhbnkpLm1hcCgoaXRlbTogYW55KSA9PiBpdGVtKGJhc2UpKSk7XG4iXSwibmFtZXMiOlsiZ3JhcGhxbCIsIlNDSEVNQV9FWFRFTlNJT05TIiwiZXh0ZW5kIiwiYmFzZSIsIm1hcCIsIml0ZW0iXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(api)/../../schemas/graphqlExtensions.ts\n");

/***/ }),

/***/ "(api)/../../schemas/index.ts":
/*!******************************!*\
  !*** ../../schemas/index.ts ***!
  \******************************/
/***/ ((module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.a(module, async (__webpack_handle_async_dependencies__, __webpack_async_result__) => { try {\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (/* reexport safe */ _schemas__WEBPACK_IMPORTED_MODULE_0__[\"default\"]),\n/* harmony export */   extendGraphqlSchema: () => (/* reexport safe */ _graphqlExtensions__WEBPACK_IMPORTED_MODULE_1__[\"default\"])\n/* harmony export */ });\n/* harmony import */ var _schemas__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./schemas */ \"(api)/../../schemas/schemas.ts\");\n/* harmony import */ var _graphqlExtensions__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./graphqlExtensions */ \"(api)/../../schemas/graphqlExtensions.ts\");\nvar __webpack_async_dependencies__ = __webpack_handle_async_dependencies__([_schemas__WEBPACK_IMPORTED_MODULE_0__, _graphqlExtensions__WEBPACK_IMPORTED_MODULE_1__]);\n([_schemas__WEBPACK_IMPORTED_MODULE_0__, _graphqlExtensions__WEBPACK_IMPORTED_MODULE_1__] = __webpack_async_dependencies__.then ? (await __webpack_async_dependencies__)() : __webpack_async_dependencies__);\n\n\n\n__webpack_async_result__();\n} catch(e) { __webpack_async_result__(e); } });//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi4vLi4vc2NoZW1hcy9pbmRleC50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7O0FBQW9DO0FBQ2lDIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLy4uLy4uL3NjaGVtYXMvaW5kZXgudHM/MzgxNyJdLCJzb3VyY2VzQ29udGVudCI6WyJleHBvcnQgeyBkZWZhdWx0IH0gZnJvbSAnLi9zY2hlbWFzJztcbmV4cG9ydCB7IGRlZmF1bHQgYXMgZXh0ZW5kR3JhcGhxbFNjaGVtYSB9IGZyb20gJy4vZ3JhcGhxbEV4dGVuc2lvbnMnO1xuIl0sIm5hbWVzIjpbImRlZmF1bHQiLCJleHRlbmRHcmFwaHFsU2NoZW1hIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(api)/../../schemas/index.ts\n");

/***/ }),

/***/ "(api)/../../schemas/schemas.ts":
/*!********************************!*\
  !*** ../../schemas/schemas.ts ***!
  \********************************/
/***/ ((module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.a(module, async (__webpack_handle_async_dependencies__, __webpack_async_result__) => { try {\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var _Chat__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Chat */ \"(api)/../../schemas/Chat.ts\");\n/* harmony import */ var _ChatMessage__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./ChatMessage */ \"(api)/../../schemas/ChatMessage.ts\");\n/* harmony import */ var _Organization__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./Organization */ \"(api)/../../schemas/Organization.ts\");\n/* harmony import */ var _Project__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./Project */ \"(api)/../../schemas/Project.ts\");\n/* harmony import */ var _Transcript__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./Transcript */ \"(api)/../../schemas/Transcript.ts\");\n/* harmony import */ var _TranscriptSegment__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./TranscriptSegment */ \"(api)/../../schemas/TranscriptSegment.ts\");\n/* harmony import */ var _User__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./User */ \"(api)/../../schemas/User.ts\");\nvar __webpack_async_dependencies__ = __webpack_handle_async_dependencies__([_TranscriptSegment__WEBPACK_IMPORTED_MODULE_5__]);\n_TranscriptSegment__WEBPACK_IMPORTED_MODULE_5__ = (__webpack_async_dependencies__.then ? (await __webpack_async_dependencies__)() : __webpack_async_dependencies__)[0];\n\n\n\n\n\n\n\nconst lists = {\n    Chat: _Chat__WEBPACK_IMPORTED_MODULE_0__[\"default\"],\n    ChatMessage: _ChatMessage__WEBPACK_IMPORTED_MODULE_1__[\"default\"],\n    Organization: _Organization__WEBPACK_IMPORTED_MODULE_2__[\"default\"],\n    Project: _Project__WEBPACK_IMPORTED_MODULE_3__[\"default\"],\n    Transcript: _Transcript__WEBPACK_IMPORTED_MODULE_4__[\"default\"],\n    TranscriptSegment: _TranscriptSegment__WEBPACK_IMPORTED_MODULE_5__[\"default\"],\n    User: _User__WEBPACK_IMPORTED_MODULE_6__[\"default\"]\n};\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (lists);\n\n__webpack_async_result__();\n} catch(e) { __webpack_async_result__(e); } });//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi4vLi4vc2NoZW1hcy9zY2hlbWFzLnRzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7O0FBQTBCO0FBQ2M7QUFDRTtBQUNWO0FBQ007QUFDYztBQUMxQjtBQUUxQixNQUFNTyxRQUFRO0lBQ1pQLElBQUlBLCtDQUFBQTtJQUNKQyxXQUFXQSxzREFBQUE7SUFDWEMsWUFBWUEsdURBQUFBO0lBQ1pDLE9BQU9BLGtEQUFBQTtJQUNQQyxVQUFVQSxxREFBQUE7SUFDVkMsaUJBQWlCQSw0REFBQUE7SUFDakJDLElBQUlBLCtDQUFBQTtBQUNOO0FBRUEsaUVBQWVDLEtBQUtBLEVBQUMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi4vLi4vc2NoZW1hcy9zY2hlbWFzLnRzPzIxZTQiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IENoYXQgZnJvbSAnLi9DaGF0JztcbmltcG9ydCBDaGF0TWVzc2FnZSBmcm9tICcuL0NoYXRNZXNzYWdlJztcbmltcG9ydCBPcmdhbml6YXRpb24gZnJvbSAnLi9Pcmdhbml6YXRpb24nO1xuaW1wb3J0IFByb2plY3QgZnJvbSAnLi9Qcm9qZWN0JztcbmltcG9ydCBUcmFuc2NyaXB0IGZyb20gJy4vVHJhbnNjcmlwdCc7XG5pbXBvcnQgVHJhbnNjcmlwdFNlZ21lbnQgZnJvbSAnLi9UcmFuc2NyaXB0U2VnbWVudCc7XG5pbXBvcnQgVXNlciBmcm9tICcuL1VzZXInO1xuXG5jb25zdCBsaXN0cyA9IHtcbiAgQ2hhdCxcbiAgQ2hhdE1lc3NhZ2UsXG4gIE9yZ2FuaXphdGlvbixcbiAgUHJvamVjdCxcbiAgVHJhbnNjcmlwdCxcbiAgVHJhbnNjcmlwdFNlZ21lbnQsXG4gIFVzZXJcbn07XG5cbmV4cG9ydCBkZWZhdWx0IGxpc3RzO1xuIl0sIm5hbWVzIjpbIkNoYXQiLCJDaGF0TWVzc2FnZSIsIk9yZ2FuaXphdGlvbiIsIlByb2plY3QiLCJUcmFuc2NyaXB0IiwiVHJhbnNjcmlwdFNlZ21lbnQiLCJVc2VyIiwibGlzdHMiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(api)/../../schemas/schemas.ts\n");

/***/ }),

/***/ "(api)/../../services/chat.ts":
/*!******************************!*\
  !*** ../../services/chat.ts ***!
  \******************************/
/***/ ((module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.a(module, async (__webpack_handle_async_dependencies__, __webpack_async_result__) => { try {\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   loadChatHistory: () => (/* binding */ loadChatHistory),\n/* harmony export */   runChatConversation: () => (/* binding */ runChatConversation)\n/* harmony export */ });\n/* harmony import */ var _lib_openai__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../lib/openai */ \"(api)/../../lib/openai.ts\");\n/* harmony import */ var _lib_pgvector__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../lib/pgvector */ \"(api)/../../lib/pgvector.ts\");\nvar __webpack_async_dependencies__ = __webpack_handle_async_dependencies__([_lib_openai__WEBPACK_IMPORTED_MODULE_0__]);\n_lib_openai__WEBPACK_IMPORTED_MODULE_0__ = (__webpack_async_dependencies__.then ? (await __webpack_async_dependencies__)() : __webpack_async_dependencies__)[0];\n\n\nconst formatMs = (value)=>{\n    if (typeof value !== \"number\") return \"00:00:00\";\n    const totalSeconds = Math.max(0, Math.floor(value / 1000));\n    const hours = Math.floor(totalSeconds / 3600);\n    const minutes = Math.floor(totalSeconds % 3600 / 60);\n    const seconds = totalSeconds % 60;\n    return [\n        hours,\n        minutes,\n        seconds\n    ].map((unit)=>unit.toString().padStart(2, \"0\")).join(\":\");\n};\nconst buildSegmentDescription = (segment)=>`${segment.speaker ?? \"Speaker\"} (${formatMs(segment.startMs)} - ${formatMs(segment.endMs)}): ${segment.text}`;\nconst mapSegmentReference = (segment)=>({\n        id: segment.id,\n        startMs: typeof segment.startMs === \"number\" ? segment.startMs : null,\n        endMs: typeof segment.endMs === \"number\" ? segment.endMs : null,\n        text: segment.text,\n        speaker: segment.speaker ?? undefined,\n        transcriptTitle: segment.transcript?.title ?? undefined\n    });\nconst VECTOR_LIMIT = 40;\nconst mapRawToSegment = (row)=>({\n        id: row.id,\n        text: row.text,\n        startMs: row.startMs ?? null,\n        endMs: row.endMs ?? null,\n        speaker: row.speaker ?? undefined,\n        isMetadata: row.isMetadata ?? false,\n        transcript: row.transcriptId ? {\n            id: row.transcriptId,\n            title: row.transcriptTitle ?? null\n        } : null\n    });\nconst fetchSegments = async ({ context, contextType, projectId, transcriptId, queryText })=>{\n    const sudoContext = context.sudo();\n    const fallback = async ()=>{\n        const baseArgs = contextType === \"TRANSCRIPT\" ? {\n            where: {\n                transcript: {\n                    id: {\n                        equals: transcriptId\n                    }\n                }\n            }\n        } : {\n            where: {\n                transcript: {\n                    project: {\n                        id: {\n                            equals: projectId\n                        }\n                    }\n                }\n            }\n        };\n        const segments = await sudoContext.query.TranscriptSegment.findMany({\n            ...baseArgs,\n            orderBy: [\n                {\n                    startMs: \"asc\"\n                }\n            ],\n            take: VECTOR_LIMIT,\n            query: \"id text startMs endMs speaker isMetadata transcript { id title project { id } }\"\n        });\n        return segments.filter((segment)=>segment.text && !segment.isMetadata).map((segment)=>({\n                id: segment.id,\n                text: segment.text,\n                startMs: segment.startMs,\n                endMs: segment.endMs,\n                speaker: segment.speaker,\n                isMetadata: segment.isMetadata,\n                transcript: segment.transcript ? {\n                    id: segment.transcript.id,\n                    title: segment.transcript.title ?? null\n                } : null\n            }));\n    };\n    const runVectorSearch = async (text)=>{\n        if (!text.trim()) return [];\n        if (contextType === \"TRANSCRIPT\" && !transcriptId) return [];\n        if (contextType === \"PROJECT\" && !projectId) return [];\n        try {\n            const embeddings = await (0,_lib_openai__WEBPACK_IMPORTED_MODULE_0__.createEmbeddings)([\n                text\n            ]);\n            const embedding = embeddings?.[0];\n            if (!embedding?.length) return [];\n            const literal = (0,_lib_pgvector__WEBPACK_IMPORTED_MODULE_1__.formatVectorLiteral)(embedding);\n            const joinClause = contextType === \"PROJECT\" ? 'INNER JOIN \"Transcript\" t ON t.id = \"TranscriptSegment\".\"transcriptId\"' : 'LEFT JOIN \"Transcript\" t ON t.id = \"TranscriptSegment\".\"transcriptId\"';\n            const whereClause = contextType === \"TRANSCRIPT\" ? `\"TranscriptSegment\".\"transcriptId\" = '${transcriptId}'` : `\"Transcript\".\"projectId\" = '${projectId}'`;\n            const rows = await sudoContext.prisma.$queryRawUnsafe(`\n        SELECT\n          \"TranscriptSegment\".\"id\",\n          \"TranscriptSegment\".\"text\",\n          \"TranscriptSegment\".\"startMs\",\n          \"TranscriptSegment\".\"endMs\",\n          \"TranscriptSegment\".\"speaker\",\n          \"TranscriptSegment\".\"isMetadata\",\n          t.\"id\" AS \"transcriptId\",\n          t.\"title\" AS \"transcriptTitle\"\n        FROM \"TranscriptSegment\"\n        ${joinClause}\n        WHERE \"TranscriptSegment\".\"isMetadata\" = FALSE\n          AND \"TranscriptSegment\".\"embedding\" IS NOT NULL\n          AND ${whereClause}\n        ORDER BY \"TranscriptSegment\".\"embedding\" <-> ${literal}\n        LIMIT ${VECTOR_LIMIT}\n      `) ?? [];\n            return rows.map(mapRawToSegment);\n        } catch (error) {\n            console.error(\"Vector search fallback\", error);\n            return [];\n        }\n    };\n    if (queryText) {\n        const vectorSegments = await runVectorSearch(queryText);\n        if (vectorSegments.length) return vectorSegments;\n    }\n    return fallback();\n};\nconst fetchChatHistory = async (context, chatId)=>{\n    const sudoContext = context.sudo();\n    const messages = await sudoContext.query.ChatMessage.findMany({\n        where: {\n            chat: {\n                id: {\n                    equals: chatId\n                }\n            }\n        },\n        orderBy: [\n            {\n                createdAt: \"asc\"\n            }\n        ],\n        query: \"id role content createdAt segments { id text startMs endMs speaker transcript { title } }\"\n    });\n    return messages.map((msg)=>({\n            id: msg.id,\n            role: msg.role,\n            content: msg.content,\n            createdAt: msg.createdAt ?? null,\n            segments: (msg.segments ?? []).map((segment)=>({\n                    id: segment.id,\n                    text: segment.text,\n                    startMs: typeof segment.startMs === \"number\" ? segment.startMs : null,\n                    endMs: typeof segment.endMs === \"number\" ? segment.endMs : null,\n                    speaker: segment.speaker ?? undefined,\n                    transcriptTitle: segment.transcript?.title ?? undefined\n                }))\n        }));\n};\nconst getOpenAiMessages = ({ history, systemPrompt, userMessage })=>{\n    const trimmedHistory = history.slice(-6);\n    const messages = [\n        {\n            role: \"system\",\n            content: systemPrompt\n        }\n    ];\n    trimmedHistory.forEach((item)=>messages.push({\n            role: item.role,\n            content: item.content\n        }));\n    messages.push({\n        role: \"user\",\n        content: userMessage\n    });\n    return messages;\n};\nconst getSystemPrompt = ({ contextType, projectName, transcriptName })=>{\n    if (contextType === \"TRANSCRIPT\") {\n        return `You are an interview intelligence assistant. Use timestamps and transcript snippets when you answer questions about \"${transcriptName ?? \"this transcript\"}\".`;\n    }\n    return `You are an insights assistant for the \"${projectName ?? \"project\"}\" workspace. Lean on the available transcript segments when summarizing or answering questions.`;\n};\nconst runChatConversation = async ({ context, session, input, contextType })=>{\n    if (!session?.id) throw new Error(\"Unauthorized\");\n    if (!session?.orgId) throw new Error(\"Missing organization context\");\n    const sudoContext = context.sudo();\n    const messageText = input.message.trim();\n    if (!messageText) throw new Error(\"Message cannot be empty\");\n    let targetProject = null;\n    let targetTranscript = null;\n    if (contextType === \"TRANSCRIPT\") {\n        if (!input.transcriptId) throw new Error(\"Transcript ID is required\");\n        targetTranscript = await sudoContext.query.Transcript.findOne({\n            where: {\n                id: input.transcriptId\n            },\n            query: \"id title project { id name org { id } } org { id }\"\n        });\n        if (!targetTranscript) throw new Error(\"Transcript not found\");\n        if (!targetTranscript.project?.id) throw new Error(\"Transcript is missing project reference\");\n        targetProject = targetTranscript.project;\n    } else {\n        if (!input.projectId) throw new Error(\"Project ID is required\");\n        targetProject = await sudoContext.query.Project.findOne({\n            where: {\n                id: input.projectId\n            },\n            query: \"id name org { id }\"\n        });\n        if (!targetProject) throw new Error(\"Project not found\");\n    }\n    if (!targetProject?.org?.id && !targetTranscript?.org?.id) {\n        throw new Error(\"Missing organization context for chat target\");\n    }\n    const projectId = targetProject?.id ?? null;\n    const transcriptId = targetTranscript?.id ?? null;\n    const segments = await fetchSegments({\n        context,\n        contextType,\n        projectId: projectId ?? undefined,\n        transcriptId: transcriptId ?? undefined,\n        queryText: messageText\n    });\n    if (!segments.length) {\n        throw new Error(\"No transcript segments found for this context yet\");\n    }\n    const referenceSegments = segments.slice(0, 3);\n    const segmentsForPrompt = segments.slice(0, 8);\n    const segmentsText = segmentsForPrompt.map(buildSegmentDescription).join(\"\\n\");\n    const systemPrompt = getSystemPrompt({\n        contextType,\n        projectName: targetProject?.name,\n        transcriptName: targetTranscript?.title\n    });\n    let chatId = input.chatId ?? null;\n    if (!chatId) {\n        const existingChats = await sudoContext.query.Chat.findMany({\n            where: {\n                contextType,\n                ...contextType === \"TRANSCRIPT\" ? {\n                    transcript: {\n                        id: {\n                            equals: transcriptId\n                        }\n                    }\n                } : {\n                    project: {\n                        id: {\n                            equals: projectId\n                        }\n                    }\n                }\n            },\n            orderBy: [\n                {\n                    createdAt: \"desc\"\n                }\n            ],\n            take: 1,\n            query: \"id\"\n        });\n        chatId = existingChats?.[0]?.id ?? null;\n    }\n    if (!chatId) {\n        const created = await sudoContext.db.Chat.createOne({\n            data: {\n                title: contextType === \"TRANSCRIPT\" ? `Transcript chat  ${targetTranscript?.title ?? \"untitled\"}` : `Project chat  ${targetProject?.name ?? \"untitled\"}`,\n                contextType,\n                org: {\n                    connect: {\n                        id: session.orgId\n                    }\n                },\n                ...projectId ? {\n                    project: {\n                        connect: {\n                            id: projectId\n                        }\n                    }\n                } : {},\n                ...transcriptId ? {\n                    transcript: {\n                        connect: {\n                            id: transcriptId\n                        }\n                    }\n                } : {}\n            }\n        });\n        if (!created?.id) throw new Error(\"Failed to create chat session\");\n        chatId = created.id;\n    }\n    const history = await fetchChatHistory(context, chatId);\n    const systemMessages = getOpenAiMessages({\n        history: history.map((item)=>({\n                role: item.role,\n                content: item.content\n            })),\n        systemPrompt,\n        userMessage: `${segmentsText}\\n\\nQuestion: ${messageText}`\n    });\n    const openai = (0,_lib_openai__WEBPACK_IMPORTED_MODULE_0__.getOpenAIClient)();\n    const completion = await openai.chat.completions.create({\n        model: _lib_openai__WEBPACK_IMPORTED_MODULE_0__.openAiModel,\n        messages: systemMessages,\n        temperature: 0.25,\n        max_tokens: 700\n    });\n    const answer = completion.choices?.[0]?.message?.content?.trim();\n    if (!answer) {\n        throw new Error(\"OpenAI did not return an answer\");\n    }\n    await sudoContext.db.ChatMessage.createOne({\n        data: {\n            chat: {\n                connect: {\n                    id: chatId\n                }\n            },\n            role: \"user\",\n            content: messageText\n        }\n    });\n    await sudoContext.db.ChatMessage.createOne({\n        data: {\n            chat: {\n                connect: {\n                    id: chatId\n                }\n            },\n            role: \"assistant\",\n            content: answer,\n            ...referenceSegments.length ? {\n                segments: {\n                    connect: referenceSegments.map((segment)=>({\n                            id: segment.id\n                        }))\n                }\n            } : {}\n        }\n    });\n    const updatedHistory = await fetchChatHistory(context, chatId);\n    return {\n        chatId,\n        answer,\n        messages: updatedHistory,\n        references: referenceSegments.map(mapSegmentReference)\n    };\n};\nconst loadChatHistory = fetchChatHistory;\n\n__webpack_async_result__();\n} catch(e) { __webpack_async_result__(e); } });//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QVMsQ0FBQztRQUN6Q0MsTUFBTTtZQUNKdkMsTUFBTTtnQkFBRXdDLFNBQVM7b0JBQUV2RixJQUFJNEM7Z0JBQU87WUFBRTtZQUNoQ00sTUFBTTtZQUNOQyxTQUFTNkM7WUFDVCxHQUFJbkIsa0JBQWtCNUMsTUFBTSxHQUN4QjtnQkFBRVgsVUFBVTtvQkFBRWlFLFNBQVNWLGtCQUFrQnpGLEdBQUcsQ0FBQ00sQ0FBQUEsVUFBWTs0QkFBRU0sSUFBSU4sUUFBUU0sRUFBRTt3QkFBQztnQkFBSTtZQUFFLElBQ2hGLENBQUMsQ0FBQztRQUNSO0lBQ0Y7SUFFQSxNQUFNa0csaUJBQWlCLE1BQU12RCxpQkFBaUJoQyxTQUFTaUM7SUFFdkQsT0FBTztRQUNMQTtRQUNBb0Q7UUFDQW5ELFVBQVVxRDtRQUNWQyxZQUFZdEIsa0JBQWtCekYsR0FBRyxDQUFDVztJQUNwQztBQUNGLEVBQUU7QUFFSyxNQUFNcUcsa0JBQWtCekQsaUJBQWlCIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLy4uLy4uL3NlcnZpY2VzL2NoYXQudHM/ZmI4ZCJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgdHlwZSB7IEtleXN0b25lQ29udGV4dCB9IGZyb20gJ0BrZXlzdG9uZS02L2NvcmUvdHlwZXMnO1xuaW1wb3J0IHR5cGUgeyBTZXNzaW9uIH0gZnJvbSAnLi4vYXV0aCc7XG5pbXBvcnQgeyBjcmVhdGVFbWJlZGRpbmdzLCBnZXRPcGVuQUlDbGllbnQsIG9wZW5BaU1vZGVsIH0gZnJvbSAnLi4vbGliL29wZW5haSc7XG5pbXBvcnQgeyBmb3JtYXRWZWN0b3JMaXRlcmFsIH0gZnJvbSAnLi4vbGliL3BndmVjdG9yJztcblxudHlwZSBDaGF0Q29udGV4dFR5cGUgPSAnVFJBTlNDUklQVCcgfCAnUFJPSkVDVCc7XG5cbnR5cGUgU2VnbWVudFJlY29yZCA9IHtcbiAgaWQ6IHN0cmluZztcbiAgdGV4dDogc3RyaW5nO1xuICBzdGFydE1zPzogbnVtYmVyIHwgbnVsbDtcbiAgZW5kTXM/OiBudW1iZXIgfCBudWxsO1xuICBzcGVha2VyPzogc3RyaW5nIHwgbnVsbDtcbiAgaXNNZXRhZGF0YT86IGJvb2xlYW4gfCBudWxsO1xuICB0cmFuc2NyaXB0Pzoge1xuICAgIGlkOiBzdHJpbmc7XG4gICAgdGl0bGU/OiBzdHJpbmcgfCBudWxsO1xuICB9IHwgbnVsbDtcbn07XG5cbmV4cG9ydCB0eXBlIFNlZ21lbnRSZWZlcmVuY2UgPSB7XG4gIGlkOiBzdHJpbmc7XG4gIHRleHQ6IHN0cmluZztcbiAgc3RhcnRNczogbnVtYmVyIHwgbnVsbDtcbiAgZW5kTXM6IG51bWJlciB8IG51bGw7XG4gIHNwZWFrZXI/OiBzdHJpbmcgfCBudWxsO1xuICB0cmFuc2NyaXB0VGl0bGU/OiBzdHJpbmcgfCBudWxsO1xufTtcblxuZXhwb3J0IHR5cGUgQ2hhdEhpc3RvcnlJdGVtID0ge1xuICBpZDogc3RyaW5nO1xuICByb2xlOiAndXNlcicgfCAnYXNzaXN0YW50JztcbiAgY29udGVudDogc3RyaW5nO1xuICBjcmVhdGVkQXQ6IHN0cmluZyB8IG51bGw7XG4gIHNlZ21lbnRzOiBTZWdtZW50UmVmZXJlbmNlW107XG59O1xuXG5jb25zdCBmb3JtYXRNcyA9ICh2YWx1ZT86IG51bWJlciB8IG51bGwpID0+IHtcbiAgaWYgKHR5cGVvZiB2YWx1ZSAhPT0gJ251bWJlcicpIHJldHVybiAnMDA6MDA6MDAnO1xuICBjb25zdCB0b3RhbFNlY29uZHMgPSBNYXRoLm1heCgwLCBNYXRoLmZsb29yKHZhbHVlIC8gMTAwMCkpO1xuICBjb25zdCBob3VycyA9IE1hdGguZmxvb3IodG90YWxTZWNvbmRzIC8gMzYwMCk7XG4gIGNvbnN0IG1pbnV0ZXMgPSBNYXRoLmZsb29yKCh0b3RhbFNlY29uZHMgJSAzNjAwKSAvIDYwKTtcbiAgY29uc3Qgc2Vjb25kcyA9IHRvdGFsU2Vjb25kcyAlIDYwO1xuICByZXR1cm4gW2hvdXJzLCBtaW51dGVzLCBzZWNvbmRzXS5tYXAodW5pdCA9PiB1bml0LnRvU3RyaW5nKCkucGFkU3RhcnQoMiwgJzAnKSkuam9pbignOicpO1xufTtcblxuY29uc3QgYnVpbGRTZWdtZW50RGVzY3JpcHRpb24gPSAoc2VnbWVudDogU2VnbWVudFJlY29yZCkgPT5cbiAgYCR7c2VnbWVudC5zcGVha2VyID8/ICdTcGVha2VyJ30gKCR7Zm9ybWF0TXMoc2VnbWVudC5zdGFydE1zKX0gLSAke2Zvcm1hdE1zKHNlZ21lbnQuZW5kTXMpfSk6ICR7c2VnbWVudC50ZXh0fWA7XG5cbmNvbnN0IG1hcFNlZ21lbnRSZWZlcmVuY2UgPSAoc2VnbWVudDogU2VnbWVudFJlY29yZCk6IFNlZ21lbnRSZWZlcmVuY2UgPT4gKHtcbiAgaWQ6IHNlZ21lbnQuaWQsXG4gIHN0YXJ0TXM6IHR5cGVvZiBzZWdtZW50LnN0YXJ0TXMgPT09ICdudW1iZXInID8gc2VnbWVudC5zdGFydE1zIDogbnVsbCxcbiAgZW5kTXM6IHR5cGVvZiBzZWdtZW50LmVuZE1zID09PSAnbnVtYmVyJyA/IHNlZ21lbnQuZW5kTXMgOiBudWxsLFxuICB0ZXh0OiBzZWdtZW50LnRleHQsXG4gIHNwZWFrZXI6IHNlZ21lbnQuc3BlYWtlciA/PyB1bmRlZmluZWQsXG4gIHRyYW5zY3JpcHRUaXRsZTogc2VnbWVudC50cmFuc2NyaXB0Py50aXRsZSA/PyB1bmRlZmluZWRcbn0pO1xuXG50eXBlIEZldGNoU2VnbWVudHNQYXJhbXMgPSB7XG4gIGNvbnRleHQ6IEtleXN0b25lQ29udGV4dDtcbiAgY29udGV4dFR5cGU6IENoYXRDb250ZXh0VHlwZTtcbiAgcHJvamVjdElkPzogc3RyaW5nO1xuICB0cmFuc2NyaXB0SWQ/OiBzdHJpbmc7XG4gIHF1ZXJ5VGV4dD86IHN0cmluZztcbn07XG5cbnR5cGUgUmF3U2VnbWVudCA9IHtcbiAgaWQ6IHN0cmluZztcbiAgdGV4dDogc3RyaW5nO1xuICBzdGFydE1zOiBudW1iZXIgfCBudWxsO1xuICBlbmRNczogbnVtYmVyIHwgbnVsbDtcbiAgc3BlYWtlcjogc3RyaW5nIHwgbnVsbDtcbiAgaXNNZXRhZGF0YTogYm9vbGVhbiB8IG51bGw7XG4gIHRyYW5zY3JpcHRJZD86IHN0cmluZyB8IG51bGw7XG4gIHRyYW5zY3JpcHRUaXRsZT86IHN0cmluZyB8IG51bGw7XG59O1xuXG5jb25zdCBWRUNUT1JfTElNSVQgPSA0MDtcblxuY29uc3QgbWFwUmF3VG9TZWdtZW50ID0gKHJvdzogUmF3U2VnbWVudCk6IFNlZ21lbnRSZWNvcmQgPT4gKHtcbiAgaWQ6IHJvdy5pZCxcbiAgdGV4dDogcm93LnRleHQsXG4gIHN0YXJ0TXM6IHJvdy5zdGFydE1zID8/IG51bGwsXG4gIGVuZE1zOiByb3cuZW5kTXMgPz8gbnVsbCxcbiAgc3BlYWtlcjogcm93LnNwZWFrZXIgPz8gdW5kZWZpbmVkLFxuICBpc01ldGFkYXRhOiByb3cuaXNNZXRhZGF0YSA/PyBmYWxzZSxcbiAgdHJhbnNjcmlwdDogcm93LnRyYW5zY3JpcHRJZFxuICAgID8ge1xuICAgICAgICBpZDogcm93LnRyYW5zY3JpcHRJZCxcbiAgICAgICAgdGl0bGU6IHJvdy50cmFuc2NyaXB0VGl0bGUgPz8gbnVsbFxuICAgICAgfVxuICAgIDogbnVsbFxufSk7XG5cbmNvbnN0IGZldGNoU2VnbWVudHMgPSBhc3luYyAoeyBjb250ZXh0LCBjb250ZXh0VHlwZSwgcHJvamVjdElkLCB0cmFuc2NyaXB0SWQsIHF1ZXJ5VGV4dCB9OiBGZXRjaFNlZ21lbnRzUGFyYW1zKSA9PiB7XG4gIGNvbnN0IHN1ZG9Db250ZXh0ID0gY29udGV4dC5zdWRvKCk7XG5cbiAgY29uc3QgZmFsbGJhY2sgPSBhc3luYyAoKSA9PiB7XG4gICAgY29uc3QgYmFzZUFyZ3MgPVxuICAgICAgY29udGV4dFR5cGUgPT09ICdUUkFOU0NSSVBUJ1xuICAgICAgICA/IHtcbiAgICAgICAgICAgIHdoZXJlOiB7IHRyYW5zY3JpcHQ6IHsgaWQ6IHsgZXF1YWxzOiB0cmFuc2NyaXB0SWQgfSB9IH1cbiAgICAgICAgICB9XG4gICAgICAgIDoge1xuICAgICAgICAgICAgd2hlcmU6IHtcbiAgICAgICAgICAgICAgdHJhbnNjcmlwdDoge1xuICAgICAgICAgICAgICAgIHByb2plY3Q6IHtcbiAgICAgICAgICAgICAgICAgIGlkOiB7IGVxdWFsczogcHJvamVjdElkIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9O1xuXG4gICAgY29uc3Qgc2VnbWVudHMgPSBhd2FpdCBzdWRvQ29udGV4dC5xdWVyeS5UcmFuc2NyaXB0U2VnbWVudC5maW5kTWFueSh7XG4gICAgICAuLi5iYXNlQXJncyxcbiAgICAgIG9yZGVyQnk6IFt7IHN0YXJ0TXM6ICdhc2MnIH1dLFxuICAgICAgdGFrZTogVkVDVE9SX0xJTUlULFxuICAgICAgcXVlcnk6ICdpZCB0ZXh0IHN0YXJ0TXMgZW5kTXMgc3BlYWtlciBpc01ldGFkYXRhIHRyYW5zY3JpcHQgeyBpZCB0aXRsZSBwcm9qZWN0IHsgaWQgfSB9J1xuICAgIH0pO1xuXG4gICAgcmV0dXJuIHNlZ21lbnRzXG4gICAgICAuZmlsdGVyKHNlZ21lbnQgPT4gc2VnbWVudC50ZXh0ICYmICFzZWdtZW50LmlzTWV0YWRhdGEpXG4gICAgICAubWFwKHNlZ21lbnQgPT4gKHtcbiAgICAgICAgaWQ6IHNlZ21lbnQuaWQsXG4gICAgICAgIHRleHQ6IHNlZ21lbnQudGV4dCxcbiAgICAgICAgc3RhcnRNczogc2VnbWVudC5zdGFydE1zLFxuICAgICAgICBlbmRNczogc2VnbWVudC5lbmRNcyxcbiAgICAgICAgc3BlYWtlcjogc2VnbWVudC5zcGVha2VyLFxuICAgICAgICBpc01ldGFkYXRhOiBzZWdtZW50LmlzTWV0YWRhdGEsXG4gICAgICAgIHRyYW5zY3JpcHQ6IHNlZ21lbnQudHJhbnNjcmlwdFxuICAgICAgICAgID8ge1xuICAgICAgICAgICAgICBpZDogc2VnbWVudC50cmFuc2NyaXB0LmlkLFxuICAgICAgICAgICAgICB0aXRsZTogc2VnbWVudC50cmFuc2NyaXB0LnRpdGxlID8/IG51bGxcbiAgICAgICAgICAgIH1cbiAgICAgICAgICA6IG51bGxcbiAgICAgIH0pKTtcbiAgfTtcblxuICBjb25zdCBydW5WZWN0b3JTZWFyY2ggPSBhc3luYyAodGV4dDogc3RyaW5nKSA9PiB7XG4gICAgaWYgKCF0ZXh0LnRyaW0oKSkgcmV0dXJuIFtdO1xuICAgIGlmIChjb250ZXh0VHlwZSA9PT0gJ1RSQU5TQ1JJUFQnICYmICF0cmFuc2NyaXB0SWQpIHJldHVybiBbXTtcbiAgICBpZiAoY29udGV4dFR5cGUgPT09ICdQUk9KRUNUJyAmJiAhcHJvamVjdElkKSByZXR1cm4gW107XG5cbiAgICB0cnkge1xuICAgICAgY29uc3QgZW1iZWRkaW5ncyA9IGF3YWl0IGNyZWF0ZUVtYmVkZGluZ3MoW3RleHRdKTtcbiAgICAgIGNvbnN0IGVtYmVkZGluZyA9IGVtYmVkZGluZ3M/LlswXTtcbiAgICAgIGlmICghZW1iZWRkaW5nPy5sZW5ndGgpIHJldHVybiBbXTtcblxuICAgICAgY29uc3QgbGl0ZXJhbCA9IGZvcm1hdFZlY3RvckxpdGVyYWwoZW1iZWRkaW5nKTtcbiAgICAgIGNvbnN0IGpvaW5DbGF1c2UgPVxuICAgICAgICBjb250ZXh0VHlwZSA9PT0gJ1BST0pFQ1QnXG4gICAgICAgICAgPyAnSU5ORVIgSk9JTiBcIlRyYW5zY3JpcHRcIiB0IE9OIHQuaWQgPSBcIlRyYW5zY3JpcHRTZWdtZW50XCIuXCJ0cmFuc2NyaXB0SWRcIidcbiAgICAgICAgICA6ICdMRUZUIEpPSU4gXCJUcmFuc2NyaXB0XCIgdCBPTiB0LmlkID0gXCJUcmFuc2NyaXB0U2VnbWVudFwiLlwidHJhbnNjcmlwdElkXCInO1xuICAgICAgY29uc3Qgd2hlcmVDbGF1c2UgPVxuICAgICAgICBjb250ZXh0VHlwZSA9PT0gJ1RSQU5TQ1JJUFQnXG4gICAgICAgICAgPyBgXCJUcmFuc2NyaXB0U2VnbWVudFwiLlwidHJhbnNjcmlwdElkXCIgPSAnJHt0cmFuc2NyaXB0SWR9J2BcbiAgICAgICAgICA6IGBcIlRyYW5zY3JpcHRcIi5cInByb2plY3RJZFwiID0gJyR7cHJvamVjdElkfSdgO1xuXG4gICAgICBjb25zdCByb3dzID1cbiAgICAgICAgKGF3YWl0IHN1ZG9Db250ZXh0LnByaXNtYS4kcXVlcnlSYXdVbnNhZmU8UmF3U2VnbWVudD4oYFxuICAgICAgICBTRUxFQ1RcbiAgICAgICAgICBcIlRyYW5zY3JpcHRTZWdtZW50XCIuXCJpZFwiLFxuICAgICAgICAgIFwiVHJhbnNjcmlwdFNlZ21lbnRcIi5cInRleHRcIixcbiAgICAgICAgICBcIlRyYW5zY3JpcHRTZWdtZW50XCIuXCJzdGFydE1zXCIsXG4gICAgICAgICAgXCJUcmFuc2NyaXB0U2VnbWVudFwiLlwiZW5kTXNcIixcbiAgICAgICAgICBcIlRyYW5zY3JpcHRTZWdtZW50XCIuXCJzcGVha2VyXCIsXG4gICAgICAgICAgXCJUcmFuc2NyaXB0U2VnbWVudFwiLlwiaXNNZXRhZGF0YVwiLFxuICAgICAgICAgIHQuXCJpZFwiIEFTIFwidHJhbnNjcmlwdElkXCIsXG4gICAgICAgICAgdC5cInRpdGxlXCIgQVMgXCJ0cmFuc2NyaXB0VGl0bGVcIlxuICAgICAgICBGUk9NIFwiVHJhbnNjcmlwdFNlZ21lbnRcIlxuICAgICAgICAke2pvaW5DbGF1c2V9XG4gICAgICAgIFdIRVJFIFwiVHJhbnNjcmlwdFNlZ21lbnRcIi5cImlzTWV0YWRhdGFcIiA9IEZBTFNFXG4gICAgICAgICAgQU5EIFwiVHJhbnNjcmlwdFNlZ21lbnRcIi5cImVtYmVkZGluZ1wiIElTIE5PVCBOVUxMXG4gICAgICAgICAgQU5EICR7d2hlcmVDbGF1c2V9XG4gICAgICAgIE9SREVSIEJZIFwiVHJhbnNjcmlwdFNlZ21lbnRcIi5cImVtYmVkZGluZ1wiIDwtPiAke2xpdGVyYWx9XG4gICAgICAgIExJTUlUICR7VkVDVE9SX0xJTUlUfVxuICAgICAgYCkpID8/IFtdO1xuXG4gICAgICByZXR1cm4gcm93cy5tYXAobWFwUmF3VG9TZWdtZW50KTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcignVmVjdG9yIHNlYXJjaCBmYWxsYmFjaycsIGVycm9yKTtcbiAgICAgIHJldHVybiBbXTtcbiAgICB9XG4gIH07XG5cbiAgaWYgKHF1ZXJ5VGV4dCkge1xuICAgIGNvbnN0IHZlY3RvclNlZ21lbnRzID0gYXdhaXQgcnVuVmVjdG9yU2VhcmNoKHF1ZXJ5VGV4dCk7XG4gICAgaWYgKHZlY3RvclNlZ21lbnRzLmxlbmd0aCkgcmV0dXJuIHZlY3RvclNlZ21lbnRzO1xuICB9XG5cbiAgcmV0dXJuIGZhbGxiYWNrKCk7XG59O1xuXG5jb25zdCBmZXRjaENoYXRIaXN0b3J5ID0gYXN5bmMgKGNvbnRleHQ6IEtleXN0b25lQ29udGV4dCwgY2hhdElkOiBzdHJpbmcpOiBQcm9taXNlPENoYXRIaXN0b3J5SXRlbVtdPiA9PiB7XG4gIGNvbnN0IHN1ZG9Db250ZXh0ID0gY29udGV4dC5zdWRvKCk7XG4gIGNvbnN0IG1lc3NhZ2VzID0gYXdhaXQgc3Vkb0NvbnRleHQucXVlcnkuQ2hhdE1lc3NhZ2UuZmluZE1hbnkoe1xuICAgIHdoZXJlOiB7IGNoYXQ6IHsgaWQ6IHsgZXF1YWxzOiBjaGF0SWQgfSB9IH0sXG4gICAgb3JkZXJCeTogW3sgY3JlYXRlZEF0OiAnYXNjJyB9XSxcbiAgICBxdWVyeTogJ2lkIHJvbGUgY29udGVudCBjcmVhdGVkQXQgc2VnbWVudHMgeyBpZCB0ZXh0IHN0YXJ0TXMgZW5kTXMgc3BlYWtlciB0cmFuc2NyaXB0IHsgdGl0bGUgfSB9J1xuICB9KTtcblxuICByZXR1cm4gbWVzc2FnZXMubWFwKG1zZyA9PiAoe1xuICAgIGlkOiBtc2cuaWQsXG4gICAgcm9sZTogbXNnLnJvbGUgYXMgJ3VzZXInIHwgJ2Fzc2lzdGFudCcsXG4gICAgY29udGVudDogbXNnLmNvbnRlbnQsXG4gICAgY3JlYXRlZEF0OiBtc2cuY3JlYXRlZEF0ID8/IG51bGwsXG4gICAgc2VnbWVudHM6IChtc2cuc2VnbWVudHMgPz8gW10pLm1hcChzZWdtZW50ID0+ICh7XG4gICAgICBpZDogc2VnbWVudC5pZCxcbiAgICAgIHRleHQ6IHNlZ21lbnQudGV4dCxcbiAgICAgIHN0YXJ0TXM6IHR5cGVvZiBzZWdtZW50LnN0YXJ0TXMgPT09ICdudW1iZXInID8gc2VnbWVudC5zdGFydE1zIDogbnVsbCxcbiAgICAgIGVuZE1zOiB0eXBlb2Ygc2VnbWVudC5lbmRNcyA9PT0gJ251bWJlcicgPyBzZWdtZW50LmVuZE1zIDogbnVsbCxcbiAgICAgIHNwZWFrZXI6IHNlZ21lbnQuc3BlYWtlciA/PyB1bmRlZmluZWQsXG4gICAgICB0cmFuc2NyaXB0VGl0bGU6IHNlZ21lbnQudHJhbnNjcmlwdD8udGl0bGUgPz8gdW5kZWZpbmVkXG4gICAgfSkpXG4gIH0pKTtcbn07XG5cbmNvbnN0IGdldE9wZW5BaU1lc3NhZ2VzID0gKHtcbiAgaGlzdG9yeSxcbiAgc3lzdGVtUHJvbXB0LFxuICB1c2VyTWVzc2FnZVxufToge1xuICBoaXN0b3J5OiB7IHJvbGU6ICd1c2VyJyB8ICdhc3Npc3RhbnQnOyBjb250ZW50OiBzdHJpbmcgfVtdO1xuICBzeXN0ZW1Qcm9tcHQ6IHN0cmluZztcbiAgdXNlck1lc3NhZ2U6IHN0cmluZztcbn0pID0+IHtcbiAgY29uc3QgdHJpbW1lZEhpc3RvcnkgPSBoaXN0b3J5LnNsaWNlKC02KTtcbiAgY29uc3QgbWVzc2FnZXMgPSBbeyByb2xlOiAnc3lzdGVtJywgY29udGVudDogc3lzdGVtUHJvbXB0IH1dO1xuICB0cmltbWVkSGlzdG9yeS5mb3JFYWNoKGl0ZW0gPT4gbWVzc2FnZXMucHVzaCh7IHJvbGU6IGl0ZW0ucm9sZSwgY29udGVudDogaXRlbS5jb250ZW50IH0pKTtcbiAgbWVzc2FnZXMucHVzaCh7IHJvbGU6ICd1c2VyJywgY29udGVudDogdXNlck1lc3NhZ2UgfSk7XG4gIHJldHVybiBtZXNzYWdlcztcbn07XG5cbmNvbnN0IGdldFN5c3RlbVByb21wdCA9ICh7XG4gIGNvbnRleHRUeXBlLFxuICBwcm9qZWN0TmFtZSxcbiAgdHJhbnNjcmlwdE5hbWVcbn06IHtcbiAgY29udGV4dFR5cGU6IENoYXRDb250ZXh0VHlwZTtcbiAgcHJvamVjdE5hbWU/OiBzdHJpbmcgfCBudWxsO1xuICB0cmFuc2NyaXB0TmFtZT86IHN0cmluZyB8IG51bGw7XG59KSA9PiB7XG4gIGlmIChjb250ZXh0VHlwZSA9PT0gJ1RSQU5TQ1JJUFQnKSB7XG4gICAgcmV0dXJuIGBZb3UgYXJlIGFuIGludGVydmlldyBpbnRlbGxpZ2VuY2UgYXNzaXN0YW50LiBVc2UgdGltZXN0YW1wcyBhbmQgdHJhbnNjcmlwdCBzbmlwcGV0cyB3aGVuIHlvdSBhbnN3ZXIgcXVlc3Rpb25zIGFib3V0IFwiJHt0cmFuc2NyaXB0TmFtZSA/PyAndGhpcyB0cmFuc2NyaXB0J31cIi5gO1xuICB9XG5cbiAgcmV0dXJuIGBZb3UgYXJlIGFuIGluc2lnaHRzIGFzc2lzdGFudCBmb3IgdGhlIFwiJHtwcm9qZWN0TmFtZSA/PyAncHJvamVjdCd9XCIgd29ya3NwYWNlLiBMZWFuIG9uIHRoZSBhdmFpbGFibGUgdHJhbnNjcmlwdCBzZWdtZW50cyB3aGVuIHN1bW1hcml6aW5nIG9yIGFuc3dlcmluZyBxdWVzdGlvbnMuYDtcbn07XG5cbmV4cG9ydCBjb25zdCBydW5DaGF0Q29udmVyc2F0aW9uID0gYXN5bmMgKHtcbiAgY29udGV4dCxcbiAgc2Vzc2lvbixcbiAgaW5wdXQsXG4gIGNvbnRleHRUeXBlXG59OiB7XG4gIGNvbnRleHQ6IEtleXN0b25lQ29udGV4dDtcbiAgc2Vzc2lvbjogU2Vzc2lvbjtcbiAgY29udGV4dFR5cGU6IENoYXRDb250ZXh0VHlwZTtcbiAgaW5wdXQ6IHtcbiAgICBjaGF0SWQ/OiBzdHJpbmcgfCBudWxsO1xuICAgIHRyYW5zY3JpcHRJZD86IHN0cmluZztcbiAgICBwcm9qZWN0SWQ/OiBzdHJpbmc7XG4gICAgbWVzc2FnZTogc3RyaW5nO1xuICB9O1xufSkgPT4ge1xuICBpZiAoIXNlc3Npb24/LmlkKSB0aHJvdyBuZXcgRXJyb3IoJ1VuYXV0aG9yaXplZCcpO1xuICBpZiAoIXNlc3Npb24/Lm9yZ0lkKSB0aHJvdyBuZXcgRXJyb3IoJ01pc3Npbmcgb3JnYW5pemF0aW9uIGNvbnRleHQnKTtcbiAgY29uc3Qgc3Vkb0NvbnRleHQgPSBjb250ZXh0LnN1ZG8oKTtcbiAgY29uc3QgbWVzc2FnZVRleHQgPSBpbnB1dC5tZXNzYWdlLnRyaW0oKTtcbiAgaWYgKCFtZXNzYWdlVGV4dCkgdGhyb3cgbmV3IEVycm9yKCdNZXNzYWdlIGNhbm5vdCBiZSBlbXB0eScpO1xuXG4gIGxldCB0YXJnZXRQcm9qZWN0OiB7IGlkOiBzdHJpbmc7IG5hbWU/OiBzdHJpbmcgfCBudWxsOyBvcmc/OiB7IGlkOiBzdHJpbmcgfSB8IG51bGwgfSB8IG51bGwgPSBudWxsO1xuICBsZXQgdGFyZ2V0VHJhbnNjcmlwdDoge1xuICAgIGlkOiBzdHJpbmc7XG4gICAgdGl0bGU/OiBzdHJpbmcgfCBudWxsO1xuICAgIHByb2plY3Q/OiB7IGlkOiBzdHJpbmc7IG5hbWU/OiBzdHJpbmcgfCBudWxsOyBvcmc/OiB7IGlkOiBzdHJpbmcgfSB8IG51bGwgfSB8IG51bGw7XG4gIH0gfCBudWxsID0gbnVsbDtcblxuICBpZiAoY29udGV4dFR5cGUgPT09ICdUUkFOU0NSSVBUJykge1xuICAgIGlmICghaW5wdXQudHJhbnNjcmlwdElkKSB0aHJvdyBuZXcgRXJyb3IoJ1RyYW5zY3JpcHQgSUQgaXMgcmVxdWlyZWQnKTtcbiAgICB0YXJnZXRUcmFuc2NyaXB0ID0gYXdhaXQgc3Vkb0NvbnRleHQucXVlcnkuVHJhbnNjcmlwdC5maW5kT25lKHtcbiAgICAgIHdoZXJlOiB7IGlkOiBpbnB1dC50cmFuc2NyaXB0SWQgfSxcbiAgICAgIHF1ZXJ5OiAnaWQgdGl0bGUgcHJvamVjdCB7IGlkIG5hbWUgb3JnIHsgaWQgfSB9IG9yZyB7IGlkIH0nXG4gICAgfSk7XG4gICAgaWYgKCF0YXJnZXRUcmFuc2NyaXB0KSB0aHJvdyBuZXcgRXJyb3IoJ1RyYW5zY3JpcHQgbm90IGZvdW5kJyk7XG4gICAgaWYgKCF0YXJnZXRUcmFuc2NyaXB0LnByb2plY3Q/LmlkKSB0aHJvdyBuZXcgRXJyb3IoJ1RyYW5zY3JpcHQgaXMgbWlzc2luZyBwcm9qZWN0IHJlZmVyZW5jZScpO1xuICAgIHRhcmdldFByb2plY3QgPSB0YXJnZXRUcmFuc2NyaXB0LnByb2plY3Q7XG4gIH0gZWxzZSB7XG4gICAgaWYgKCFpbnB1dC5wcm9qZWN0SWQpIHRocm93IG5ldyBFcnJvcignUHJvamVjdCBJRCBpcyByZXF1aXJlZCcpO1xuICAgIHRhcmdldFByb2plY3QgPSBhd2FpdCBzdWRvQ29udGV4dC5xdWVyeS5Qcm9qZWN0LmZpbmRPbmUoe1xuICAgICAgd2hlcmU6IHsgaWQ6IGlucHV0LnByb2plY3RJZCB9LFxuICAgICAgcXVlcnk6ICdpZCBuYW1lIG9yZyB7IGlkIH0nXG4gICAgfSk7XG4gICAgaWYgKCF0YXJnZXRQcm9qZWN0KSB0aHJvdyBuZXcgRXJyb3IoJ1Byb2plY3Qgbm90IGZvdW5kJyk7XG4gIH1cblxuICBpZiAoIXRhcmdldFByb2plY3Q/Lm9yZz8uaWQgJiYgIXRhcmdldFRyYW5zY3JpcHQ/Lm9yZz8uaWQpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ01pc3Npbmcgb3JnYW5pemF0aW9uIGNvbnRleHQgZm9yIGNoYXQgdGFyZ2V0Jyk7XG4gIH1cblxuICBjb25zdCBwcm9qZWN0SWQgPSB0YXJnZXRQcm9qZWN0Py5pZCA/PyBudWxsO1xuICBjb25zdCB0cmFuc2NyaXB0SWQgPSB0YXJnZXRUcmFuc2NyaXB0Py5pZCA/PyBudWxsO1xuICBjb25zdCBzZWdtZW50cyA9IGF3YWl0IGZldGNoU2VnbWVudHMoe1xuICAgIGNvbnRleHQsXG4gICAgY29udGV4dFR5cGUsXG4gICAgcHJvamVjdElkOiBwcm9qZWN0SWQgPz8gdW5kZWZpbmVkLFxuICAgIHRyYW5zY3JpcHRJZDogdHJhbnNjcmlwdElkID8/IHVuZGVmaW5lZCxcbiAgICBxdWVyeVRleHQ6IG1lc3NhZ2VUZXh0XG4gIH0pO1xuICBpZiAoIXNlZ21lbnRzLmxlbmd0aCkge1xuICAgIHRocm93IG5ldyBFcnJvcignTm8gdHJhbnNjcmlwdCBzZWdtZW50cyBmb3VuZCBmb3IgdGhpcyBjb250ZXh0IHlldCcpO1xuICB9XG5cbiAgY29uc3QgcmVmZXJlbmNlU2VnbWVudHMgPSBzZWdtZW50cy5zbGljZSgwLCAzKTtcbiAgY29uc3Qgc2VnbWVudHNGb3JQcm9tcHQgPSBzZWdtZW50cy5zbGljZSgwLCA4KTtcbiAgY29uc3Qgc2VnbWVudHNUZXh0ID0gc2VnbWVudHNGb3JQcm9tcHQubWFwKGJ1aWxkU2VnbWVudERlc2NyaXB0aW9uKS5qb2luKCdcXG4nKTtcblxuICBjb25zdCBzeXN0ZW1Qcm9tcHQgPSBnZXRTeXN0ZW1Qcm9tcHQoe1xuICAgIGNvbnRleHRUeXBlLFxuICAgIHByb2plY3ROYW1lOiB0YXJnZXRQcm9qZWN0Py5uYW1lLFxuICAgIHRyYW5zY3JpcHROYW1lOiB0YXJnZXRUcmFuc2NyaXB0Py50aXRsZVxuICB9KTtcblxuICBsZXQgY2hhdElkID0gaW5wdXQuY2hhdElkID8/IG51bGw7XG4gIGlmICghY2hhdElkKSB7XG4gICAgY29uc3QgZXhpc3RpbmdDaGF0cyA9IGF3YWl0IHN1ZG9Db250ZXh0LnF1ZXJ5LkNoYXQuZmluZE1hbnkoe1xuICAgICAgd2hlcmU6IHtcbiAgICAgICAgY29udGV4dFR5cGUsXG4gICAgICAgIC4uLihjb250ZXh0VHlwZSA9PT0gJ1RSQU5TQ1JJUFQnXG4gICAgICAgICAgPyB7IHRyYW5zY3JpcHQ6IHsgaWQ6IHsgZXF1YWxzOiB0cmFuc2NyaXB0SWQgfSB9IH1cbiAgICAgICAgICA6IHsgcHJvamVjdDogeyBpZDogeyBlcXVhbHM6IHByb2plY3RJZCB9IH0gfSlcbiAgICAgIH0sXG4gICAgICBvcmRlckJ5OiBbeyBjcmVhdGVkQXQ6ICdkZXNjJyB9XSxcbiAgICAgIHRha2U6IDEsXG4gICAgICBxdWVyeTogJ2lkJ1xuICAgIH0pO1xuICAgIGNoYXRJZCA9IGV4aXN0aW5nQ2hhdHM/LlswXT8uaWQgPz8gbnVsbDtcbiAgfVxuXG4gIGlmICghY2hhdElkKSB7XG4gICAgY29uc3QgY3JlYXRlZCA9IGF3YWl0IHN1ZG9Db250ZXh0LmRiLkNoYXQuY3JlYXRlT25lKHtcbiAgICAgIGRhdGE6IHtcbiAgICAgICAgdGl0bGU6XG4gICAgICAgICAgY29udGV4dFR5cGUgPT09ICdUUkFOU0NSSVBUJ1xuICAgICAgICAgICAgPyBgVHJhbnNjcmlwdCBjaGF0IOKAoiAke3RhcmdldFRyYW5zY3JpcHQ/LnRpdGxlID8/ICd1bnRpdGxlZCd9YFxuICAgICAgICAgICAgOiBgUHJvamVjdCBjaGF0IOKAoiAke3RhcmdldFByb2plY3Q/Lm5hbWUgPz8gJ3VudGl0bGVkJ31gLFxuICAgICAgICBjb250ZXh0VHlwZSxcbiAgICAgICAgb3JnOiB7IGNvbm5lY3Q6IHsgaWQ6IHNlc3Npb24ub3JnSWQgfSB9LFxuICAgICAgICAuLi4ocHJvamVjdElkID8geyBwcm9qZWN0OiB7IGNvbm5lY3Q6IHsgaWQ6IHByb2plY3RJZCB9IH0gfSA6IHt9KSxcbiAgICAgICAgLi4uKHRyYW5zY3JpcHRJZCA/IHsgdHJhbnNjcmlwdDogeyBjb25uZWN0OiB7IGlkOiB0cmFuc2NyaXB0SWQgfSB9IH0gOiB7fSlcbiAgICAgIH1cbiAgICB9KTtcbiAgICBpZiAoIWNyZWF0ZWQ/LmlkKSB0aHJvdyBuZXcgRXJyb3IoJ0ZhaWxlZCB0byBjcmVhdGUgY2hhdCBzZXNzaW9uJyk7XG4gICAgY2hhdElkID0gY3JlYXRlZC5pZDtcbiAgfVxuXG4gIGNvbnN0IGhpc3RvcnkgPSBhd2FpdCBmZXRjaENoYXRIaXN0b3J5KGNvbnRleHQsIGNoYXRJZCk7XG4gIGNvbnN0IHN5c3RlbU1lc3NhZ2VzID0gZ2V0T3BlbkFpTWVzc2FnZXMoe1xuICAgIGhpc3Rvcnk6IGhpc3RvcnkubWFwKGl0ZW0gPT4gKHsgcm9sZTogaXRlbS5yb2xlLCBjb250ZW50OiBpdGVtLmNvbnRlbnQgfSkpLFxuICAgIHN5c3RlbVByb21wdCxcbiAgICB1c2VyTWVzc2FnZTogYCR7c2VnbWVudHNUZXh0fVxcblxcblF1ZXN0aW9uOiAke21lc3NhZ2VUZXh0fWBcbiAgfSk7XG5cbiAgY29uc3Qgb3BlbmFpID0gZ2V0T3BlbkFJQ2xpZW50KCk7XG4gIGNvbnN0IGNvbXBsZXRpb24gPSBhd2FpdCBvcGVuYWkuY2hhdC5jb21wbGV0aW9ucy5jcmVhdGUoe1xuICAgIG1vZGVsOiBvcGVuQWlNb2RlbCxcbiAgICBtZXNzYWdlczogc3lzdGVtTWVzc2FnZXMsXG4gICAgdGVtcGVyYXR1cmU6IDAuMjUsXG4gICAgbWF4X3Rva2VuczogNzAwXG4gIH0pO1xuXG4gIGNvbnN0IGFuc3dlciA9IGNvbXBsZXRpb24uY2hvaWNlcz8uWzBdPy5tZXNzYWdlPy5jb250ZW50Py50cmltKCk7XG4gIGlmICghYW5zd2VyKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKCdPcGVuQUkgZGlkIG5vdCByZXR1cm4gYW4gYW5zd2VyJyk7XG4gIH1cblxuICBhd2FpdCBzdWRvQ29udGV4dC5kYi5DaGF0TWVzc2FnZS5jcmVhdGVPbmUoe1xuICAgIGRhdGE6IHtcbiAgICAgIGNoYXQ6IHsgY29ubmVjdDogeyBpZDogY2hhdElkIH0gfSxcbiAgICAgIHJvbGU6ICd1c2VyJyxcbiAgICAgIGNvbnRlbnQ6IG1lc3NhZ2VUZXh0XG4gICAgfVxuICB9KTtcblxuICBhd2FpdCBzdWRvQ29udGV4dC5kYi5DaGF0TWVzc2FnZS5jcmVhdGVPbmUoe1xuICAgIGRhdGE6IHtcbiAgICAgIGNoYXQ6IHsgY29ubmVjdDogeyBpZDogY2hhdElkIH0gfSxcbiAgICAgIHJvbGU6ICdhc3Npc3RhbnQnLFxuICAgICAgY29udGVudDogYW5zd2VyLFxuICAgICAgLi4uKHJlZmVyZW5jZVNlZ21lbnRzLmxlbmd0aFxuICAgICAgICA/IHsgc2VnbWVudHM6IHsgY29ubmVjdDogcmVmZXJlbmNlU2VnbWVudHMubWFwKHNlZ21lbnQgPT4gKHsgaWQ6IHNlZ21lbnQuaWQgfSkpIH0gfVxuICAgICAgICA6IHt9KVxuICAgIH1cbiAgfSk7XG5cbiAgY29uc3QgdXBkYXRlZEhpc3RvcnkgPSBhd2FpdCBmZXRjaENoYXRIaXN0b3J5KGNvbnRleHQsIGNoYXRJZCk7XG5cbiAgcmV0dXJuIHtcbiAgICBjaGF0SWQsXG4gICAgYW5zd2VyLFxuICAgIG1lc3NhZ2VzOiB1cGRhdGVkSGlzdG9yeSxcbiAgICByZWZlcmVuY2VzOiByZWZlcmVuY2VTZWdtZW50cy5tYXAobWFwU2VnbWVudFJlZmVyZW5jZSlcbiAgfTtcbn07XG5cbmV4cG9ydCBjb25zdCBsb2FkQ2hhdEhpc3RvcnkgPSBmZXRjaENoYXRIaXN0b3J5O1xuXG4iXSwibmFtZXMiOlsiY3JlYXRlRW1iZWRkaW5ncyIsImdldE9wZW5BSUNsaWVudCIsIm9wZW5BaU1vZGVsIiwiZm9ybWF0VmVjdG9yTGl0ZXJhbCIsImZvcm1hdE1zIiwidmFsdWUiLCJ0b3RhbFNlY29uZHMiLCJNYXRoIiwibWF4IiwiZmxvb3IiLCJob3VycyIsIm1pbnV0ZXMiLCJzZWNvbmRzIiwibWFwIiwidW5pdCIsInRvU3RyaW5nIiwicGFkU3RhcnQiLCJqb2luIiwiYnVpbGRTZWdtZW50RGVzY3JpcHRpb24iLCJzZWdtZW50Iiwic3BlYWtlciIsInN0YXJ0TXMiLCJlbmRNcyIsInRleHQiLCJtYXBTZWdtZW50UmVmZXJlbmNlIiwiaWQiLCJ1bmRlZmluZWQiLCJ0cmFuc2NyaXB0VGl0bGUiLCJ0cmFuc2NyaXB0IiwidGl0bGUiLCJWRUNUT1JfTElNSVQiLCJtYXBSYXdUb1NlZ21lbnQiLCJyb3ciLCJpc01ldGFkYXRhIiwidHJhbnNjcmlwdElkIiwiZmV0Y2hTZWdtZW50cyIsImNvbnRleHQiLCJjb250ZXh0VHlwZSIsInByb2plY3RJZCIsInF1ZXJ5VGV4dCIsInN1ZG9Db250ZXh0Iiwic3VkbyIsImZhbGxiYWNrIiwiYmFzZUFyZ3MiLCJ3aGVyZSIsImVxdWFscyIsInByb2plY3QiLCJzZWdtZW50cyIsInF1ZXJ5IiwiVHJhbnNjcmlwdFNlZ21lbnQiLCJmaW5kTWFueSIsIm9yZGVyQnkiLCJ0YWtlIiwiZmlsdGVyIiwicnVuVmVjdG9yU2VhcmNoIiwidHJpbSIsImVtYmVkZGluZ3MiLCJlbWJlZGRpbmciLCJsZW5ndGgiLCJsaXRlcmFsIiwiam9pbkNsYXVzZSIsIndoZXJlQ2xhdXNlIiwicm93cyIsInByaXNtYSIsIiRxdWVyeVJhd1Vuc2FmZSIsImVycm9yIiwiY29uc29sZSIsInZlY3RvclNlZ21lbnRzIiwiZmV0Y2hDaGF0SGlzdG9yeSIsImNoYXRJZCIsIm1lc3NhZ2VzIiwiQ2hhdE1lc3NhZ2UiLCJjaGF0IiwiY3JlYXRlZEF0IiwibXNnIiwicm9sZSIsImNvbnRlbnQiLCJnZXRPcGVuQWlNZXNzYWdlcyIsImhpc3RvcnkiLCJzeXN0ZW1Qcm9tcHQiLCJ1c2VyTWVzc2FnZSIsInRyaW1tZWRIaXN0b3J5Iiwic2xpY2UiLCJmb3JFYWNoIiwiaXRlbSIsInB1c2giLCJnZXRTeXN0ZW1Qcm9tcHQiLCJwcm9qZWN0TmFtZSIsInRyYW5zY3JpcHROYW1lIiwicnVuQ2hhdENvbnZlcnNhdGlvbiIsInNlc3Npb24iLCJpbnB1dCIsIkVycm9yIiwib3JnSWQiLCJtZXNzYWdlVGV4dCIsIm1lc3NhZ2UiLCJ0YXJnZXRQcm9qZWN0IiwidGFyZ2V0VHJhbnNjcmlwdCIsIlRyYW5zY3JpcHQiLCJmaW5kT25lIiwiUHJvamVjdCIsIm9yZyIsInJlZmVyZW5jZVNlZ21lbnRzIiwic2VnbWVudHNGb3JQcm9tcHQiLCJzZWdtZW50c1RleHQiLCJuYW1lIiwiZXhpc3RpbmdDaGF0cyIsIkNoYXQiLCJjcmVhdGVkIiwiZGIiLCJjcmVhdGVPbmUiLCJkYXRhIiwiY29ubmVjdCIsInN5c3RlbU1lc3NhZ2VzIiwib3BlbmFpIiwiY29tcGxldGlvbiIsImNvbXBsZXRpb25zIiwiY3JlYXRlIiwibW9kZWwiLCJ0ZW1wZXJhdHVyZSIsIm1heF90b2tlbnMiLCJhbnN3ZXIiLCJjaG9pY2VzIiwidXBkYXRlZEhpc3RvcnkiLCJyZWZlcmVuY2VzIiwibG9hZENoYXRIaXN0b3J5Il0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(api)/../../services/chat.ts\n");

/***/ })

};
;