{
  "version": 3,
  "sources": ["../domains/auth/userRole.ts", "../schemas/Chat.ts", "../schemas/ChatMessage.ts", "../schemas/Organization.ts", "../schemas/Project.ts", "../schemas/Transcript.ts", "../config/env.ts", "../lib/openai.ts", "../lib/pgvector.ts", "../schemas/TranscriptSegment.ts", "../schemas/User.ts", "../schemas/schemas.ts", "../services/chat.ts", "../schemas/extensions/Chat.ts", "../schemas/extensions/TranscriptIngestion.ts", "../schemas/extensions/index.ts", "../schemas/graphqlExtensions.ts", "../schemas/index.ts", "../context/keystoneContext.ts", "../domains/auth/google.ts", "../lib/auth/extractUserData.ts", "../lib/auth/providers.ts", "../auth.ts", "../lib/cors.ts", "../routes/example/index.ts", "../routes/index.ts", "../keystone.ts"],
  "sourcesContent": ["import { Session } from '../../auth';\nimport { User } from '../../types/User';\n\nexport enum UserRole {\n  USER = 'USER',\n  PROJECT_ADMIN = 'PROJECT_ADMIN',\n  ORG_ADMIN = 'ORG_ADMIN',\n  ORG_OWNER = 'ORG_OWNER',\n  GOD = 'GOD'\n}\n\nexport const roleHierarchy: Record<UserRole, number> = {\n  [UserRole.USER]: 0,\n  [UserRole.PROJECT_ADMIN]: 1,\n  [UserRole.ORG_ADMIN]: 2,\n  [UserRole.ORG_OWNER]: 3,\n  [UserRole.GOD]: 4\n};\n\ntype SessionOrUserContext = { session?: Session | User | null };\ntype SessionContext = { session?: Session | null };\n\nexport const isAuthenticated = ({ session }: SessionOrUserContext) => !!session?.email;\n\nexport const hasRole =\n  (roles: UserRole[]) =>\n  ({ session }: SessionOrUserContext) => {\n    if (!session?.role) return false;\n    return roles.includes(session?.role);\n  };\n\n// Semantic helper functions for common role checks\nexport const isGod = hasRole([UserRole.GOD]);\nexport const isOrgAdmin = hasRole([UserRole.ORG_ADMIN, UserRole.ORG_OWNER]);\nexport const isProjectAdmin = hasRole([UserRole.PROJECT_ADMIN]);\nexport const isOrgAdminOrAbove = hasRole([UserRole.GOD, UserRole.ORG_ADMIN, UserRole.ORG_OWNER]);\nexport const isAnyAdmin = hasRole([UserRole.GOD, UserRole.ORG_ADMIN, UserRole.ORG_OWNER, UserRole.PROJECT_ADMIN]);\n\nexport const isOrgScoped = async ({ session }: SessionContext) => {\n  if (isGod({ session })) return true;\n  if (!session?.orgId) return false;\n  return { org: { id: { equals: session.orgId } } };\n};\n\nexport const isSelf = async ({ session }: SessionOrUserContext) => {\n  if (!session?.id) return false;\n  return { id: { equals: session.id } };\n};\n\nexport const canEditOrgData = ({ session }: SessionOrUserContext) => isGod({ session }) || isOrgAdmin({ session });\n\nexport const canEditProjectData = ({ session }: SessionOrUserContext) =>\n  isGod({ session }) || isOrgAdmin({ session }) || isProjectAdmin({ session });\n\nexport const filterByUserProject = async ({ session }: SessionContext) => {\n  if (!session?.projectId) return false;\n  return { project: { id: { equals: session.projectId } } };\n};\n\nexport const filterByUserOrg = async ({ session }: SessionContext) => {\n  if (!session?.orgId) return false;\n  return { org: { id: { equals: session.orgId } } };\n};\n\nexport const filterTimeTypesByUserProject = async ({ session }: SessionContext) => {\n  if (!session?.orgId || !session?.projectId) return false;\n  return {\n    org: { id: { equals: session.orgId } },\n    timePolicies: {\n      some: {\n        projects: {\n          some: {\n            id: { equals: session.projectId }\n          }\n        }\n      }\n    }\n  };\n};\n\nexport const filterPoliciesByUserProject = async ({ session }: SessionContext) => {\n  if (!session?.orgId || !session?.projectId) return false;\n  return {\n    org: { id: { equals: session.orgId } },\n    projects: {\n      some: {\n        id: { equals: session.projectId }\n      }\n    }\n  };\n};\n\n/**\n * Check if a user can edit another user based on role hierarchy\n * - PROJECT_ADMIN can only edit USER or PROJECT_ADMIN\n * - ORG_ADMIN can only edit USER, PROJECT_ADMIN, ORG_ADMIN\n * - ORG_OWNER can only edit USER, PROJECT_ADMIN, ORG_ADMIN, ORG_OWNER\n * - GOD can edit anyone\n */\nexport const canEditUserByRole = (\n  editorRole: UserRole | null | undefined,\n  targetRole: UserRole | null | undefined\n): boolean => {\n  if (!editorRole || !targetRole) return false;\n\n  // GOD can edit anyone\n  if (editorRole === UserRole.GOD) return true;\n\n  const editorLevel = roleHierarchy[editorRole] ?? -1;\n  const targetLevel = roleHierarchy[targetRole] ?? Number.MAX_SAFE_INTEGER;\n\n  // Editor can only edit users with equal or lower role level\n  return targetLevel <= editorLevel;\n};\n", "import { type Lists } from '.keystone/types';\nimport { list } from '@keystone-6/core';\nimport { relationship, select, text, timestamp } from '@keystone-6/core/fields';\nimport { filterByUserOrg, isAuthenticated, isGod, isOrgAdmin } from '../domains/auth/userRole';\n\nexport default list({\n  fields: {\n    title: text({ validation: { isRequired: true }, defaultValue: 'AI chat' }),\n    contextType: select({\n      options: [\n        { label: 'Transcript', value: 'TRANSCRIPT' },\n        { label: 'Project', value: 'PROJECT' }\n      ],\n      validation: { isRequired: true }\n    }),\n    org: relationship({ ref: 'Organization.chats', many: false }),\n    project: relationship({ ref: 'Project.chats', many: false }),\n    transcript: relationship({ ref: 'Transcript.chats', many: false }),\n    messages: relationship({ ref: 'ChatMessage.chat', many: true }),\n    createdAt: timestamp({ defaultValue: { kind: 'now' }, ui: { createView: { fieldMode: 'hidden' } } }),\n    updatedAt: timestamp({ db: { updatedAt: true }, ui: { createView: { fieldMode: 'hidden' } } })\n  },\n  access: {\n    operation: {\n      query: isAuthenticated,\n      create: isAuthenticated,\n      update: isOrgAdmin,\n      delete: isOrgAdmin\n    },\n    filter: {\n      query: async ({ session }) => {\n        if (!isAuthenticated({ session })) return false;\n        if (isGod({ session })) return true;\n        return filterByUserOrg({ session });\n      }\n    }\n  }\n}) satisfies Lists['Chat'];\n\n", "import { type Lists } from '.keystone/types';\nimport { list } from '@keystone-6/core';\nimport { relationship, select, text, timestamp } from '@keystone-6/core/fields';\nimport { filterByUserOrg, isAuthenticated, isGod, isOrgAdmin } from '../domains/auth/userRole';\n\nexport default list({\n  fields: {\n    chat: relationship({ ref: 'Chat.messages', many: false }),\n    role: select({\n      options: [\n        { label: 'User', value: 'user' },\n        { label: 'Assistant', value: 'assistant' }\n      ],\n      validation: { isRequired: true },\n      defaultValue: 'user'\n    }),\n    content: text({ ui: { displayMode: 'textarea' }, validation: { isRequired: true } }),\n    segments: relationship({ ref: 'TranscriptSegment.chatMessages', many: true }),\n    createdAt: timestamp({ defaultValue: { kind: 'now' }, ui: { createView: { fieldMode: 'hidden' } } })\n  },\n  access: {\n    operation: {\n      query: isAuthenticated,\n      create: isAuthenticated,\n      update: isOrgAdmin,\n      delete: isOrgAdmin\n    },\n    filter: {\n      query: async ({ session }) => {\n        if (!isAuthenticated({ session })) return false;\n        if (isGod({ session })) return true;\n        return filterByUserOrg({ session });\n      }\n    }\n  }\n}) satisfies Lists['ChatMessage'];\n\n", "import { type Lists } from '.keystone/types';\nimport { list } from '@keystone-6/core';\nimport { json, relationship, text } from '@keystone-6/core/fields';\nimport freeEmailDomains from 'free-email-domains';\nimport type { Session } from '../auth';\nimport { hasRole, isAuthenticated, isGod, UserRole } from '../domains/auth/userRole';\n\nconst freeEmailDomainSet = new Set<string>((freeEmailDomains as string[]).map(domain => domain.toLowerCase()));\n\nconst normalizeDomains = (value: unknown): string[] => {\n  if (!Array.isArray(value)) return [];\n  const seen = new Set<string>();\n  const result: string[] = [];\n  value\n    .map(domain => (typeof domain === 'string' ? domain.trim().toLowerCase() : ''))\n    .filter(Boolean)\n    .forEach(domain => {\n      if (seen.has(domain)) return;\n      seen.add(domain);\n      result.push(domain);\n    });\n  return result;\n};\n\nexport default list({\n  fields: {\n    name: text({ validation: { isRequired: true } }),\n    autojoinDomains: json({\n      defaultValue: [],\n      ui: {\n        description: 'Array of domains allowed to auto-join (e.g. [\"example.com\"])'\n      }\n    }),\n    users: relationship({ ref: 'User.org', many: true }),\n    projects: relationship({ ref: 'Project.org', many: true }),\n    transcripts: relationship({ ref: 'Transcript.org', many: true }),\n    chats: relationship({ ref: 'Chat.org', many: true })\n  },\n  ui: {\n    labelField: 'name'\n  },\n  access: {\n    operation: {\n      query: isAuthenticated,\n      create: isAuthenticated,\n      update: hasRole([UserRole.GOD, UserRole.ORG_OWNER]),\n      delete: isGod\n    },\n    item: {\n      update: async ({ session, item }) => {\n        if (isGod({ session })) return true;\n        return session?.orgId === item.id;\n      }\n    }\n  },\n  hooks: {\n    resolveInput: {\n      create: async ({ resolvedData }) => ({\n        ...resolvedData,\n        autojoinDomains: normalizeDomains(resolvedData.autojoinDomains)\n      }),\n      update: async ({ resolvedData }) => {\n        if (!Object.prototype.hasOwnProperty.call(resolvedData, 'autojoinDomains')) return resolvedData;\n        return {\n          ...resolvedData,\n          autojoinDomains: normalizeDomains(resolvedData.autojoinDomains)\n        };\n      }\n    },\n    afterOperation: {\n      create: async ({ item, context }) => {\n        const session = context.session as Session | null;\n        if (session?.id && item?.id) {\n          const sudo = context.sudo();\n          const user = await sudo.query.User.findOne({\n            where: { id: session.id },\n            query: 'id project { id }'\n          });\n\n          // Only auto-connect if user already has a project (not in onboarding flow)\n          // During onboarding, the completeOnboarding mutation will handle connecting both org and project\n          if (user?.project?.id) {\n            await sudo.db.User.updateOne({\n              where: { id: session.id },\n              data: {\n                role: UserRole.ORG_OWNER,\n                org: { connect: { id: item.id as string } }\n              }\n            });\n          }\n        }\n      }\n    },\n    validateInput: async ({ resolvedData, item, addValidationError }) => {\n      const candidate = Object.prototype.hasOwnProperty.call(resolvedData, 'autojoinDomains')\n        ? normalizeDomains(resolvedData.autojoinDomains)\n        : normalizeDomains(item?.autojoinDomains);\n\n      const invalidDomain = candidate.find(domain => freeEmailDomainSet.has(domain));\n      if (invalidDomain) {\n        addValidationError(`Domain ${invalidDomain} is a free email provider and cannot be used for auto-join.`);\n      }\n    }\n  }\n}) satisfies Lists['Organization'];\n", "import { type Lists } from '.keystone/types';\nimport { list } from '@keystone-6/core';\nimport { relationship, text } from '@keystone-6/core/fields';\nimport {\n  canEditOrgData,\n  canEditProjectData,\n  filterByUserOrg,\n  isAuthenticated,\n  isGod,\n  isOrgAdmin,\n  isProjectAdmin\n} from '../domains/auth/userRole';\n\nexport default list({\n  fields: {\n    name: text({ validation: { isRequired: true } }),\n    description: text({ ui: { displayMode: 'textarea' }, validation: { isRequired: false } }),\n    org: relationship({ ref: 'Organization.projects', many: false }),\n    users: relationship({ ref: 'User.project', many: true }),\n    transcripts: relationship({ ref: 'Transcript.project', many: true }),\n    chats: relationship({ ref: 'Chat.project', many: true })\n  },\n  ui: {\n    labelField: 'name'\n  },\n  access: {\n    operation: {\n      query: ({ session }) => isAuthenticated({ session }),\n      create: canEditOrgData,\n      update: canEditProjectData,\n      delete: canEditOrgData\n    },\n    item: {\n      update: async ({ session, item, context }) => {\n        if (isGod({ session })) return true;\n        if (!item?.id) return false;\n\n        const targetProjectId = String(item.id);\n        const sudoContext = context.sudo();\n        const project = (await sudoContext.query.Project.findOne({\n          where: { id: targetProjectId },\n          query: 'id org { id }'\n        })) as { id: string; org: { id: string } | null } | null;\n\n        if (!project) return false;\n\n        if (isOrgAdmin({ session })) {\n          if (!session?.orgId) return false;\n          return project.org?.id ? String(project.org.id) === String(session.orgId) : false;\n        }\n\n        if (isProjectAdmin({ session })) {\n          if (!session?.projectId) return false;\n          return targetProjectId === String(session.projectId);\n        }\n\n        return false;\n      },\n      delete: async ({ session, item, context }) => {\n        if (isGod({ session })) return true;\n        if (!isOrgAdmin({ session })) return false;\n        if (!session?.orgId || !item?.id) return false;\n\n        const sudoContext = context.sudo();\n        const project = (await sudoContext.query.Project.findOne({\n          where: { id: String(item.id) },\n          query: 'id org { id }'\n        })) as { org: { id: string } | null } | null;\n\n        if (!project?.org?.id) return false;\n        return String(project.org.id) === String(session.orgId);\n      }\n    },\n    filter: {\n      query: async ({ session }) => {\n        if (!isAuthenticated({ session })) return false;\n        if (isGod({ session })) return true;\n        if (isOrgAdmin({ session })) return filterByUserOrg({ session });\n        if (!session?.projectId) return false;\n        return { id: { equals: session.projectId } };\n      }\n    }\n  },\n  hooks: {\n    resolveInput: {\n      create: async ({ resolvedData, context }) => {\n        if (resolvedData.org) return resolvedData;\n        const orgId = context.session?.orgId as string | undefined;\n        if (!orgId) return resolvedData;\n        return {\n          ...resolvedData,\n          org: { connect: { id: orgId } }\n        };\n      }\n    },\n    validateDelete: async ({ item, context, addValidationError }) => {\n      if (!item?.id) return;\n\n      const sudoContext = context.sudo();\n      const projectId = String(item.id);\n\n      const project = (await sudoContext.query.Project.findOne({\n        where: { id: projectId },\n        query: 'id org { id }'\n      })) as { org: { id: string } | null } | null;\n\n      if (!project?.org?.id) {\n        addValidationError('Project is missing organization context.');\n        return;\n      }\n\n      const [orgProjectCount, userCount] = await Promise.all([\n        sudoContext.db.Project.count({ where: { org: { id: { equals: project.org.id } } } }),\n        sudoContext.db.User.count({ where: { project: { id: { equals: projectId } } } })\n      ]);\n\n      if (userCount > 0) {\n        addValidationError('You cannot delete a project that still has users.');\n        return;\n      }\n\n      if (orgProjectCount <= 1) {\n        addValidationError('Each organization must have at least one project.');\n      }\n    }\n  }\n}) satisfies Lists['Project'];\n", "import { type Lists } from '.keystone/types';\nimport { list } from '@keystone-6/core';\nimport { relationship, text, timestamp } from '@keystone-6/core/fields';\nimport {\n  canEditOrgData,\n  canEditProjectData,\n  filterByUserOrg,\n  isAuthenticated,\n  isGod,\n  isOrgAdmin,\n  isProjectAdmin\n} from '../domains/auth/userRole';\n\nexport default list({\n  fields: {\n    title: text({ validation: { isRequired: true } }),\n    intervieweeName: text(),\n    sourceUrl: text({ ui: { description: 'Optional source or recording URL' } }),\n    language: text(),\n    notes: text({ ui: { displayMode: 'textarea' } }),\n    project: relationship({ ref: 'Project.transcripts', many: false }),\n    org: relationship({ ref: 'Organization.transcripts', many: false }),\n    segments: relationship({ ref: 'TranscriptSegment.transcript', many: true }),\n    chats: relationship({ ref: 'Chat.transcript', many: true }),\n    createdAt: timestamp({ defaultValue: { kind: 'now' }, ui: { createView: { fieldMode: 'hidden' } } }),\n    updatedAt: timestamp({ db: { updatedAt: true }, ui: { createView: { fieldMode: 'hidden' } } })\n  },\n  ui: {\n    labelField: 'title'\n  },\n  access: {\n    operation: {\n      query: ({ session }) => isAuthenticated({ session }),\n      create: canEditProjectData,\n      update: canEditProjectData,\n      delete: canEditOrgData\n    },\n    filter: {\n      query: async ({ session }) => {\n        if (!isAuthenticated({ session })) return false;\n        if (isGod({ session })) return true;\n        return filterByUserOrg({ session });\n      }\n    },\n    item: {\n      update: async ({ session, item, context }) => {\n        if (isGod({ session })) return true;\n        if (!item?.id) return false;\n\n        const sudoContext = context.sudo();\n        const stored = (await sudoContext.query.Transcript.findOne({\n          where: { id: String(item.id) },\n          query: 'id project { id org { id } }'\n        })) as { project?: { id: string; org?: { id: string } | null } | null } | null;\n        if (!stored?.project?.id || !stored.project.org?.id) return false;\n\n        if (isOrgAdmin({ session })) {\n          return stored.project.org.id === session.orgId;\n        }\n\n        if (isProjectAdmin({ session })) {\n          return stored.project.id === session.projectId && stored.project.org.id === session.orgId;\n        }\n\n        return false;\n      },\n      delete: async ({ session, item, context }) => {\n        if (isGod({ session })) return true;\n        if (!isOrgAdmin({ session })) return false;\n        if (!session?.orgId || !item?.id) return false;\n\n        const sudoContext = context.sudo();\n        const stored = (await sudoContext.query.Transcript.findOne({\n          where: { id: String(item.id) },\n          query: 'project { org { id } }'\n        })) as { project?: { org?: { id: string } | null } | null } | null;\n        return stored?.project?.org?.id === session.orgId;\n      }\n    }\n  },\n  hooks: {\n    resolveInput: {\n      create: async ({ resolvedData, context }) => {\n        if (resolvedData.org) return resolvedData;\n        const orgId = context.session?.orgId as string | undefined;\n        if (!orgId) return resolvedData;\n        return {\n          ...resolvedData,\n          org: { connect: { id: orgId } }\n        };\n      }\n    }\n  }\n}) satisfies Lists['Transcript'];\n\n", "import dotenv from 'dotenv';\ndotenv.config();\n\nimport { cleanEnv, str, url } from 'envalid';\n\nconst DEFAULT_PORT = 3000;\nconst DEFAULT_APP_URL = 'http://localhost:3000';\nconst DEFAULT_BASE_URL = `http://localhost:${DEFAULT_PORT}`;\nconst DEFAULT_ALLOWED_ORIGINS = [DEFAULT_APP_URL, DEFAULT_BASE_URL].join(',');\n\nconst env = cleanEnv(process.env, {\n  NODE_ENV: str({ choices: ['development', 'production'], default: 'development' }),\n  DATABASE_URL: url(),\n  /**\n   * The secret used to encrypt session data and magic links using @hapi/iron.\n   * Please use a 32-char or more password.\n   */\n  SESSION_SECRET: str(),\n  APP_URL: url({ default: DEFAULT_APP_URL }),\n  BASE_URL: url({ default: DEFAULT_BASE_URL }),\n  NEXTAUTH_URL: url(), // must be set in .env - the npm package reads from there\n  ALLOWED_ORIGINS: str({ default: DEFAULT_ALLOWED_ORIGINS }),\n\n  COOKIE_DOMAIN: str({ default: 'localhost' }),\n\n  DATABASE_PROVIDER: str({ choices: ['sqlite', 'postgresql', 'mysql'], default: 'sqlite' }),\n\n  OPENAI_API_KEY: str(),\n  OPENAI_MODEL: str({ default: 'gpt-4o-mini' }),\n  OPENAI_EMBEDDING_MODEL: str({ default: 'text-embedding-3-small' }),\n\n  GOOGLE_CLIENT_ID: str(),\n  GOOGLE_CLIENT_SECRET: str(),\n\n  CLOUDINARY_CLOUD_NAME: str(),\n  CLOUDINARY_API_KEY: str(),\n  CLOUDINARY_API_SECRET: str(),\n  CLOUDINARY_API_FOLDER: str()\n});\n\nexport default env;\n", "import OpenAI from 'openai';\nimport env from '../config/env';\n\nconst apiKey = env.OPENAI_API_KEY.trim();\nlet client: OpenAI | null = null;\n\nconst ensureClient = () => {\n  if (!apiKey) {\n    throw new Error('OPENAI_API_KEY is not configured');\n  }\n\n  if (!client) {\n    client = new OpenAI({ apiKey });\n  }\n\n  return client;\n};\n\nexport const getOpenAIClient = () => ensureClient();\nexport const openAiModel = env.OPENAI_MODEL || 'gpt-4o-mini';\nexport const embeddingModel = env.OPENAI_EMBEDDING_MODEL || 'text-embedding-3-small';\n\nexport const createEmbeddings = async (input: string[]): Promise<number[][]> => {\n  if (!input.length) return [];\n\n  const openai = ensureClient();\n  const response = await openai.embeddings.create({\n    model: embeddingModel,\n    input\n  });\n\n  if (!response.data || !response.data.length) {\n    throw new Error('OpenAI returned no embeddings');\n  }\n\n  return response.data.map(item => item.embedding ?? []);\n};\n", "export const formatVectorLiteral = (values: number[] | undefined) => {\n  if (!values?.length) return;\n\n  return `vector'[${values.map(value => (Number.isFinite(value) ? value.toString() : '0')).join(',')}]'`;\n};\n", "import { type Lists } from '.keystone/types';\nimport { list } from '@keystone-6/core';\nimport { checkbox, integer, relationship, text } from '@keystone-6/core/fields';\nimport { Prisma } from '@prisma/client';\nimport { canEditProjectData, isAuthenticated, isGod, isOrgAdmin } from '../domains/auth/userRole';\nimport { createEmbeddings } from '../lib/openai';\nimport { formatVectorLiteral } from '../lib/pgvector';\n\nexport default list({\n  fields: {\n    transcript: relationship({ ref: 'Transcript.segments', many: false }),\n    index: integer(),\n    startMs: integer(),\n    endMs: integer(),\n    durationMs: integer(),\n    text: text({ ui: { displayMode: 'textarea' } }),\n    speaker: text(),\n    isMetadata: checkbox({ defaultValue: false }),\n    chatMessages: relationship({ ref: 'ChatMessage.segments', many: true })\n  },\n  db: {\n    extendPrismaSchema: schema => {\n      const schemaArray = schema.split('\\n');\n      const additions = [\n        '  embedding Unsupported(\"vector(1536)\")?',\n        '  @@index([embedding], map: \"TranscriptSegment_embedding_idx\")'\n      ];\n      return [...schemaArray.slice(0, -1), ...additions, schemaArray.pop()].join('\\n');\n    }\n  },\n  access: {\n    operation: {\n      query: ({ session }) => isAuthenticated({ session }),\n      create: canEditProjectData,\n      update: canEditProjectData,\n      delete: canEditProjectData\n    },\n    filter: {\n      query: async ({ session }) => {\n        if (!isAuthenticated({ session })) return false;\n        if (isGod({ session })) return true;\n        if (!session?.orgId) return false;\n\n        // Org-level visibility\n        const orgFilter = {\n          transcript: { project: { org: { id: { equals: session.orgId } } } }\n        };\n\n        // Project-scoped visibility (for project admins with a projectId)\n        if (session.projectId) {\n          return {\n            OR: [orgFilter, { transcript: { project: { id: { equals: session.projectId } } } }]\n          };\n        }\n\n        return orgFilter;\n      }\n    },\n    item: {\n      update: async ({ session, item, context }) => {\n        if (isGod({ session })) return true;\n        if (!item?.id) return false;\n\n        const sudoContext = context.sudo();\n        const record = (await sudoContext.query.TranscriptSegment.findOne({\n          where: { id: String(item.id) },\n          query: 'transcript { project { org { id } } }'\n        })) as { transcript?: { project?: { org?: { id: string } | null } | null } | null } | null;\n        if (!record?.transcript?.project?.org?.id) return false;\n        return record.transcript.project.org.id === session.orgId;\n      },\n      delete: async ({ session, item, context }) => {\n        if (isGod({ session })) return true;\n        if (!isOrgAdmin({ session })) return false;\n        if (!item?.id) return false;\n        const sudoContext = context.sudo();\n        const record = (await sudoContext.query.TranscriptSegment.findOne({\n          where: { id: String(item.id) },\n          query: 'transcript { project { org { id } } }'\n        })) as { transcript?: { project?: { org?: { id: string } | null } | null } | null } | null;\n        return record?.transcript?.project?.org?.id === session.orgId;\n      }\n    }\n  },\n  hooks: {\n    afterOperation: async ({ operation, item, resolvedData, context }) => {\n      const shouldEmbed = operation === 'create' || (operation === 'update' && resolvedData?.text !== undefined);\n      if (!shouldEmbed) return;\n      if (!item?.id || !item?.text) return;\n\n      try {\n        const embedding = formatVectorLiteral((await createEmbeddings([item.text]))[0]);\n        if (!embedding) return;\n\n        await context.sudo().prisma.$executeRaw`\n          UPDATE \"TranscriptSegment\" SET \"embedding\" = ${Prisma.raw(embedding)} WHERE id = ${item.id}\n        `;\n      } catch (error) {\n        console.error('Failed to generate embedding for TranscriptSegment', error);\n      }\n    }\n  }\n}) satisfies Lists['TranscriptSegment'];\n", "import { type Context, type Lists, type TypeInfo } from '.keystone/types';\nimport { cloudinaryImage } from '@keystone-6/cloudinary';\nimport { graphql as g, list } from '@keystone-6/core';\nimport { allOperations, denyAll } from '@keystone-6/core/access';\nimport { checkbox, json, relationship, select, text, timestamp, virtual } from '@keystone-6/core/fields';\nimport { randomUUID } from 'crypto';\nimport type { Session } from '../auth';\nimport env from '../config/env';\nimport {\n  canEditUserByRole,\n  filterByUserOrg,\n  filterByUserProject,\n  isAnyAdmin,\n  isAuthenticated,\n  isGod,\n  isOrgAdmin,\n  isOrgAdminOrAbove,\n  isProjectAdmin,\n  isSelf,\n  UserRole\n} from '../domains/auth/userRole';\n\ntype UserItem = TypeInfo['lists']['User']['item'];\ntype OrganizationItem = TypeInfo['lists']['Organization']['item'];\ntype ProjectItem = TypeInfo['lists']['Project']['item'];\ntype RelationshipInput =\n  | { disconnect?: boolean | Array<{ id: string }> }\n  | { connect?: { id: string } | Array<{ id: string }> }\n  | { set?: { id: string } | Array<{ id: string }> | null }\n  | null\n  | undefined;\n\nconst validation = { isRequired: true };\nconst socialLoginOpts = [{ label: 'Google', value: 'google' }];\n\nconst userRoleOptions = [\n  { label: 'User', value: UserRole.USER },\n  { label: 'Project Admin', value: UserRole.PROJECT_ADMIN },\n  { label: 'Organization Admin', value: UserRole.ORG_ADMIN },\n  { label: 'Organization Owner', value: UserRole.ORG_OWNER },\n  { label: 'System Admin', value: UserRole.GOD }\n];\n\nexport default list({\n  fields: {\n    avatarSocialUrl: text({\n      ui: {\n        createView: {\n          fieldMode: 'hidden'\n        },\n        itemView: {\n          fieldMode: 'hidden'\n        }\n      }\n    }),\n    avatarUploaded: cloudinaryImage({\n      cloudinary: {\n        cloudName: env.CLOUDINARY_CLOUD_NAME,\n        apiKey: env.CLOUDINARY_API_KEY!,\n        apiSecret: env.CLOUDINARY_API_SECRET!,\n        folder: env.CLOUDINARY_API_FOLDER!\n      }\n    }),\n    avatarUrl: virtual({\n      field: g.field({\n        type: g.String,\n        resolve: (item: UserItem): string | null =>\n          (item.avatarUploaded as { publicUrl?: string })?.publicUrl || item.avatarSocialUrl || ''\n      })\n    }),\n    email: text({\n      validation,\n      isIndexed: true,\n      isFilterable: true\n    }),\n    firstName: text(),\n    lastName: text(),\n    displayName: virtual({\n      field: g.field({\n        type: g.String,\n        resolve: (item: UserItem): string => {\n          const name = [item.firstName, item.lastName].filter(Boolean).join(' ');\n          return name || item.email || '';\n        }\n      })\n    }),\n    role: select({\n      type: 'enum',\n      options: userRoleOptions,\n      defaultValue: UserRole.USER,\n      access: {\n        ...allOperations(denyAll),\n        read: isAuthenticated,\n        create: isAnyAdmin,\n        update: isAnyAdmin\n      }\n    }),\n    providerAccountId: text({\n      isIndexed: 'unique',\n      access: {\n        ...allOperations(denyAll),\n        read: isGod,\n        create: isGod,\n        update: isGod\n      },\n      ui: {\n        createView: { fieldMode: 'hidden' }\n      }\n    }),\n    provider: select({\n      type: 'enum',\n      validation,\n      options: socialLoginOpts,\n      access: { ...allOperations(denyAll), read: isGod, create: isGod },\n      defaultValue: socialLoginOpts[0].value\n    }),\n    rawAuth: json({\n      access: { ...allOperations(denyAll), read: isGod, create: isGod },\n      ui: {\n        createView: { fieldMode: 'hidden' },\n        itemView: { fieldMode: 'hidden' }\n      }\n    }),\n    org: relationship({\n      ref: 'Organization.users',\n      many: false,\n      access: {\n        ...allOperations(denyAll),\n        read: isAuthenticated,\n        create: isAnyAdmin,\n        update: isOrgAdminOrAbove\n      }\n    }),\n    project: relationship({\n      ref: 'Project.users',\n      many: false,\n      access: {\n        ...allOperations(denyAll),\n        read: isAuthenticated,\n        create: isAnyAdmin,\n        update: isAnyAdmin\n      }\n    }),\n    isActive: checkbox({\n      defaultValue: true,\n      access: {\n        ...allOperations(denyAll),\n        read: isAuthenticated,\n        create: isAnyAdmin,\n        update: isOrgAdminOrAbove\n      }\n    }),\n    createdAt: timestamp({\n      defaultValue: { kind: 'now' },\n      ui: {\n        createView: { fieldMode: 'hidden' },\n        itemView: { fieldMode: 'read' }\n      }\n    }),\n    provisionedAt: timestamp({\n      ui: {\n        createView: { fieldMode: 'hidden' },\n        itemView: { fieldMode: 'read' }\n      }\n    }),\n    updatedAt: timestamp({\n      db: { updatedAt: true },\n      ui: {\n        createView: { fieldMode: 'hidden' },\n        itemView: { fieldMode: 'read' }\n      }\n    }),\n    seenAt: timestamp({\n      ui: {\n        createView: { fieldMode: 'hidden' },\n        itemView: { fieldMode: 'read' }\n      }\n    })\n  },\n  ui: {\n    labelField: 'email'\n  },\n  access: {\n    operation: {\n      query: ({ session }) => isAuthenticated({ session }),\n\n      create: ({ session }) => isAnyAdmin({ session }),\n      update: ({ session }) => isAuthenticated({ session }),\n      delete: async args => {\n        const typedArgs = args as unknown as {\n          session: Session | null;\n          itemId: string;\n          context: Context;\n        };\n        const { session, itemId, context } = typedArgs;\n        if (isGod({ session })) return true;\n        if (!isOrgAdmin({ session })) return false;\n        if (!session?.orgId || !itemId) return false;\n\n        const user = (await context.sudo().query.User.findOne({\n          where: { id: itemId },\n          query: 'org { id }'\n        })) as (Pick<UserItem, 'id'> & { org: Pick<OrganizationItem, 'id'> | null }) | null;\n        if (!user) return false;\n        return user.org?.id === session.orgId;\n      }\n    },\n    item: {\n      update: async ({ session, item, context }) => {\n        if (isGod({ session })) return true;\n        if (!session?.id || !item?.id) return false;\n\n        const targetUserId = String(item.id);\n        const sessionId = String(session.id);\n\n        // Users can update themselves\n        if (sessionId === targetUserId) return true;\n\n        // Query the item with relationships and role we need\n        const sudoContext = context.sudo();\n        const userWithRelations = (await sudoContext.query.User.findOne({\n          where: { id: targetUserId },\n          query: 'id org { id } project { id } role'\n        })) as\n          | (Pick<UserItem, 'id' | 'role'> & {\n              org: Pick<OrganizationItem, 'id'> | null;\n              project: Pick<ProjectItem, 'id'> | null;\n            })\n          | null;\n\n        if (!userWithRelations) return false;\n\n        // Role hierarchy check: admins cannot edit users with higher roles\n        if (!canEditUserByRole(session?.role as UserRole | null, userWithRelations.role as UserRole | null))\n          return false;\n\n        // Org admins (ORG_ADMIN and ORG_OWNER) can update users in their org\n        if (isOrgAdmin({ session })) {\n          if (!session?.orgId) return false;\n          if (!userWithRelations.org?.id) return false;\n\n          // Compare org IDs as strings to ensure proper comparison\n          return String(userWithRelations.org.id) === String(session.orgId);\n        }\n\n        // Project admins can update users in their project\n        if (isProjectAdmin({ session })) {\n          if (!session?.projectId || !session?.orgId) return false;\n          if (!userWithRelations.project?.id || !userWithRelations.org?.id) return false;\n\n          // Must be in same project and same org\n          return (\n            String(userWithRelations.project.id) === String(session.projectId) &&\n            String(userWithRelations.org.id) === String(session.orgId)\n          );\n        }\n\n        return false;\n      }\n    },\n    filter: {\n      query: async ({ session }) => {\n        if (!isAuthenticated({ session })) return false;\n        if (isGod({ session })) return true;\n        if (isOrgAdmin({ session })) return filterByUserOrg({ session });\n        if (isProjectAdmin({ session })) return filterByUserProject({ session });\n        return isSelf({ session });\n      }\n    }\n  },\n  hooks: {\n    resolveInput: {\n      create: async ({ resolvedData }) => ({\n        ...resolvedData,\n        email: resolvedData.email?.toLowerCase(),\n        providerAccountId: resolvedData.providerAccountId || randomUUID()\n      }),\n      update: async ({ resolvedData }) => ({\n        ...resolvedData,\n        email: typeof resolvedData.email === 'string' ? resolvedData.email.toLowerCase() : resolvedData.email,\n        providerAccountId: resolvedData.providerAccountId || randomUUID()\n      })\n    },\n    validateInput: async ({ operation, resolvedData, item, context, addValidationError }) => {\n      const existingUser = item?.id\n        ? ((await context.query.User.findOne({\n            where: { id: item.id as string },\n            query: 'id org { id } project { id } role'\n          })) as\n            | (Pick<UserItem, 'id' | 'role'> & {\n                org: Pick<OrganizationItem, 'id'> | null;\n                project: Pick<ProjectItem, 'id'> | null;\n              })\n            | null)\n        : null;\n\n      // Check if user is trying to edit themselves\n      const session = context.session as Session | null;\n      const isEditingSelf =\n        operation === 'update' && existingUser && session?.id && String(existingUser.id) === String(session.id);\n\n      // Prevent self-editing of role (always)\n      isEditingSelf && resolvedData.role && addValidationError('You cannot edit your own role.');\n\n      // Prevent self-editing of isActive (always)\n      isEditingSelf &&\n        resolvedData.isActive !== undefined &&\n        addValidationError('You cannot edit your own active status.');\n\n      // Prevent self-editing of project unless ORG_OWNER/ORG_ADMIN\n      isEditingSelf &&\n        resolvedData.project &&\n        session?.role !== UserRole.ORG_ADMIN &&\n        session?.role !== UserRole.ORG_OWNER &&\n        addValidationError('You cannot edit your own project.');\n\n      const resolveRelationshipId = (input: RelationshipInput | unknown, existingId: string | null): string | null => {\n        const typedInput = input as RelationshipInput;\n        if (!typedInput) return existingId ?? null;\n\n        const getDisconnectedId = (): string | null => {\n          if (!('disconnect' in typedInput) || !typedInput.disconnect) return null;\n          if (typedInput.disconnect === true) return null;\n          if (Array.isArray(typedInput.disconnect) && typedInput.disconnect.length > 0) return null;\n          return existingId ?? null;\n        };\n\n        const getConnectedId = (): string | null => {\n          if (!('connect' in typedInput) || !typedInput.connect) return null;\n          if (Array.isArray(typedInput.connect)) return typedInput.connect[0]?.id as string | null;\n          return typedInput.connect.id as string | null;\n        };\n\n        const getSetId = (): string | null => {\n          if (!('set' in typedInput) || typedInput.set === undefined) return null;\n          if (typedInput.set === null) return null;\n          if (Array.isArray(typedInput.set)) return typedInput.set[0]?.id as string | null;\n          return typedInput.set?.id as string | null;\n        };\n\n        return getDisconnectedId() ?? getConnectedId() ?? getSetId() ?? existingId ?? null;\n      };\n\n      const getAllowedRolesForAdmin = (adminRole: UserRole): UserRole[] => {\n        const baseRoles: UserRole[] = [UserRole.USER];\n        const roleMap: Record<UserRole, UserRole[]> = {\n          [UserRole.USER]: baseRoles,\n          [UserRole.PROJECT_ADMIN]: [...baseRoles, UserRole.PROJECT_ADMIN],\n          [UserRole.ORG_ADMIN]: [...baseRoles, UserRole.PROJECT_ADMIN, UserRole.ORG_ADMIN],\n          [UserRole.ORG_OWNER]: [...baseRoles, UserRole.PROJECT_ADMIN, UserRole.ORG_ADMIN, UserRole.ORG_OWNER],\n          [UserRole.GOD]: [...baseRoles, UserRole.PROJECT_ADMIN, UserRole.ORG_ADMIN, UserRole.ORG_OWNER]\n        };\n        return roleMap[adminRole] ?? baseRoles;\n      };\n\n      const validateRoleAssignment = (assignedRole: UserRole, adminRole: UserRole | null | undefined): void => {\n        if (!adminRole) return;\n\n        if (assignedRole === UserRole.GOD) {\n          addValidationError('GOD role cannot be assigned via API. It can only be set directly in the database.');\n          return;\n        }\n\n        const allowedRoles = getAllowedRolesForAdmin(adminRole);\n        if (!allowedRoles.includes(assignedRole)) {\n          addValidationError('You cannot assign this role. You can only assign roles up to your own permission level.');\n        }\n      };\n\n      const validateProjectRestriction = (\n        operation: string,\n        nextProjectId: string | null,\n        adminRole: UserRole | null | undefined,\n        adminProjectId: string | null | undefined\n      ): void => {\n        const isProjectAdminCreating = operation === 'create' && adminRole === UserRole.PROJECT_ADMIN && adminProjectId;\n        if (isProjectAdminCreating && nextProjectId && String(nextProjectId) !== String(adminProjectId)) {\n          addValidationError('Project Admins can only create users in their own project.');\n        }\n      };\n\n      const validateProvisioning = (\n        operation: string,\n        nextOrgId: string | null,\n        nextProjectId: string | null,\n        existingOrgId: string | null,\n        existingProjectId: string | null\n      ): void => {\n        const isUnprovisioned = !nextOrgId && !nextProjectId;\n        const isInitialProvision = operation === 'create' && isUnprovisioned;\n        const isExistingUnprovisioned =\n          operation === 'update' && isUnprovisioned && !existingOrgId && !existingProjectId;\n\n        if (!isInitialProvision && !isExistingUnprovisioned && (!nextOrgId || !nextProjectId)) {\n          addValidationError('Users must belong to both an organization and a project once provisioned.');\n        }\n      };\n\n      const validateProjectOrgMatch = async (\n        nextOrgId: string | null,\n        nextProjectId: string | null,\n        context: Context\n      ): Promise<void> => {\n        if (!nextOrgId || !nextProjectId) return;\n\n        const project = (await context.query.Project.findOne({\n          where: { id: nextProjectId },\n          query: 'id org { id }'\n        })) as (Pick<ProjectItem, 'id'> & { org: Pick<OrganizationItem, 'id'> | null }) | null;\n\n        const projectOrgId = project?.org?.id ?? null;\n        if (projectOrgId && projectOrgId !== nextOrgId) {\n          addValidationError(\"Selected project does not belong to the user's organization.\");\n        }\n      };\n\n      const nextOrgId = resolveRelationshipId(resolvedData.org, existingUser?.org?.id ?? null);\n      const nextProjectId = resolveRelationshipId(resolvedData.project, existingUser?.project?.id ?? null);\n\n      resolvedData.role && validateRoleAssignment(resolvedData.role as UserRole, session?.role);\n\n      validateProjectRestriction(operation, nextProjectId, session?.role, session?.projectId);\n\n      validateProvisioning(\n        operation,\n        nextOrgId,\n        nextProjectId,\n        existingUser?.org?.id ?? null,\n        existingUser?.project?.id ?? null\n      );\n\n      await validateProjectOrgMatch(nextOrgId, nextProjectId, context);\n    }\n  }\n}) satisfies Lists['User'];\n", "import Chat from './Chat';\nimport ChatMessage from './ChatMessage';\nimport Organization from './Organization';\nimport Project from './Project';\nimport Transcript from './Transcript';\nimport TranscriptSegment from './TranscriptSegment';\nimport User from './User';\n\nconst lists = {\n  Chat,\n  ChatMessage,\n  Organization,\n  Project,\n  Transcript,\n  TranscriptSegment,\n  User\n};\n\nexport default lists;\n", "import type { KeystoneContext } from '@keystone-6/core/types';\nimport type { Session } from '../auth';\nimport { createEmbeddings, getOpenAIClient, openAiModel } from '../lib/openai';\nimport { formatVectorLiteral } from '../lib/pgvector';\n\ntype ChatContextType = 'TRANSCRIPT' | 'PROJECT';\n\ntype SegmentRecord = {\n  id: string;\n  text: string;\n  startMs?: number | null;\n  endMs?: number | null;\n  speaker?: string | null;\n  isMetadata?: boolean | null;\n  transcript?: {\n    id: string;\n    title?: string | null;\n  } | null;\n};\n\nexport type SegmentReference = {\n  id: string;\n  text: string;\n  startMs: number | null;\n  endMs: number | null;\n  speaker?: string | null;\n  transcriptTitle?: string | null;\n};\n\nexport type ChatHistoryItem = {\n  id: string;\n  role: 'user' | 'assistant';\n  content: string;\n  createdAt: string | null;\n  segments: SegmentReference[];\n};\n\nconst formatMs = (value?: number | null) => {\n  if (typeof value !== 'number') return '00:00:00';\n  const totalSeconds = Math.max(0, Math.floor(value / 1000));\n  const hours = Math.floor(totalSeconds / 3600);\n  const minutes = Math.floor((totalSeconds % 3600) / 60);\n  const seconds = totalSeconds % 60;\n  return [hours, minutes, seconds].map(unit => unit.toString().padStart(2, '0')).join(':');\n};\n\nconst buildSegmentDescription = (segment: SegmentRecord) =>\n  `${segment.speaker ?? 'Speaker'} (${formatMs(segment.startMs)} - ${formatMs(segment.endMs)}): ${segment.text}`;\n\nconst mapSegmentReference = (segment: SegmentRecord): SegmentReference => ({\n  id: segment.id,\n  startMs: typeof segment.startMs === 'number' ? segment.startMs : null,\n  endMs: typeof segment.endMs === 'number' ? segment.endMs : null,\n  text: segment.text,\n  speaker: segment.speaker ?? undefined,\n  transcriptTitle: segment.transcript?.title ?? undefined\n});\n\ntype FetchSegmentsParams = {\n  context: KeystoneContext;\n  contextType: ChatContextType;\n  projectId?: string;\n  transcriptId?: string;\n  queryText?: string;\n};\n\ntype RawSegment = {\n  id: string;\n  text: string;\n  startMs: number | null;\n  endMs: number | null;\n  speaker: string | null;\n  isMetadata: boolean | null;\n  transcriptId?: string | null;\n  transcriptTitle?: string | null;\n};\n\nconst VECTOR_LIMIT = 40;\n\nconst mapRawToSegment = (row: RawSegment): SegmentRecord => ({\n  id: row.id,\n  text: row.text,\n  startMs: row.startMs ?? null,\n  endMs: row.endMs ?? null,\n  speaker: row.speaker ?? undefined,\n  isMetadata: row.isMetadata ?? false,\n  transcript: row.transcriptId\n    ? {\n        id: row.transcriptId,\n        title: row.transcriptTitle ?? null\n      }\n    : null\n});\n\nconst fetchSegments = async ({ context, contextType, projectId, transcriptId, queryText }: FetchSegmentsParams) => {\n  const sudoContext = context.sudo();\n\n  const fallback = async () => {\n    const baseArgs =\n      contextType === 'TRANSCRIPT'\n        ? {\n            where: { transcript: { id: { equals: transcriptId } } }\n          }\n        : {\n            where: {\n              transcript: {\n                project: {\n                  id: { equals: projectId }\n                }\n              }\n            }\n          };\n\n    const segments = await sudoContext.query.TranscriptSegment.findMany({\n      ...baseArgs,\n      orderBy: [{ startMs: 'asc' }],\n      take: VECTOR_LIMIT,\n      query: 'id text startMs endMs speaker isMetadata transcript { id title project { id } }'\n    });\n\n    return segments\n      .filter(segment => segment.text && !segment.isMetadata)\n      .map(segment => ({\n        id: segment.id,\n        text: segment.text,\n        startMs: segment.startMs,\n        endMs: segment.endMs,\n        speaker: segment.speaker,\n        isMetadata: segment.isMetadata,\n        transcript: segment.transcript\n          ? {\n              id: segment.transcript.id,\n              title: segment.transcript.title ?? null\n            }\n          : null\n      }));\n  };\n\n  const runVectorSearch = async (text: string) => {\n    if (!text.trim()) return [];\n    if (contextType === 'TRANSCRIPT' && !transcriptId) return [];\n    if (contextType === 'PROJECT' && !projectId) return [];\n\n    try {\n      const embeddings = await createEmbeddings([text]);\n      const embedding = embeddings?.[0];\n      if (!embedding?.length) return [];\n\n      const literal = formatVectorLiteral(embedding);\n      const joinClause =\n        contextType === 'PROJECT'\n          ? 'INNER JOIN \"Transcript\" t ON t.id = \"TranscriptSegment\".\"transcriptId\"'\n          : 'LEFT JOIN \"Transcript\" t ON t.id = \"TranscriptSegment\".\"transcriptId\"';\n      const whereClause =\n        contextType === 'TRANSCRIPT'\n          ? `\"TranscriptSegment\".\"transcriptId\" = '${transcriptId}'`\n          : `\"Transcript\".\"projectId\" = '${projectId}'`;\n\n      const rows =\n        (await sudoContext.prisma.$queryRawUnsafe<RawSegment>(`\n        SELECT\n          \"TranscriptSegment\".\"id\",\n          \"TranscriptSegment\".\"text\",\n          \"TranscriptSegment\".\"startMs\",\n          \"TranscriptSegment\".\"endMs\",\n          \"TranscriptSegment\".\"speaker\",\n          \"TranscriptSegment\".\"isMetadata\",\n          t.\"id\" AS \"transcriptId\",\n          t.\"title\" AS \"transcriptTitle\"\n        FROM \"TranscriptSegment\"\n        ${joinClause}\n        WHERE \"TranscriptSegment\".\"isMetadata\" = FALSE\n          AND \"TranscriptSegment\".\"embedding\" IS NOT NULL\n          AND ${whereClause}\n        ORDER BY \"TranscriptSegment\".\"embedding\" <-> ${literal}\n        LIMIT ${VECTOR_LIMIT}\n      `)) ?? [];\n\n      return rows.map(mapRawToSegment);\n    } catch (error) {\n      console.error('Vector search fallback', error);\n      return [];\n    }\n  };\n\n  if (queryText) {\n    const vectorSegments = await runVectorSearch(queryText);\n    if (vectorSegments.length) return vectorSegments;\n  }\n\n  return fallback();\n};\n\nconst fetchChatHistory = async (context: KeystoneContext, chatId: string): Promise<ChatHistoryItem[]> => {\n  const sudoContext = context.sudo();\n  const messages = await sudoContext.query.ChatMessage.findMany({\n    where: { chat: { id: { equals: chatId } } },\n    orderBy: [{ createdAt: 'asc' }],\n    query: 'id role content createdAt segments { id text startMs endMs speaker transcript { title } }'\n  });\n\n  return messages.map(msg => ({\n    id: msg.id,\n    role: msg.role as 'user' | 'assistant',\n    content: msg.content,\n    createdAt: msg.createdAt ?? null,\n    segments: (msg.segments ?? []).map(segment => ({\n      id: segment.id,\n      text: segment.text,\n      startMs: typeof segment.startMs === 'number' ? segment.startMs : null,\n      endMs: typeof segment.endMs === 'number' ? segment.endMs : null,\n      speaker: segment.speaker ?? undefined,\n      transcriptTitle: segment.transcript?.title ?? undefined\n    }))\n  }));\n};\n\nconst getOpenAiMessages = ({\n  history,\n  systemPrompt,\n  userMessage\n}: {\n  history: { role: 'user' | 'assistant'; content: string }[];\n  systemPrompt: string;\n  userMessage: string;\n}) => {\n  const trimmedHistory = history.slice(-6);\n  const messages = [{ role: 'system', content: systemPrompt }];\n  trimmedHistory.forEach(item => messages.push({ role: item.role, content: item.content }));\n  messages.push({ role: 'user', content: userMessage });\n  return messages;\n};\n\nconst getSystemPrompt = ({\n  contextType,\n  projectName,\n  transcriptName\n}: {\n  contextType: ChatContextType;\n  projectName?: string | null;\n  transcriptName?: string | null;\n}) => {\n  if (contextType === 'TRANSCRIPT') {\n    return `You are an interview intelligence assistant. Use timestamps and transcript snippets when you answer questions about \"${transcriptName ?? 'this transcript'}\".`;\n  }\n\n  return `You are an insights assistant for the \"${projectName ?? 'project'}\" workspace. Lean on the available transcript segments when summarizing or answering questions.`;\n};\n\nexport const runChatConversation = async ({\n  context,\n  session,\n  input,\n  contextType\n}: {\n  context: KeystoneContext;\n  session: Session;\n  contextType: ChatContextType;\n  input: {\n    chatId?: string | null;\n    transcriptId?: string;\n    projectId?: string;\n    message: string;\n  };\n}) => {\n  if (!session?.id) throw new Error('Unauthorized');\n  if (!session?.orgId) throw new Error('Missing organization context');\n  const sudoContext = context.sudo();\n  const messageText = input.message.trim();\n  if (!messageText) throw new Error('Message cannot be empty');\n\n  let targetProject: { id: string; name?: string | null; org?: { id: string } | null } | null = null;\n  let targetTranscript: {\n    id: string;\n    title?: string | null;\n    project?: { id: string; name?: string | null; org?: { id: string } | null } | null;\n  } | null = null;\n\n  if (contextType === 'TRANSCRIPT') {\n    if (!input.transcriptId) throw new Error('Transcript ID is required');\n    targetTranscript = await sudoContext.query.Transcript.findOne({\n      where: { id: input.transcriptId },\n      query: 'id title project { id name org { id } } org { id }'\n    });\n    if (!targetTranscript) throw new Error('Transcript not found');\n    if (!targetTranscript.project?.id) throw new Error('Transcript is missing project reference');\n    targetProject = targetTranscript.project;\n  } else {\n    if (!input.projectId) throw new Error('Project ID is required');\n    targetProject = await sudoContext.query.Project.findOne({\n      where: { id: input.projectId },\n      query: 'id name org { id }'\n    });\n    if (!targetProject) throw new Error('Project not found');\n  }\n\n  if (!targetProject?.org?.id && !targetTranscript?.org?.id) {\n    throw new Error('Missing organization context for chat target');\n  }\n\n  const projectId = targetProject?.id ?? null;\n  const transcriptId = targetTranscript?.id ?? null;\n  const segments = await fetchSegments({\n    context,\n    contextType,\n    projectId: projectId ?? undefined,\n    transcriptId: transcriptId ?? undefined,\n    queryText: messageText\n  });\n  if (!segments.length) {\n    throw new Error('No transcript segments found for this context yet');\n  }\n\n  const referenceSegments = segments.slice(0, 3);\n  const segmentsForPrompt = segments.slice(0, 8);\n  const segmentsText = segmentsForPrompt.map(buildSegmentDescription).join('\\n');\n\n  const systemPrompt = getSystemPrompt({\n    contextType,\n    projectName: targetProject?.name,\n    transcriptName: targetTranscript?.title\n  });\n\n  let chatId = input.chatId ?? null;\n  if (!chatId) {\n    const existingChats = await sudoContext.query.Chat.findMany({\n      where: {\n        contextType,\n        ...(contextType === 'TRANSCRIPT'\n          ? { transcript: { id: { equals: transcriptId } } }\n          : { project: { id: { equals: projectId } } })\n      },\n      orderBy: [{ createdAt: 'desc' }],\n      take: 1,\n      query: 'id'\n    });\n    chatId = existingChats?.[0]?.id ?? null;\n  }\n\n  if (!chatId) {\n    const created = await sudoContext.db.Chat.createOne({\n      data: {\n        title:\n          contextType === 'TRANSCRIPT'\n            ? `Transcript chat \u2022 ${targetTranscript?.title ?? 'untitled'}`\n            : `Project chat \u2022 ${targetProject?.name ?? 'untitled'}`,\n        contextType,\n        org: { connect: { id: session.orgId } },\n        ...(projectId ? { project: { connect: { id: projectId } } } : {}),\n        ...(transcriptId ? { transcript: { connect: { id: transcriptId } } } : {})\n      }\n    });\n    if (!created?.id) throw new Error('Failed to create chat session');\n    chatId = created.id;\n  }\n\n  const history = await fetchChatHistory(context, chatId);\n  const systemMessages = getOpenAiMessages({\n    history: history.map(item => ({ role: item.role, content: item.content })),\n    systemPrompt,\n    userMessage: `${segmentsText}\\n\\nQuestion: ${messageText}`\n  });\n\n  const openai = getOpenAIClient();\n  const completion = await openai.chat.completions.create({\n    model: openAiModel,\n    messages: systemMessages,\n    temperature: 0.25,\n    max_tokens: 700\n  });\n\n  const answer = completion.choices?.[0]?.message?.content?.trim();\n  if (!answer) {\n    throw new Error('OpenAI did not return an answer');\n  }\n\n  await sudoContext.db.ChatMessage.createOne({\n    data: {\n      chat: { connect: { id: chatId } },\n      role: 'user',\n      content: messageText\n    }\n  });\n\n  await sudoContext.db.ChatMessage.createOne({\n    data: {\n      chat: { connect: { id: chatId } },\n      role: 'assistant',\n      content: answer,\n      ...(referenceSegments.length\n        ? { segments: { connect: referenceSegments.map(segment => ({ id: segment.id })) } }\n        : {})\n    }\n  });\n\n  const updatedHistory = await fetchChatHistory(context, chatId);\n\n  return {\n    chatId,\n    answer,\n    messages: updatedHistory,\n    references: referenceSegments.map(mapSegmentReference)\n  };\n};\n\nexport const loadChatHistory = fetchChatHistory;\n\n", "import { graphql as g } from '@keystone-6/core';\nimport type { BaseSchemaMeta } from '@keystone-6/core/dist/declarations/src/types/schema/graphql-ts-schema';\nimport type { Session } from '../../auth';\nimport { ChatHistoryItem, SegmentReference, loadChatHistory, runChatConversation } from '../../services/chat';\n\nconst ChatSegmentReference = g.object<SegmentReference>()({\n  name: 'ChatSegmentReference',\n  fields: {\n    id: g.field({ type: g.nonNull(g.ID) }),\n    text: g.field({ type: g.nonNull(g.String) }),\n    startMs: g.field({ type: g.Int }),\n    endMs: g.field({ type: g.Int }),\n    speaker: g.field({ type: g.String }),\n    transcriptTitle: g.field({ type: g.String })\n  }\n});\n\nconst ChatMessageResult = g.object<ChatHistoryItem>()({\n  name: 'ChatMessageResult',\n  fields: {\n    id: g.field({ type: g.nonNull(g.ID) }),\n    role: g.field({ type: g.nonNull(g.String) }),\n    content: g.field({ type: g.nonNull(g.String) }),\n    createdAt: g.field({ type: g.String }),\n    segments: g.field({ type: g.nonNull(g.list(g.nonNull(ChatSegmentReference))) })\n  }\n});\n\nconst ChatHistoryResult = g.object<{ chatId: string | null; messages: ChatHistoryItem[] }>()({\n  name: 'ChatHistoryResult',\n  fields: {\n    chatId: g.field({ type: g.ID }),\n    messages: g.field({ type: g.nonNull(g.list(g.nonNull(ChatMessageResult))) })\n  }\n});\n\nconst ChatMutationResult = g.object<{\n  chatId: string;\n  answer: string;\n  messages: ChatHistoryItem[];\n  references: SegmentReference[];\n}>()({\n  name: 'ChatMutationResult',\n  fields: {\n    chatId: g.field({ type: g.nonNull(g.ID) }),\n    answer: g.field({ type: g.nonNull(g.String) }),\n    messages: g.field({ type: g.nonNull(g.list(g.nonNull(ChatMessageResult))) }),\n    references: g.field({ type: g.nonNull(g.list(g.nonNull(ChatSegmentReference))) })\n  }\n});\n\nconst TranscriptChatInput = g.inputObject({\n  name: 'ChatTranscriptInput',\n  fields: {\n    chatId: g.arg({ type: g.ID }),\n    transcriptId: g.arg({ type: g.nonNull(g.ID) }),\n    message: g.arg({ type: g.nonNull(g.String) })\n  }\n});\n\nconst ProjectChatInput = g.inputObject({\n  name: 'ChatProjectInput',\n  fields: {\n    chatId: g.arg({ type: g.ID }),\n    projectId: g.arg({ type: g.nonNull(g.ID) }),\n    message: g.arg({ type: g.nonNull(g.String) })\n  }\n});\n\nconst getSession = (context: BaseSchemaMeta['context']) => {\n  const session = context.session as Session | undefined;\n  if (!session?.id) throw new Error('Unauthorized');\n  return session;\n};\n\nconst findLatestChat = async ({\n  context,\n  where\n}: {\n  context: BaseSchemaMeta['context'];\n  where: Record<string, unknown>;\n}) => {\n  const chats = await context.sudo().query.Chat.findMany({\n    where,\n    orderBy: [{ createdAt: 'desc' }],\n    take: 1,\n    query: 'id'\n  });\n  const record = chats?.[0];\n  if (!record?.id) return null;\n  const history = await loadChatHistory(context, record.id);\n  return { chatId: record.id, messages: history };\n};\n\nexport const ChatExtension = (base: BaseSchemaMeta) => {\n  return {\n    query: {\n      chatTranscriptHistory: g.field({\n        type: g.nonNull(ChatHistoryResult),\n        args: {\n          transcriptId: g.arg({ type: g.nonNull(g.ID) })\n        },\n        resolve: async (_root, { transcriptId }, context) => {\n          const session = getSession(context);\n          const history = await findLatestChat({\n            context,\n            where: {\n              contextType: 'TRANSCRIPT',\n              transcript: { id: { equals: transcriptId } },\n              org: { id: { equals: session.orgId } }\n            }\n          });\n          if (!history) return { chatId: null, messages: [] };\n          return history;\n        }\n      }),\n      chatProjectHistory: g.field({\n        type: g.nonNull(ChatHistoryResult),\n        args: {\n          projectId: g.arg({ type: g.nonNull(g.ID) })\n        },\n        resolve: async (_root, { projectId }, context) => {\n          const session = getSession(context);\n          const history = await findLatestChat({\n            context,\n            where: {\n              contextType: 'PROJECT',\n              project: { id: { equals: projectId } },\n              org: { id: { equals: session.orgId } }\n            }\n          });\n          if (!history) return { chatId: null, messages: [] };\n          return history;\n        }\n      })\n    },\n    mutation: {\n      chatTranscript: g.field({\n        type: g.nonNull(ChatMutationResult),\n        args: {\n          input: g.arg({ type: g.nonNull(TranscriptChatInput) })\n        },\n        resolve: async (_root, { input }, context) => {\n          const session = getSession(context);\n          return runChatConversation({\n            context,\n            session,\n            contextType: 'TRANSCRIPT',\n            input: {\n              chatId: input.chatId ?? null,\n              transcriptId: input.transcriptId,\n              message: input.message\n            }\n          });\n        }\n      }),\n      chatProject: g.field({\n        type: g.nonNull(ChatMutationResult),\n        args: {\n          input: g.arg({ type: g.nonNull(ProjectChatInput) })\n        },\n        resolve: async (_root, { input }, context) => {\n          const session = getSession(context);\n          return runChatConversation({\n            context,\n            session,\n            contextType: 'PROJECT',\n            input: {\n              chatId: input.chatId ?? null,\n              projectId: input.projectId,\n              message: input.message\n            }\n          });\n        }\n      })\n    }\n  };\n};\n\n", "import { graphql as g } from '@keystone-6/core';\nimport type { BaseSchemaMeta } from '@keystone-6/core/dist/declarations/src/types/schema/graphql-ts-schema';\nimport { Session } from '../../auth';\n\nconst TIMESTAMP_RE = /(?<hours>\\d{2}):(?<minutes>\\d{2}):(?<seconds>\\d{2}),(?<ms>\\d{3})/;\n\ntype ParsedSegment = {\n  index: number;\n  startMs: number;\n  endMs: number;\n  durationMs: number;\n  text: string;\n  speaker?: string;\n  isMetadata: boolean;\n};\n\nconst parseTimestamp = (value: string): number => {\n  const match = TIMESTAMP_RE.exec(value);\n  if (!match) throw new Error(`Invalid timestamp: ${value}`);\n  const { hours, minutes, seconds, ms } = match.groups!;\n  return Number(hours) * 3_600_000 + Number(minutes) * 60_000 + Number(seconds) * 1_000 + Number(ms);\n};\n\nconst parseLines = (block: string) =>\n  block\n    .split('\\n')\n    .map(line => line.trim())\n    .filter(Boolean);\n\nconst chunkArray = <T>(items: T[], size: number) => {\n  const result: T[][] = [];\n  for (let i = 0; i < items.length; i += size) {\n    result.push(items.slice(i, i + size));\n  }\n  return result;\n};\n\nconst parseSrt = (srt: string): ParsedSegment[] => {\n  const normalized = srt.replace(/\\r\\n/g, '\\n').trim();\n  if (!normalized) return [];\n  const groups = normalized\n    .split(/\\n{2,}/)\n    .map(block => block.trim())\n    .filter(Boolean);\n\n  return groups\n    .map(block => {\n      const lines = parseLines(block);\n      if (lines.length < 2) return null;\n      const [indexLine, timeLine, ...textLines] = lines;\n      const timeMatch = timeLine.match(/(\\d{2}:\\d{2}:\\d{2},\\d{3})\\s*-->\\s*(\\d{2}:\\d{2}:\\d{2},\\d{3})/);\n      if (!timeMatch) throw new Error(`Invalid timecode line: ${timeLine}`);\n      const startMs = parseTimestamp(timeMatch[1]);\n      const endMs = parseTimestamp(timeMatch[2]);\n      if (endMs <= startMs) throw new Error('Segment end must be greater than start');\n      const textValue = textLines.join(' ').trim();\n      if (!textValue) return null;\n      const speakerMatch = textValue.match(/^([A-Za-z0-9 ]+):\\s*(.+)$/);\n      const speaker = speakerMatch ? speakerMatch[1] : undefined;\n      const cleanedText = speakerMatch ? speakerMatch[2] : textValue;\n      const isMetadata = /^\\[.*\\]$/.test(cleanedText);\n      return {\n        index: Number.parseInt(indexLine, 10) || 0,\n        startMs,\n        endMs,\n        durationMs: endMs - startMs,\n        text: cleanedText,\n        speaker,\n        isMetadata\n      };\n    })\n    .reduce<ParsedSegment[]>((acc, segment, idx) => {\n      if (!segment) return acc;\n      const normalizedIndex = segment.index || idx + 1;\n      acc.push({ ...segment, index: normalizedIndex });\n      return acc;\n    }, []);\n};\n\nexport const TranscriptIngestion = (base: BaseSchemaMeta) => {\n  const IngestInput = g.inputObject({\n    name: 'IngestTranscriptInput',\n    fields: {\n      projectId: g.arg({ type: g.nonNull(g.ID) }),\n      title: g.arg({ type: g.nonNull(g.String) }),\n      intervieweeName: g.arg({ type: g.String }),\n      sourceUrl: g.arg({ type: g.String }),\n      language: g.arg({ type: g.String }),\n      notes: g.arg({ type: g.String }),\n      srt: g.arg({ type: g.nonNull(g.String) })\n    }\n  });\n\n  const Result = g.object<{ transcriptId: string; segmentsCount: number; projectId: string }>()({\n    name: 'IngestTranscriptResult',\n    fields: {\n      transcriptId: g.field({ type: g.nonNull(g.ID) }),\n      segmentsCount: g.field({ type: g.nonNull(g.Int) }),\n      projectId: g.field({ type: g.nonNull(g.ID) })\n    }\n  });\n\n  return {\n    mutation: {\n      ingestTranscript: g.field({\n        type: g.nonNull(Result),\n        args: { input: g.arg({ type: g.nonNull(IngestInput) }) },\n        async resolve(_root, { input }, context) {\n          const session = context.session as Session | undefined;\n          if (!session?.id) throw new Error('Unauthorized');\n          if (!session.orgId) throw new Error('Missing organization context');\n\n          const sudoContext = context.sudo();\n          const project = await sudoContext.query.Project.findOne({\n            where: { id: input.projectId },\n            query: 'id org { id }'\n          });\n          if (!project) throw new Error('Project not found');\n          if (!project.org?.id || project.org.id !== session.orgId) throw new Error('Project not in your organization');\n\n          const segments = parseSrt(input.srt);\n          if (!segments.length) throw new Error('No valid segments detected');\n\n          const transcript = await sudoContext.db.Transcript.createOne({\n            data: {\n              title: input.title.trim(),\n              intervieweeName: input.intervieweeName?.trim() || null,\n              sourceUrl: input.sourceUrl?.trim() || null,\n              language: input.language?.trim() || null,\n              notes: input.notes?.trim() || null,\n              project: { connect: { id: project.id } },\n              org: { connect: { id: project.org.id } }\n            }\n          });\n\n          await Promise.all(\n            segments.map(segment =>\n              sudoContext.db.TranscriptSegment.createOne({\n                data: {\n                  transcript: { connect: { id: transcript.id } },\n                  index: segment.index,\n                  startMs: segment.startMs,\n                  endMs: segment.endMs,\n                  durationMs: segment.durationMs,\n                  text: segment.text,\n                  speaker: segment.speaker,\n                  isMetadata: segment.isMetadata\n                }\n              })\n            )\n          );\n\n          return {\n            transcriptId: transcript.id,\n            segmentsCount: segments.length,\n            projectId: project.id\n          };\n        }\n      })\n    }\n  };\n};\n", "import { ChatExtension } from './Chat';\nimport { TranscriptIngestion } from './TranscriptIngestion';\n\nexport const SCHEMA_EXTENSIONS = [TranscriptIngestion, ChatExtension];\n\nexport { ChatExtension, TranscriptIngestion };\n", "import { graphql } from '@keystone-6/core';\nimport { SCHEMA_EXTENSIONS } from './extensions';\n\nexport default graphql.extend(base => (SCHEMA_EXTENSIONS as any).map((item: any) => item(base)));\n", "export { default } from './schemas';\nexport { default as extendGraphqlSchema } from './graphqlExtensions';\n", "import { getContext } from '@keystone-6/core/context';\nimport { Context } from '.keystone/types';\n\nlet _keystoneContext: Context = (globalThis as any)._keystoneContext;\nexport const getKeystoneContext = async () => {\n  _keystoneContext =\n    _keystoneContext || getContext((await import('../keystone')).default, await import('@prisma/client'));\n  if (process.env.NODE_ENV !== 'production') {\n    (globalThis as any)._keystoneContext = _keystoneContext;\n  }\n  return _keystoneContext;\n};\n", "import { GoogleProfile } from 'next-auth/providers/google';\n\nexport const getInformationFromProfile = ({ profile }: { profile: GoogleProfile }) => ({\n  email: profile.email,\n  firstName: profile.given_name,\n  lastName: profile.family_name,\n  pictureUrl: profile.picture\n});\n", "import { pick } from 'lodash';\nimport { DefaultUser, Profile } from 'next-auth';\nimport { Provider } from 'next-auth/providers';\nimport { GoogleProfile } from 'next-auth/providers/google';\nimport { Session } from '../../auth';\nimport { getInformationFromProfile } from '../../domains/auth/google';\n\nconst extractUserData = (provider: Provider['id'], { user, profile }: { user?: DefaultUser; profile?: Profile }) => {\n  const handler = {\n    google: () => getInformationFromProfile({ profile: profile as GoogleProfile }),\n    credentials: () => pick(user, ['email', 'firstName', 'lastName'])\n  }[provider];\n\n  if (!handler) throw new Error(`Unknown provider: ${provider}`);\n\n  const userData = handler();\n  return { ...userData } as Session;\n};\n\nexport default extractUserData;\n", "import env from '../../config/env';\nimport Google from 'next-auth/providers/google';\n\nconst providers = [\n  Google({\n    clientId: env.GOOGLE_CLIENT_ID,\n    clientSecret: env.GOOGLE_CLIENT_SECRET\n  })\n];\n\nexport default providers;\n", "import type { TypeInfo } from '.keystone/types';\nimport { JSONValue, SessionStrategy } from '@keystone-6/core/types';\nimport { parse as parseCookies } from 'cookie';\nimport freeEmailDomains from 'free-email-domains';\nimport { getServerSession, NextAuthOptions } from 'next-auth';\nimport env from './config/env';\nimport { getKeystoneContext } from './context/keystoneContext';\nimport { UserRole } from './domains/auth/userRole';\nimport extractUserData from './lib/auth/extractUserData';\nimport providers from './lib/auth/providers';\n\nconst freeEmailDomainSet = new Set<string>((freeEmailDomains as string[]).map(domain => domain.toLowerCase()));\n\nconst extractDomain = (email?: string | null) => {\n  if (!email) return null;\n  const [, domain] = email.toLowerCase().split('@');\n  return domain || null;\n};\n\ntype ProviderType = 'google';\n\ntype UserItem = TypeInfo['lists']['User']['item'];\ntype OrganizationItem = TypeInfo['lists']['Organization']['item'];\ntype ProjectItem = TypeInfo['lists']['Project']['item'];\n\nexport type Session = {\n  id: string;\n  email: string;\n  firstName?: string;\n  lastName?: string;\n  avatarUrl?: string | null;\n  displayName?: string | null;\n  role: UserRole;\n  orgId: string | null;\n  projectId: string | null;\n  providerAccountId: string | null;\n  emailDomain: string | null;\n  isAutojoinDomainAllowed: boolean;\n  isActive: boolean;\n};\n\nconst isSecureCookies = env.NEXTAUTH_URL.startsWith('https://');\nconst cookiePrefix = isSecureCookies ? '__Secure-' : '';\n\nconst cookiesMappingConfig = {\n  sessionToken: `${cookiePrefix}next-auth.session-token`,\n  callbackUrl: `${cookiePrefix}next-auth.callback-url`,\n  csrfToken: `${cookiePrefix}next-auth.csrf-token`,\n  pkceCodeVerifier: `${cookiePrefix}next-auth.pkce.code_verifier`,\n  state: `${cookiePrefix}next-auth.state`,\n  nonce: `${cookiePrefix}next-auth.nonce`\n};\n\nconst cookies: NextAuthOptions['cookies'] = Object.fromEntries(\n  Object.entries(cookiesMappingConfig).map(([key, name]) => [\n    key,\n    {\n      name,\n      options: {\n        httpOnly: true,\n        sameSite: 'lax',\n        path: '/',\n        secure: isSecureCookies,\n        domain: env.COOKIE_DOMAIN\n      }\n    }\n  ])\n);\n\nexport const nextAuthOptions: NextAuthOptions = {\n  providers,\n  cookies,\n  secret: env.SESSION_SECRET,\n  pages: {\n    error: '/api/auth/error'\n  },\n  callbacks: {\n    async signIn({ user, account, profile }) {\n      const sudoContext = (await getKeystoneContext()).sudo();\n\n      if (!account) throw new Error('Missing account param');\n      const { providerAccountId, provider } = account;\n\n      const email = user.email?.toLowerCase();\n      if (!email) return false;\n\n      const domain = extractDomain(email);\n      const nowIso = new Date().toISOString();\n      const extractedData = extractUserData(provider, { user, profile }) as Record<string, unknown>;\n\n      const existingUsers = (await sudoContext.query.User.findMany({\n        where: { email: { equals: email } },\n        query: 'id org { id } project { id }'\n      })) as (Pick<UserItem, 'id'> & {\n        org: Pick<OrganizationItem, 'id'> | null;\n        project: Pick<ProjectItem, 'id'> | null;\n      })[];\n\n      const baseUserData = {\n        email,\n        firstName: extractedData.firstName ?? '',\n        lastName: extractedData.lastName ?? '',\n        avatarSocialUrl: extractedData.pictureUrl ?? '',\n        role: UserRole.USER,\n        providerAccountId,\n        provider: provider as ProviderType,\n        rawAuth: {\n          user: user as unknown as Record<string, unknown>,\n          profile: profile as unknown as Record<string, unknown>,\n          account: account as unknown as Record<string, unknown>\n        } as JSONValue\n      } satisfies Record<string, unknown>;\n\n      let matchedOrgId: string | null = null;\n      if (domain && !freeEmailDomainSet.has(domain)) {\n        const orgs = (await sudoContext.query.Organization.findMany({\n          query: 'id autojoinDomains'\n        })) as (Pick<OrganizationItem, 'id'> & { autojoinDomains: unknown })[];\n        const matchedOrg = orgs.find(candidate => {\n          const domains = Array.isArray(candidate.autojoinDomains) ? (candidate.autojoinDomains as string[]) : [];\n          return domains.map(value => value?.toLowerCase?.() || '').includes(domain);\n        });\n        matchedOrgId = matchedOrg?.id ?? null;\n      }\n\n      let projectToConnect: { id: string } | null = null;\n      if (matchedOrgId) {\n        const candidateProjects = (await sudoContext.query.Project.findMany({\n          where: { org: { id: { equals: matchedOrgId } } },\n          take: 1,\n          query: 'id'\n        })) as Pick<ProjectItem, 'id'>[];\n        const primaryProject = candidateProjects?.[0];\n        if (!primaryProject?.id) {\n          throw new Error('Auto-join target organization does not have a project configured.');\n        }\n        projectToConnect = { id: primaryProject.id };\n      }\n\n      if (existingUsers.length > 0) {\n        const existingUser = existingUsers[0] as Pick<UserItem, 'id'> & {\n          org: Pick<OrganizationItem, 'id'> | null;\n          project: Pick<ProjectItem, 'id'> | null;\n        };\n        const { role: _, ...userDataWithoutRole } = baseUserData;\n        await sudoContext.db.User.updateOne({\n          where: { id: existingUser.id },\n          data: {\n            ...userDataWithoutRole,\n            provisionedAt: nowIso,\n            ...(matchedOrgId && !existingUser.org?.id ? { org: { connect: { id: matchedOrgId } } } : {}),\n            ...(projectToConnect && !existingUser.project?.id ? { project: { connect: projectToConnect } } : {})\n          },\n          query: 'id'\n        } as Parameters<typeof sudoContext.db.User.updateOne>[0] & { query: string });\n\n        return true;\n      }\n\n      const created = await sudoContext.db.User.createOne({\n        data: {\n          ...baseUserData,\n          provisionedAt: nowIso,\n          ...(matchedOrgId ? { org: { connect: { id: matchedOrgId } } } : {}),\n          ...(projectToConnect ? { project: { connect: projectToConnect } } : {})\n        },\n        query: 'id'\n      } as Parameters<typeof sudoContext.db.User.createOne>[0] & { query: string });\n\n      return !!created?.id;\n    },\n\n    async jwt({ token, user, account, profile }) {\n      if (!account) return token;\n\n      const extracted = extractUserData(account.provider, { user, profile }) as Record<string, unknown>;\n      const normalizedEmail = typeof extracted.email === 'string' ? extracted.email.toLowerCase() : null;\n\n      return {\n        ...token,\n        userData: {\n          ...extracted,\n          email: normalizedEmail ?? extracted.email ?? null\n        }\n      };\n    },\n\n    async session({ session, token }) {\n      type UserData = {\n        email?: string | null;\n        firstName?: string | null;\n        lastName?: string | null;\n      };\n      const userData = (token.userData as UserData | undefined) ?? {};\n\n      const normalizedEmail = typeof userData?.email === 'string' ? userData.email.toLowerCase() : null;\n      if (!normalizedEmail) {\n        throw new Error('Invalid session: no email found');\n      }\n\n      const sudoContext = (await getKeystoneContext()).sudo();\n\n      const dbUser = (await sudoContext.query.User.findMany({\n        where: { email: { equals: normalizedEmail } },\n        query: 'id email org { id } project { id } role providerAccountId isActive seenAt avatarUrl displayName'\n      })) as (Pick<UserItem, 'id' | 'email' | 'role' | 'providerAccountId' | 'isActive' | 'seenAt'> & {\n        org: Pick<OrganizationItem, 'id'> | null;\n        project: Pick<ProjectItem, 'id'> | null;\n        avatarUrl?: string | null;\n        displayName?: string | null;\n      })[];\n\n      if (!dbUser || dbUser.length === 0) {\n        throw new Error('User not found in database');\n      }\n\n      const user = dbUser[0];\n\n      const isDeactivated = !user.isActive;\n\n      const seenAt = new Date().toISOString();\n      await sudoContext.db.User.updateOne({\n        where: { id: user.id },\n        data: { seenAt },\n        query: 'id'\n      } as Parameters<typeof sudoContext.db.User.updateOne>[0] & { query: string });\n\n      const emailDomain = extractDomain(user?.email ?? normalizedEmail);\n      const isAutojoinDomainAllowed = !!(emailDomain && !freeEmailDomainSet.has(emailDomain));\n\n      // Default to USER if role is not set\n      const userRole: UserRole = (user?.role as UserRole) || UserRole.USER;\n\n      return {\n        ...session,\n        id: user?.id,\n        email: normalizedEmail,\n        firstName: userData?.firstName,\n        lastName: userData?.lastName,\n        avatarUrl: user?.avatarUrl || null,\n        displayName: user?.displayName || null,\n        providerAccountId: user?.providerAccountId || null,\n        orgId: user?.org?.id || null,\n        projectId: user?.project?.id || null,\n        role: userRole,\n        emailDomain,\n        isAutojoinDomainAllowed,\n        isActive: user.isActive ?? true\n      };\n    },\n\n    async redirect({ url, baseUrl }) {\n      // If this is an error redirect, we can modify it to include additional parameters\n      if (url.includes('/api/auth/error')) {\n        // The error page will handle displaying the email from the error context\n        return url;\n      }\n\n      if (!url.startsWith(env.APP_URL) && !url.startsWith(baseUrl)) return baseUrl;\n      return url;\n    }\n  }\n};\n\nexport const nextAuthSessionStrategy: SessionStrategy<Session, TypeInfo<Session>> = {\n  async get({ context }) {\n    const { req, res } = context;\n    const { headers } = req ?? {};\n\n    if (!headers?.cookie || !res) return;\n\n    const nextAuthSession = await getServerSession<NextAuthOptions, Session>(\n      { headers, cookies: parseCookies(headers.cookie) } as any,\n      res,\n      nextAuthOptions\n    );\n    if (!nextAuthSession) return;\n\n    // Should we verify user line in examples?\n    // const user = await context.sudo().db.User.findOne({ where: { email: nextAuthSession.email } });\n    // if (!user) return;\n\n    return nextAuthSession;\n  },\n\n  // we don't need these as next-auth handle start and end for us\n  async start() {\n    /* empty */\n  },\n  async end() {\n    /* empty */\n  }\n};\n", "import type { CorsOptions } from 'cors';\nimport env from '../config/env';\n\nexport default {\n  credentials: true,\n  origin(origin, callback) {\n    const allowed = [...env.ALLOWED_ORIGINS.split(','), env.APP_URL, env.BASE_URL].filter(\n      Boolean\n    );\n    if (!origin || allowed.includes(origin)) {\n      callback(null, true);\n    } else {\n      callback(new Error(`Origin ${origin} not allowed by CORS`));\n    }\n  }\n} satisfies CorsOptions;\n", "import type { Context } from '.keystone/types';\nimport express from 'express';\n\nexport default (context: Context) => {\n  const router = express.Router({ mergeParams: true, caseSensitive: false });\n\n  router.get('/', async (req, res) => {\n\n    return res.redirect(301, \"https://google.com\");\n  });\n\n  return router;\n};\n", "import type { Application } from 'express';\nimport type { Context } from '.keystone/types';\nimport express from 'express';\nimport path from 'path';\n// import ratehawk from './ratehawk';\nimport example from './example';\n\nconst publicDir = path.resolve(__dirname, '..', 'public');\n\nconst extendExpressApp = async (app: Application, context: Context) => {\n\n  app.use('/public', express.static(publicDir));\n\n\n  app.use('/example', example(context));\n};\n\nexport default extendExpressApp;\n", "import { config } from '@keystone-6/core';\nimport lists, { extendGraphqlSchema } from './schemas';\nimport { DatabaseProvider } from '@keystone-6/core/types';\nimport env from './config/env';\nimport { nextAuthSessionStrategy } from './auth';\nimport providers from './lib/auth/providers';\nimport cors from './lib/cors';\nimport extendExpressApp from './routes';\n\nexport default config({\n  db: {\n    provider: env.DATABASE_PROVIDER as DatabaseProvider,\n    url: env.DATABASE_URL\n  },\n  lists,\n  session: nextAuthSessionStrategy,\n  ui: {\n    publicPages: [\n      '/api/auth/csrf',\n      '/api/auth/signin',\n      '/api/auth/callback',\n      '/api/auth/session',\n      '/api/auth/providers',\n      '/api/auth/signout',\n      '/api/auth/error',\n      ...providers.flatMap(({ id }) => [`/api/auth/signin/${id}`, `/api/auth/callback/${id}`])\n    ],\n\n    pageMiddleware: async ({ wasAccessAllowed }) => {\n      if (wasAccessAllowed) return;\n      return {\n        kind: 'redirect',\n        to: '/api/auth/signin'\n      };\n    }\n  },\n  server: {\n    cors,\n    extendExpressApp\n  },\n  graphql: {\n    path: '/api/graphql',\n    debug: false,\n    // use the builder-style GraphQL extensions\n    extendGraphqlSchema\n  }\n});\n"],
  "mappings": "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",
  "names": ["import_core", "import_fields", "import_core", "import_fields", "freeEmailDomains", "import_core", "import_fields", "import_core", "import_fields", "dotenv", "OpenAI", "import_core", "import_fields", "import_core", "import_fields", "g", "operation", "nextProjectId", "nextOrgId", "context", "text", "import_core", "init_Chat", "g", "import_core", "g", "init_Chat", "import_core", "init_schemas", "import_google", "Google", "import_free_email_domains", "freeEmailDomainSet", "freeEmailDomains", "url", "parseCookies", "express", "import_express", "path", "express", "import_core", "init_schemas"]
}
